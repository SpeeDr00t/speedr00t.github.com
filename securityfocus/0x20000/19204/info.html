#SpeeDr00t@Black Falcon<br>#bid19204<p><b><span style="font-size: 18pt;">Apache Mod_Rewrite Off-By-One Buffer Overflow Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/19204/info">info</a><br><a href="http://www.securityfocus.com/bid/19204/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/19204/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/19204/solution">solution</a><br><a href="http://www.securityfocus.com/bid/19204/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				19204
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2006-3747<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jul 28 2006 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				May 09 2011 07:42PM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Mark Dowd of McAfee Avert Labs discovered this vulnerability.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Ubuntu Ubuntu Linux 5.10 sparc<br/>
					
				
					Ubuntu Ubuntu Linux 5.10  powerpc<br/>
					
				
					Ubuntu Ubuntu Linux 5.10  i386<br/>
					
				
					Ubuntu Ubuntu Linux 5.10  amd64<br/>
					
				
					Ubuntu Ubuntu Linux 5.0 4 powerpc<br/>
					
				
					Ubuntu Ubuntu Linux 5.0 4 i386<br/>
					
				
					Ubuntu Ubuntu Linux 5.0 4 amd64<br/>
					
				
					Ubuntu Ubuntu Linux  6.06 LTS sparc<br/>
					
				
					Ubuntu Ubuntu Linux  6.06 LTS powerpc<br/>
					
				
					Ubuntu Ubuntu Linux  6.06 LTS i386<br/>
					
				
					Ubuntu Ubuntu Linux  6.06 LTS amd64<br/>
					
				
					Turbolinux Turbolinux Server 10.0 x86<br/>
					
				
					Turbolinux Turbolinux Server 10.0 <br/>
					
				
					Turbolinux Turbolinux Desktop 10.0 <br/>
					
				
					Turbolinux Turbolinux  FUJI<br/>
					
				
					Turbolinux Turbolinux  10 F...<br/>
					
				
					TurboLinux Personal  <br/>
					
				
					TurboLinux Multimedia  <br/>
					
				
					Turbolinux Home  <br/>
					
				
					Turbolinux Appliance Server  2.0<br/>
					
				
					Trustix Secure Linux 3.0 <br/>
					
				
					Trustix Secure Linux 2.2 <br/>
					
				
					Trustix Secure Enterprise Linux 2.0 <br/>
					
				
					SuSE SUSE Linux Enterprise Server  9<br/>
					
				
					SuSE SUSE Linux Enterprise Server  10<br/>
					
				
					SuSE SUSE Linux Enterprise SDK  10<br/>
					
				
					Sun Solaris  9_x86<br/>
					
				
					Sun Solaris  9_sparc<br/>
					
				
					Sun Solaris  8_x86<br/>
					
				
					Sun Solaris  8_sparc<br/>
					
				
					Sun Solaris  10_x86<br/>
					
				
					Slackware Linux 10.2 <br/>
					
				
					Slackware Linux 10.1 <br/>
					
				
					Slackware Linux 10.0 <br/>
					
				
					Slackware Linux 9.1 <br/>
					
				
					Slackware Linux 9.0 <br/>
					
				
					Slackware Linux 8.1 <br/>
					
				
					Slackware Linux  -current<br/>
					
				
					S.u.S.E. Linux Professional 10.0  OSS<br/>
					
				
					S.u.S.E. Linux Professional 10.0 <br/>
					
				
					S.u.S.E. Linux Professional 9.3 x86_64<br/>
					
				
					S.u.S.E. Linux Professional 9.3 <br/>
					
				
					S.u.S.E. Linux Professional 9.2 x86_64<br/>
					
				
					S.u.S.E. Linux Professional 9.2 <br/>
					
				
					S.u.S.E. Linux Professional  10.1<br/>
					
				
					S.u.S.E. Linux Personal 10.0  OSS<br/>
					
				
					S.u.S.E. Linux Personal 9.3 x86_64<br/>
					
				
					S.u.S.E. Linux Personal 9.3 <br/>
					
				
					S.u.S.E. Linux Personal 9.2 x86_64<br/>
					
				
					S.u.S.E. Linux Personal 9.2 <br/>
					
				
					S.u.S.E. Linux Personal  10.1<br/>
					
				
					S.u.S.E. Linux Enterprise Server for S/390 9.0 <br/>
					
				
					S.u.S.E. Linux Enterprise Server for S/390  <br/>
					
				
					rPath rPath Linux  1<br/>
					
				
					OpenPKG OpenPKG 2.5 <br/>
					
				
					OpenPKG OpenPKG 2.4 <br/>
					
				
					OpenPKG OpenPKG 2.3 <br/>
					
				
					OpenPKG OpenPKG 2.2 <br/>
					
				
					OpenPKG OpenPKG 2.1 <br/>
					
				
					OpenPKG OpenPKG 2.0 <br/>
					
				
					OpenBSD OpenBSD  3.9<br/>
					
				
					OpenBSD OpenBSD  3.8<br/>
					
				
					MandrakeSoft Multi Network Firewall 2.0 <br/>
					
				
					MandrakeSoft Linux Mandrake 2006.0  x86_64<br/>
					
				
					MandrakeSoft Linux Mandrake 2006.0 <br/>
					
				
					MandrakeSoft Corporate Server 3.0  x86_64<br/>
					
				
					MandrakeSoft Corporate Server 3.0 <br/>
					
				
					IBM Websphere Application Server 6.1 .2<br/>
					
				
					IBM Websphere Application Server 6.1 .1<br/>
					
				
					IBM Websphere Application Server 6.1 <br/>
					
				
					IBM Websphere Application Server 6.0.2 .9<br/>
					
				
					IBM Websphere Application Server 6.0.2 .7<br/>
					
				
					IBM Websphere Application Server 6.0.2 .5<br/>
					
				
					IBM Websphere Application Server 6.0.2 .3<br/>
					
				
					IBM Websphere Application Server 6.0.2 .13<br/>
					
				
					IBM Websphere Application Server 6.0.2 .11<br/>
					
				
					IBM Websphere Application Server 6.0.2 .1<br/>
					
				
					IBM Websphere Application Server 6.0.2 <br/>
					
				
					IBM HTTP Server 1.3.28 .1<br/>
					
				
					IBM HTTP Server 1.3.26 .2<br/>
					
				
					IBM Hardware Management Console (HMC) for pSeries  6.0 R1.0<br/>
					
				
					IBM Hardware Management Console (HMC) for iSeries  6.0 R1.0<br/>
					
				
					HP Webproxy  A.02.10<br/>
<span class="related">
						
							+ 
						
						HP HP-UX  B.11.04<br/>
</span>
					
				
					HP Webproxy  A.02.00<br/>
					
				
					HP VirtualVault 4.7 <br/>
					
				
					HP VirtualVault  A.04.70<br/>
					
				
					HP VirtualVault  A.04.60<br/>
<span class="related">
						
							+ 
						
						HP HP-UX  B.11.04<br/>
</span>
					
				
					HP VirtualVault  A.04.50<br/>
					
				
					HP System Management Homepage 2.1.6 <br/>
					
				
					HP System Management Homepage 2.1.5 <br/>
					
				
					HP System Management Homepage 2.1.4 <br/>
					
				
					HP System Management Homepage 2.1.3 .132<br/>
					
				
					HP System Management Homepage 2.1.3 <br/>
					
				
					HP System Management Homepage 2.1.2 <br/>
					
				
					HP System Management Homepage 2.1.1 <br/>
					
				
					HP System Management Homepage 2.1 <br/>
					
				
					HP System Management Homepage 2.0.2 <br/>
					
				
					HP System Management Homepage 2.0.1 <br/>
					
				
					HP System Management Homepage 2.0 <br/>
					
				
					HP OpenVMS Secure Web Server 1.2 <br/>
					
				
					HP OpenVMS Secure Web Server 1.1 -1<br/>
					
				
					HP OpenVMS Secure Web Server  2.1-1<br/>
					
				
					HP OpenView Network Node Manager  7.51<br/>
					
				
					HP OpenView Network Node Manager  7.01<br/>
					
				
					HP OpenView Network Node Manager  6.41<br/>
					
				
					HP HP-UX  B.11.23<br/>
					
				
					HP HP-UX  B.11.11<br/>
					
				
					HP HP-UX  B.11.04<br/>
					
				
					HP HP-UX  B.11.00<br/>
					
				
					Gentoo Linux  <br/>
					
				
					Debian Linux 3.1  sparc<br/>
					
				
					Debian Linux 3.1  s/390<br/>
					
				
					Debian Linux 3.1  ppc<br/>
					
				
					Debian Linux 3.1  mipsel<br/>
					
				
					Debian Linux 3.1  mips<br/>
					
				
					Debian Linux 3.1  m68k<br/>
					
				
					Debian Linux 3.1  ia-64<br/>
					
				
					Debian Linux 3.1  ia-32<br/>
					
				
					Debian Linux 3.1  hppa<br/>
					
				
					Debian Linux 3.1  arm<br/>
					
				
					Debian Linux 3.1  amd64<br/>
					
				
					Debian Linux 3.1  alpha<br/>
					
				
					Debian Linux 3.1 <br/>
					
				
					Apple Mac OS X Server 10.5.2 <br/>
					
				
					Apple Mac OS X Server 10.5.1 <br/>
					
				
					Apple Mac OS X Server 10.4.11 <br/>
					
				
					Apple Mac OS X Server 10.4.10 <br/>
					
				
					Apple Mac OS X Server 10.4.9 <br/>
					
				
					Apple Mac OS X Server 10.4.8 <br/>
					
				
					Apple Mac OS X Server 10.4.7 <br/>
					
				
					Apple Mac OS X Server 10.4.6 <br/>
					
				
					Apple Mac OS X Server 10.4.5 <br/>
					
				
					Apple Mac OS X Server 10.4.4 <br/>
					
				
					Apple Mac OS X Server 10.4.3 <br/>
					
				
					Apple Mac OS X Server 10.4.2 <br/>
					
				
					Apple Mac OS X Server 10.4.1 <br/>
					
				
					Apple Mac OS X Server  10.5<br/>
					
				
					Apple Mac OS X 10.4.11 <br/>
					
				
					Apple Mac OS X 10.4.10 <br/>
					
				
					Apple Mac OS X 10.4.9 <br/>
					
				
					Apple Mac OS X 10.4.8 <br/>
					
				
					Apple Mac OS X 10.4.7 <br/>
					
				
					Apple Mac OS X 10.4.6 <br/>
					
				
					Apple Mac OS X 10.4.5 <br/>
					
				
					Apple Mac OS X 10.4.4 <br/>
					
				
					Apple Mac OS X 10.4.3 <br/>
					
				
					Apple Mac OS X 10.4.2 <br/>
					
				
					Apple Mac OS X 10.4.1 <br/>
					
				
					Apache Software Foundation Apache 2.2 .0<br/>
					
				
					Apache Software Foundation Apache 2.0.56 -dev<br/>
					
				
					Apache Software Foundation Apache 2.0.55 <br/>
					
				
					Apache Software Foundation Apache 2.0.54 <br/>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  s/390<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  ppc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  mipsel<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  mips<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  m68k<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  ia-64<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  ia-32<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  hppa<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  arm<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  amd64<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.1 <br/>
</span>
					
				
					Apache Software Foundation Apache 2.0.53 <br/>
					
				
					Apache Software Foundation Apache 2.0.52 <br/>
					
				
					Apache Software Foundation Apache 2.0.51 <br/>
					
				
					Apache Software Foundation Apache 2.0.50 <br/>
					
				
					Apache Software Foundation Apache 2.0.49 <br/>
					
				
					Apache Software Foundation Apache 2.0.48 <br/>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 10.0  AMD64<br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 10.0 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 8.1 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 8.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Trustix Secure Linux 2.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Trustix Secure Linux 2.0 <br/>
</span>
					
				
					Apache Software Foundation Apache 2.0.47 <br/>
					
				
					Apache Software Foundation Apache 2.0.46 <br/>
					
				
					Apache Software Foundation Apache 1.3.36 <br/>
					
				
					Apache Software Foundation Apache 1.3.35 -dev<br/>
					
				
					Apache Software Foundation Apache 1.3.34 <br/>
					
				
					Apache Software Foundation Apache 1.3.33 <br/>
					
				
					Apache Software Foundation Apache 1.3.32 <br/>
<span class="related">
						
							+ 
						
						Gentoo Linux 1.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Gentoo Linux  <br/>
</span>
					
				
					Apache Software Foundation Apache 1.3.31 <br/>
<span class="related">
						
							+ 
						
						OpenPKG OpenPKG  Current<br/>
</span>
					
				
					Apache Software Foundation Apache 1.3.29 <br/>
<span class="related">
						
							+ 
						
						Apple Mac OS X 10.3.5 <br/>
</span>
<span class="related">
						
							+ 
						
						Apple Mac OS X 10.2.7 <br/>
</span>
<span class="related">
						
							+ 
						
						Apple Mac OS X Server 10.3.5 <br/>
</span>
<span class="related">
						
							+ 
						
						Apple Mac OS X Server 10.2.7 <br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 10.0  AMD64<br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 10.0 <br/>
</span>
<span class="related">
						
							+ 
						
						OpenPKG OpenPKG 2.0 <br/>
</span>
					
				
					Apache Software Foundation Apache 1.3.28 <br/>
<span class="related">
						
							+ 
						
						Conectiva Linux 8.0 <br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 9.2  amd64<br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Linux Mandrake 9.2 <br/>
</span>
<span class="related">
						
							+ 
						
						OpenBSD OpenBSD  3.4<br/>
</span>
<span class="related">
						
							+ 
						
						OpenPKG OpenPKG 1.3 <br/>
</span>
					
				
					Apache Software Foundation Apache 1.3.9 <br/>
					
				
					Apache Software Foundation Apache 1.3.7 -dev<br/>
					
				
					Apache Software Foundation Apache 1.3.6 <br/>
					
				
					Apache Software Foundation Apache 1.3.4 <br/>
					
				
					Apache Software Foundation Apache 1.3.3 <br/>
<span class="related">
						
							+ 
						
						RedHat Linux 5.2  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						RedHat Linux 5.2  i386<br/>
</span>
<span class="related">
						
							+ 
						
						RedHat Linux 5.2  alpha<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					IBM Websphere Application Server 6.1 .3<br/>
					
				
					IBM Websphere Application Server 6.0.2 .15<br/>
					
				
					HP System Management Homepage 2.1.9 <br/>
					
				
					HP System Management Homepage 2.1.8 <br/>
					
				
					HP System Management Homepage 2.1.7 <br/>
					
				
					HP OpenVMS Secure Web Server  2.2<br/>
					
				
					Apache Software Foundation Apache 2.2.3 <br/>
					
				
					Apache Software Foundation Apache 2.0.59 <br/>
					
				
					Apache Software Foundation Apache 1.3.37 <br/>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x20000/19204/19204.sh">#exploit_19204.sh</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x20000/19204/19204-2.sh">#exploit_19204-2.sh</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x20000/19204/19204.c">#exploit_19204.c</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x20000/19204/apache-mod-rewrite.rb">#exploit_apache-mod-rewrite.rb</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x20000/19204/apache_mod_rewrite_ldap.rb">#exploit_apache_mod_rewrite_ldap.rb</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Core Security Technologies has developed a working commercial exploit for its CORE IMPACT product. This exploit is not otherwise publicly available or known to be circulating in the wild.<br/><br/>The following exploits are available:
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/19204.sh">/data/vulnerabilities/exploits/19204.sh</a></li>
<li><a href="/data/vulnerabilities/exploits/19204-2.sh">/data/vulnerabilities/exploits/19204-2.sh</a></li>
<li><a href="/data/vulnerabilities/exploits/19204.c">/data/vulnerabilities/exploits/19204.c</a></li>
<li><a href="/data/vulnerabilities/exploits/apache-mod-rewrite.rb">/data/vulnerabilities/exploits/apache-mod-rewrite.rb</a></li>
<li><a href="/data/vulnerabilities/exploits/apache_mod_rewrite_ldap.rb">/data/vulnerabilities/exploits/apache_mod_rewrite_ldap.rb</a></li>
</ul>
</div>