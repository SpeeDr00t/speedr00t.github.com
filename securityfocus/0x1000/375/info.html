#SpeeDr00t@Black Falcon<br>#bid375<p><b><span style="font-size: 18pt;">AIX snap Insecure Temporary File Creation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/375/info">info</a><br><a href="http://www.securityfocus.com/bid/375/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/375/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/375/solution">solution</a><br><a href="http://www.securityfocus.com/bid/375/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				375
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Origin Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-1999-1405<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Feb 17 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 12 2009 05:56PM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This bug was posted to the Bugtraq mailing list by Larry W. Cashdollar &lt;lwcashd@TROUT.BIW.COM&gt;. Followup messages were posted by Brian Hauber &lt;hauber@AUSTIN.IBM.COM&gt; The Discussion and Exploit sections of this vulnerability were almost wholly based on thos
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					IBM AIX 4.2.1 <br/>
					
				
					IBM AIX 4.2 <br/>
					
				
					IBM AIX 4.1.5 <br/>
					
				
					IBM AIX 4.1.4 <br/>
					
				
					IBM AIX 4.1.3 <br/>
					
				
					IBM AIX 4.1.2 <br/>
					
				
					IBM AIX 4.1 <br/>
					
				
					IBM AIX 3.2.5 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					IBM AIX 4.3.2 <br/>
					
				
					IBM AIX 4.3 <br/>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	 snap is a shell script which uses cp -p to gather system information. Data from /etc/security is gathered between lines 721 - 727. Seeing that snap uses the /tmp/ibmsupt/general directory someone may create the directory as a normal user (tested on on AIX 4.2.1). The user may then do a touch on /tmp/ibmsupt/general/passwd. Once the passwd file is created do tail -f /tmp/ibmsupt/general/passwd. If in another session someone loggs in as root and ran snap -a - this will cause the contents of the /etc/security/passwd to show up in tail command.
	
		<ul>
</ul>
</div>