#SpeeDr00t@Black Falcon<br>#bid180<p><b><span style="font-size: 18pt;">Microsoft Windows "April Fools 2001" Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/180/info">info</a><br><a href="http://www.securityfocus.com/bid/180/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/180/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/180/solution">solution</a><br><a href="http://www.securityfocus.com/bid/180/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				180
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Failure to Handle Exceptional Conditions
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jan 07 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jan 07 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerbaility was posted to NTBugtraq by Richard M. Smith.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows NT  4.0 SP3<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP3<br/>
</span>
					
				
					Microsoft Windows NT  4.0 SP2<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP2<br/>
</span>
					
				
					Microsoft Windows NT  4.0 SP1<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP1<br/>
</span>
					
				
					Microsoft Windows NT  4.0<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
					
				
					Microsoft Windows 98  <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<br/>//<br/>// APRIL1.C -- Simple test program for the "April's Fools 2001" bug<br/>//<br/>// by Richard M. Smith (rms@pharlap.com)<br/>// copyright (C) 1999<br/>//<br/><br/>#include &lt;stdio.h&gt;<br/>#include &lt;time.h&gt;<br/>#include &lt;string.h&gt;<br/><br/>#define SECS_PER_HOUR (60 * 60)<br/>#define SECS_PER_DAY (24 * SECS_PER_HOUR)<br/>#define SECS_PER_YEAR (365 * SECS_PER_DAY)<br/><br/>#define START (3 * SECS_PER_DAY)<br/>#define INCR (23 * SECS_PER_HOUR)<br/>#define MAXTIMES ((0x80000000L - START) / INCR)<br/><br/>void print_time(time_t mytime);<br/><br/>char *month_tab =<br/>{<br/>        "January",<br/>        "February",<br/>        "March",<br/>        "April",<br/>        "May",<br/>        "June",<br/>        "July",<br/>        "August",<br/>        "September",<br/>        "October",<br/>        "November",<br/>        "December"<br/>};<br/><br/>char *dow_tab =<br/>{<br/>        "Sunday",<br/>        "Monday",<br/>        "Tuesday",<br/>        "Wednesday",<br/>        "Thursday",<br/>        "Friday",<br/>        "Saturday"<br/>};<br/><br/>int main()<br/><br/>{<br/><br/>        print_time(0x3AC796D0);  // Sunday, April 1, 2001<br/>        print_time(0x3ACF2B70);  // Saturday, April 7, 2001<br/>        print_time(0x3AD06EE0);  // Sunday, April 8, 2001<br/>        return 0;<br/><br/>}<br/><br/>//<br/>// print_time -- print out a time_t value converted by localtime()<br/>//<br/><br/>void print_time(time_t mytime)<br/><br/>{<br/><br/>    char month100;<br/>    char dow100;<br/>    struct tm *tmp;<br/><br/>    tmp = localtime(&amp;mytime);<br/>    if(tmp == NULL)<br/>    {<br/>        printf("0x%08lX = Invalid time\n", mytime);<br/>        return;<br/>    }<br/>    if(tmp-&gt;tm_mon &gt;= 0 &amp;&amp; tmp-&gt;tm_mon &lt;= 11)<br/>        strcpy(month, month_tabtmp-&gt;tm_mon);<br/>    else<br/>        sprintf(month, "BadMonth=%d", tmp-&gt;tm_mon);<br/>    if(tmp-&gt;tm_wday &gt;= 0 &amp;&amp; tmp-&gt;tm_wday &lt;= 6)<br/>        strcpy(dow, dow_tabtmp-&gt;tm_wday);<br/>    else<br/>        sprintf(month, "BadDOW=%d", tmp-&gt;tm_wday);<br/>    printf("0x%08lX = %s, %s %d, %d -- %d:%02d:%02d %s -- DOY=%d\n",<br/>           mytime, dow, month, tmp-&gt;tm_mday, tmp-&gt;tm_year + 1900,<br/>           tmp-&gt;tm_hour, tmp-&gt;tm_min, tmp-&gt;tm_sec, _tznametmp-&gt;tm_isdst != 0,<br/>           tmp-&gt;tm_yday);<br/>    return;
	
		<ul>
</ul>
</div>