#bid579<p><b><span style="font-size: 18pt;">NT IIS Malformed HTTP Request Header DoS Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/579/info">info</a><br><a href="http://www.securityfocus.com/bid/579/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/579/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/579/solution">solution</a><br><a href="http://www.securityfocus.com/bid/579/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				579
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Failure to Handle Exceptional Conditions
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 11 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Aug 11 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Reported to Microsoft by Nobuo Miwa &lt;n-miwa@lac.co.jp&gt;.
Microsoft Security Bulletin MS99-029 released August 11, 1999.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Site Server Commerce Edition  3.0 i386<br/>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Commercial Internet System  2.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Site Server Commerce Edition  3.0 alpha<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
					
				
					Microsoft Site Server Commerce Edition  3.0 alpha<br/>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft IIS  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
					
				
					Microsoft IIS  4.0<br/>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
					
				
					Microsoft Commercial Internet System  2.5<br/>
					
				
					Microsoft Commercial Internet System  2.0<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	 Quoted from Nobuo Miwa's post to Bugtraq:<br/><br/> Simple play. I sent lots of "Host:aaaaa...aa" to IIS like...<br/><br/> GET / HTTP/1.1<br/>Host: aaaaaaaaaaaaaaaaaaaaaaa....(200 bytes)<br/>Host: aaaaaaaaaaaaaaaaaaaaaaa....(200 bytes)<br/>...10,000 lines<br/>Host: aaaaaaaaaaaaaaaaaaaaaaa....(200 bytes)<br/><br/> I sent twice above request sets. Then somehow victim IIS got memory leak after these requests. Of course, it can not respond any request any more. If you try this, you should see memory increase through  performance monitor. You would see memory increase even after those requests finished already. It will stop when you got shortage of virtual memory. After that, you might not be able to restart web service and you would restart computer. I tried this against Japanese and English version of Windows NT.
	
		<ul>
</ul>
</div>