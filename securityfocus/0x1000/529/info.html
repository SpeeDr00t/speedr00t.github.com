#bid529<p><b><span style="font-size: 18pt;">NT IIS MDAC RDS Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/529/info">info</a><br><a href="http://www.securityfocus.com/bid/529/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/529/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/529/solution">solution</a><br><a href="http://www.securityfocus.com/bid/529/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				529
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jul 19 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 19 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Microsoft Security Bulletin MS98-004 released July 14, 1998, rereleased as MS99-025 on July 19, 1999.
Additional information posted to NTBugtraq on July 19, 1999 by Greg Gonzalez &lt;ghg@INTERCERVE.COM&gt;.
Additional information and exploit posted to Bugtraq on
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Site Server Commerce Edition  3.0 i386<br/>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Commercial Internet System  2.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Site Server Commerce Edition  3.0 alpha<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
					
				
					Microsoft Index Server  2.0<br/>
<span class="related">
						
							+ 
						
						Microsoft IIS  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft IIS  4.0<br/>
</span>
					
				
					Microsoft IIS  4.0<br/>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
					
				
					Microsoft IIS  3.0<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Microsoft Data Access Components (MDAC)  2.1 UPGRADE<br/>
					
				
					Microsoft Data Access Components (MDAC)  2.1 CLEAN<br/>
					
				
					Microsoft Data Access Components (MDAC)  2.0<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Microsoft Data Access Components (MDAC)  1.5<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x1000/529/msadc.pl">#exploit_msadc.pl</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x1000/529/RDSExploit.zip">#exploit_RDSExploit.zip</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	msadc.pl exploit written and posted to bugtraq by Rain Forest Puppy.<br/>RDSExploit.zip exploit written and emailed to SecurityFocus by Wanderley J. Abreu Jr<br/><br/>--msadc.pl explanation: (RDSExploit explanation is after this)<br/>msadc.pl looks for a common file to exploit, namely btcustmr.mdb .<br/>msadc.pl instructions: <br/>run perl -x msadc.pl<br/>Command line switches (copied from rfp's post):<br/><br/>           -h &lt;ip or domain&gt;       this is the host to scan.  You MUST either<br/>                                  use either -h or -R.<br/><br/>          -d &lt;value 0-?&gt;          this is the delay between connections.<br/>                                  Value is in number of seconds.  I added<br/>                                  this because hammering the RDS components<br/>                                  caused the server to occasionally stop<br/>                                  responding :)  Defaults to 1.  Use -d 0<br/>                                  to disable.<br/><br/>          -V                      Use VbBusObj instead of DataFactory to<br/>                                  run the queries. NOTE: please read the -N<br/>                                  information below as to suggestions for<br/>                                  checking if VbBusObj exists.  VbBusObj<br/>                                  does not give good error reporting;<br/>                                  therefore it is quite possible to have<br/>                                  false positives (and false negatives).<br/>                                  Consider VbBusObj support 3 stages before<br/>                                  beta.  Don't say I didn't warn you.<br/><br/>          -v                      verbose.  This will print the ODBC error<br/>                                  information.  Really only for<br/>                                  troubleshooting purposes.<br/><br/>          -e                      external dictionary file to use on step<br/>                                  5--the 'DSN dictionary guess' stage.  The<br/>                                  file should just be plaintext, one DSN<br/>                                  name per line file with all the DSN names<br/>                                  you want to try.  Quite honestly a normal<br/>                                  dictionary file won't do you much good.<br/>                                  You can probably do pretty damn well with<br/>                                  a few dozen or two good ones, like 'www',<br/>                                  'data', 'database', 'sql', etc.<br/><br/>          -R                      resume.  You can still specify -v or -d<br/>                                  with -R.  This will cause the script to<br/>                                  read in rds.save and execute the command<br/>                                  on the last valid connection.<br/><br/>          -N                      Use VbBusObj to try to get the machine's<br/>                                  NetBIOS name.  It may return no name<br/>                                  if the VbBusObj is unavailable.  I suggest<br/>                                  you use -N to see if VbBusObj exists (a<br/>                                  NetBIOS name will be returned if so)<br/>                                  before you use -V.<br/><br/>          -X                      perform an Index Server table dump instead.<br/>                                  None of the other switches really apply<br/>                                  here, other than -v (although -d still<br/>                                  works, there's no need to slow down one<br/>                                  query).  This dumps the root paths from<br/>                                  Index Server, which can be rather lengthy.<br/>                                  I suggest you pipe the output into a file.<br/>                                  Also, if there is a lot of return<br/>                                  information, this command may take a while<br/>                                  to complete.  Be patient.  And I don't<br/>                                  suggest you use this command more than<br/>                                  once a minute...it caused my P200 w/<br/>                                  128 RAM to stop answering requests, and<br/>                                  in general borked inetinfo.exe.  If you do<br/>                                  decide to CONTROL-C during the middle of the<br/>                                  data download the script will save all<br/>                                  received data into a file called 'raw.out',<br/>                                  so you don't loose everything you've<br/>                                  already received.  NOTE: this is the raw<br/>                                  data, which is in Unicode.<br/><br/>rfp submitted a version 2 of this exploit on October 10, 1999.  New features include:<br/><br/>- UNC support.  This has only been tested with Windows 95 shares...NT may<br/>        cause authentication wackiness.  Use -u \\server\share\file.mdb.<br/>        Also, on unix boxen, don't forget you have to escape the '\', so<br/>        would look like \\\\server\\share\\file.mdb.  Also have not tested<br/>        with Samba.  Let me know if you have good/bad results.<br/><br/>- Win 95 support.  Use -w to use command /c instead of cmd /c.<br/><br/>- Slimmed down the query process.  Before it would query to determine if<br/>        it was using Access driver, then create a table called 'AZZ', and<br/>        then try to use this 'AZZ' table for the exploit.  This left<br/>        obvious leftovers (tables named 'AZZ') on the server.  Now it just<br/>        queries MSysModules firsthand, which cuts down the steps and stops<br/>        leaving evidence.  However, this may not always work.  Use the -c<br/>        switch for backwards compatibility (3 step process).  I would run<br/>        normal, and if nothing works, try it again with the -c switch.<br/><br/>- Only run a certain step.  Use the -s switch to specify which step to<br/>        run.  For those of you itching to try the new UNC support, you<br/>        can run it immediately (normally it's step 5), by running:<br/><br/>        ./msadc.pl -h &lt;host&gt; -u &lt;unc path&gt; -s 5<br/><br/><br/><br/>  NOTE ON SUCCESS:  The script reports 'Success!' when it has issued a valid<br/>  SQL statement.  'Success!' does *NOT* mean that your command worked.  If<br/>  they have MDAC 2.1+ shell commands are worthless, so the script will<br/>  report 'Success!' (it went through) but your command didn't run (MDAC 2.1<br/>  didn't interpret it).  There's no return indication to know whether your<br/>  command worked or not.  As with the ODBC commands, you're flying blind.<br/><br/>--RDSExploit information:<br/>RDS EXPLOITER For Win98/NT<br/>Â <br/>Â <br/>How it Works:<br/>Â <br/>Â Â Â Â Â Â Â  The Intent of RDS Exploit is Deliver Shell comands into the machine or Retrive some DATA from a ODBC valid conection.<br/>Â Â Â Â Â Â <br/>1. Seting ODBC Conection:<br/>First of all you will need to know some valid DSN, the UID (User ID) and Password.Â  Put the information about the conection into "Connection Properties":<br/>Data Source: The DSN Conection Name (it MUST be a registered DSN)<br/>User ID: Login (it can be null sometimes)<br/>Password: Password (it can be null sometimes)Â Â <br/>Mode: The way you want to open the Table (Read Only or Read and Write)<br/>Â <br/> You must follow the order above and don't forget the ; to separate the options<br/>Â It can be for instance a line like this:<br/>"Data Source=AdvWorks;User ID=;Password=;Mode=Read|Write;"<br/>Â Â <br/>2. SQL Comands:<br/> Put into the "SQL Parameters" box the command line you want to deliver for example:<br/>"SELECT * FROM Products"<br/><br/>3. Host:<br/>Â You MUST Enter the host like this http://serverÂ  DON'T FORGET HTTP:// or it'll not work.<br/>Â <br/>After all done, just click in the button "Retrieve Data" and see what happens =)<br/>Â 
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/msadc.pl">/data/vulnerabilities/exploits/msadc.pl</a></li>
<li><a href="/data/vulnerabilities/exploits/RDSExploit.zip">/data/vulnerabilities/exploits/RDSExploit.zip</a></li>
</ul>
</div>