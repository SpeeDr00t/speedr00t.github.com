#bid539<p><b><span style="font-size: 18pt;">Microsoft Windows 2000 EFS Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/539/info">info</a><br><a href="http://www.securityfocus.com/bid/539/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/539/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/539/solution">solution</a><br><a href="http://www.securityfocus.com/bid/539/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				539
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jul 25 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 25 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				"Windows 2000 Encrypting File System (EFS) Vulnerability" paper released July 25 by James J. Grace &lt;Jgrace@LRS.com&gt; and Thomas S. V. Bartlett III &lt;Tbartlett@LRS.com&gt;.
Posted to Bugtraq July 26, 1999 by Matt &lt;matt@use.net&gt;.
Microsoft's reply posted to NTBug
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Datacenter Server  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Quoted verbatim from James J. Grace's paper "Windows 2000 Encrypting File System (EFS) Vulnerability" released July 25, 1999:<br/><br/>For member servers or workstations do the following:<br/>-Install a second (parallel) copy of Windows NT 2000 onto the computer system.  If there is not enough hard disk space use a third party utility to delete unneeded files to make space. Install this copy into say c:\winnt2. <br/>-Boot the computer to the copy of NT installed into the c:\winnt2 directory. <br/>-Using Windows Explorer locate the c:\winnt\system32\config directory. <br/>-Make a backup copy of all the files located in c:\winnt\system32\config. <br/>-In the c:\winnt\system32\config directory locate and delete the SAM and SAM.LOG files. <br/>-Shutdown and reboot the computer into the c:\winnt directory (This is the original servers installation) <br/>-At the logon screen press CTL+ALT+DEL. <br/>-Enter Administrator for the user name. <br/>-Press the enter key for the password. (No Password) <br/>-The system now logs you on as administrator. <br/>-Using Windows Explorer, locate the encrypted files and open them. EFS will automatically decrypt the files for you. <br/>-At this point you are able to access all files encrypted or plaintext on the server.<br/><br/>For Active Directory Services Domain Controllers do the following:<br/>(For the purpose of this discussion assume Windows NT 2000 was installed into c:\winnt)<br/>-Install a second (parallel) copy of Windows NT 2000 onto the computer system.  If there is not enough hard disk space use a third party utility to delete unneeded files to make space. Install this copy into say c:\winnt2. <br/>-Boot the computer to the copy of NT installed into the c:\winnt2 directory. <br/>-Using Windows Explorer locate the c:\winnt\system32\config directory. <br/>-Make a backup copy of all the files located in c:\winnt\system32\config. <br/>-In the c:\winnt\system32\config directory locate and delete the SAM and SAM.LOG files. <br/>-Shutdown and reboot the computer. <br/>-As the NTLDR boots and the BOOT.INI menu is presented press the F8 key to boot the server into Safe Recovery Mode <br/>-Select Active Directory Services Recovery from the menu. <br/>-Select the original server installation <br/>-The system will now boot into safe mode <br/>-At the logon screen press CTL+ALT+DEL. <br/>-Enter Administrator for the user name. <br/>-Press the enter key for the password. (No Password) <br/>-The system now logs you on as administrator. <br/>-Using Windows Explorer, locate the encrypted files and open them. EFS will automatically decrypt the files for you.<br/>-At this point all data on the servers has been compromised.
	
		<ul>
</ul>
</div>