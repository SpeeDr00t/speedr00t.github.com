#bid474<p><b><span style="font-size: 18pt;">NT Screensaver Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/474/info">info</a><br><a href="http://www.securityfocus.com/bid/474/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/474/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/474/solution">solution</a><br><a href="http://www.securityfocus.com/bid/474/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				474
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Failure to Handle Exceptional Conditions
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Mar 10 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Mar 10 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Vulnerability exposed and exploit created by Cybermedia Software Private Limited.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows NT 3.5.1 SP5<br/>
					
				
					Microsoft Windows NT 3.5.1 SP4<br/>
					
				
					Microsoft Windows NT 3.5.1 SP3<br/>
					
				
					Microsoft Windows NT 3.5.1 SP2<br/>
					
				
					Microsoft Windows NT 3.5.1 SP1<br/>
					
				
					Microsoft Windows NT  4.0 SP4<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP4<br/>
</span>
					
				
					Microsoft Windows NT  4.0 SP3<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP3<br/>
</span>
					
				
					Microsoft Windows NT  4.0 SP2<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP2<br/>
</span>
					
				
					Microsoft Windows NT  4.0 SP1<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP1<br/>
</span>
					
				
					Microsoft Windows NT  4.0<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows NT  4.0 SP5<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Terminal Server  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT Workstation  4.0 SP5<br/>
</span>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x1000/474/beadmin.zip">#exploit_beadmin.zip</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	 This exploit and description provided by Cybermedia Software Private Limited. <br/><br/> The simulation consists of one 32-bit application say BEADMIN.EXE and one MS-DOS based application, say SCRNSAVE.EXE. The BEADMIN.EXE when started does the following Creates one event in â??not-signalâ??ed state Sets up the screen saver. The screen saver executable is specified as SCRNSAVE.EXE and the timeout is set to minimum. . BEADMIN.EXE now waits on the event. After some time, the screen saver is triggered. This results in Winlogon.Exe spawning SCRNSAVE.EXE. Since the CreateProcess call returns junk handle to Winlogon.Exe, the setting of primary token fails. Hence the SCRNSAVE.EXE application (NTVDM.EXE) runs in System Context. This SCRNSAVE.EXE again spawns BEADMIN.EXE application. Now this second copy of BEADMIN.EXE inherits the security context of NTVDM which is System Context. This application adds the logged in user to admin group and signals the event on which first instance of BEADMIN.EXE is waiting. In response to this the first copy of BEADMIN.EXE resets back the Screen Saver settings and quits. The logged in user name is passed between the first and second copy of BEADMIN.EXE using shared section.
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/beadmin.zip">/data/vulnerabilities/exploits/beadmin.zip</a></li>
</ul>
</div>