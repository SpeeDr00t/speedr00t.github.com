#SpeeDr00t@Black Falcon<br>#bid5408<p><b><span style="font-size: 18pt;">Microsoft Windows Window Message Subsystem Design Error Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/5408/info">info</a><br><a href="http://www.securityfocus.com/bid/5408/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/5408/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/5408/solution">solution</a><br><a href="http://www.securityfocus.com/bid/5408/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				5408
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 06 2002 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Aug 06 2002 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovered by Chris Paget &lt;ivegotta@tombom.co.uk&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows XP Professional  SP1<br/>
					
				
					Microsoft Windows XP Professional  <br/>
					
				
					Microsoft Windows XP Home  SP1<br/>
					
				
					Microsoft Windows XP Home  <br/>
					
				
					Microsoft Windows XP 64-bit Edition  SP1<br/>
					
				
					Microsoft Windows XP 64-bit Edition  <br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP6a<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP6<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP5<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP4<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP3<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP2<br/>
					
				
					Microsoft Windows NT Workstation  4.0 SP1<br/>
					
				
					Microsoft Windows NT Workstation  4.0<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0<br/>
					
				
					Microsoft Windows NT Server  4.0 SP6a<br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows NT Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Server  4.0<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0<br/>
					
				
					Microsoft Windows 2000 Server  SP2<br/>
					
				
					Microsoft Windows 2000 Server  SP1<br/>
					
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Professional  SP2<br/>
					
				
					Microsoft Windows 2000 Professional  SP1<br/>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP2<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP1<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP2<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Ovidio Mallo has developed a proof-of-concept utility (easy_shatter.rar); it has reportedly been tested successfully on Kerio Personal Firewall 2.1.4, WinVNC 3.3.7 and Sygate Personal Firewall Pro 5.0.<br/><br/>Chris Paget has developed a proof-of-concept utility.  Additional proof-of-concept code for EM_SETWORDBREAKPROC has been developed by Oliver Lavery and is available in the referenced Win32 Message Vulnerabilities Redux paper.<br/><br/>An additional exploit has been contributed by consume.<br/><br/>Brett Moore has released shatterseh2.c as a proof-of-concept for the HDM_GETITEMRECT message.  An additional proof-of-concept (mcafee-shatterseh2.c), which is based on shatterseh2.c, has been released by Oliver Lavery that abuses Tab Controls with McAfee AV products.<br/><br/>An additional proof-of-concept (shatterseh3.c) was provided by Brett Moore demonstrating how Shatter attacks can be used against applications which make use of progress bar controls.  Brett Moore also released an exploit for statusbars (shatterstatus.c).<br/><br/>xenophi1e has released an exploit (commctrl-shatter.c) for Shatter attacks against Windows XP Visual Styles.<br/><br/>An exploit has been developed to take advantage of a shatter attack on the status bar of the disk defragmenter utility that is shipped with Windows XP. The exploit is not functioning correctly but can be found in the "status-bar SHATTER attack" message contained in the references section of this BID.
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/shatter.zip">/data/vulnerabilities/exploits/shatter.zip</a></li>
<li><a href="/data/vulnerabilities/exploits/damebreak.zip">/data/vulnerabilities/exploits/damebreak.zip</a></li>
<li><a href="/data/vulnerabilities/exploits/shatterseh2.c">/data/vulnerabilities/exploits/shatterseh2.c</a></li>
<li><a href="/data/vulnerabilities/exploits/mcafee-shatterseh2.c">/data/vulnerabilities/exploits/mcafee-shatterseh2.c</a></li>
<li><a href="/data/vulnerabilities/exploits/shatterseh3.c">/data/vulnerabilities/exploits/shatterseh3.c</a></li>
<li><a href="/data/vulnerabilities/exploits/shatterstatus.c">/data/vulnerabilities/exploits/shatterstatus.c</a></li>
<li><a href="/data/vulnerabilities/exploits/commctrl-shatter.c">/data/vulnerabilities/exploits/commctrl-shatter.c</a></li>
<li><a href="/data/vulnerabilities/exploits/easy_shatter.rar">/data/vulnerabilities/exploits/easy_shatter.rar</a></li>
<li><a href="/data/vulnerabilities/exploits/winMsgSubSysExp.c">/data/vulnerabilities/exploits/winMsgSubSysExp.c</a></li>
</ul>
</div>