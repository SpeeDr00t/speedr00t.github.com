#SpeeDr00t@Black Falcon<br>#bid10707<p><b><span style="font-size: 18pt;">Microsoft Windows Utility Manager Local Privilege Escalation Variant Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/10707/info">info</a><br><a href="http://www.securityfocus.com/bid/10707/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/10707/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/10707/solution">solution</a><br><a href="http://www.securityfocus.com/bid/10707/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				10707
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2004-0213<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jul 13 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 12 2009 06:16AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to Cesar Cerrudo.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows 2000 Server  SP4<br/>
					
				
					Microsoft Windows 2000 Server  SP3<br/>
					
				
					Microsoft Windows 2000 Server  SP2<br/>
					
				
					Microsoft Windows 2000 Server  SP1<br/>
					
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Professional  SP4<br/>
					
				
					Microsoft Windows 2000 Professional  SP3<br/>
					
				
					Microsoft Windows 2000 Professional  SP2<br/>
					
				
					Microsoft Windows 2000 Professional  SP1<br/>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP4<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP3<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP2<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP1<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP4<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP3<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP2<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x11000/10707/UtilManExploit2.c">#exploit_UtilManExploit2.c</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x11000/10707/utilmaned1.c">#exploit_utilmaned1.c</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x11000/10707/utilManagerExploit3.c">#exploit_utilManagerExploit3.c</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following exploit example was released:<br/><br/>//get window handle<br/>lHandle=FindWindow(NULL, "Utility Manager");<br/>//send right click on the app button in the taskbar or Alt+Space Bar<br/>PostMessage(lHandle,0x313,NULL,NULL);<br/>Sleep(100);<br/>//send WM_COMMANDHELP  0x0365  lParam must be&amp;lt;&amp;gt;NULL<br/>SendMessage(lHandle,0x365,NULL,0x1);<br/><br/>Once the winhlp32.exe file is loaded, it will ask the attacker if they wish to locate the umandlg.hlp help file.  The attacker may then select an external application to be loaded in place of umandlg.hlp.  It should be noted that this method of exploitation may not be sufficient on some systems, and additional measures may need to be taken to pass shellcode directly to the winhlp32.exe program.<br/><br/>Cesar Cerrudo has published an exploit (UtilManExploit2.c).  An additional exploit (utilmaned1.c) was also published by kralor.
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/UtilManExploit2.c">/data/vulnerabilities/exploits/UtilManExploit2.c</a></li>
<li><a href="/data/vulnerabilities/exploits/utilmaned1.c">/data/vulnerabilities/exploits/utilmaned1.c</a></li>
<li><a href="/data/vulnerabilities/exploits/utilManagerExploit3.c">/data/vulnerabilities/exploits/utilManagerExploit3.c</a></li>
</ul>
</div>