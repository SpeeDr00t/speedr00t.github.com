#SpeeDr00t@Black Falcon<br>#bid25302<p><b><span style="font-size: 18pt;">Microsoft Windows GDI Metafiles AttemptWrite Remote Code Execution Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/25302/info">info</a><br><a href="http://www.securityfocus.com/bid/25302/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/25302/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/25302/solution">solution</a><br><a href="http://www.securityfocus.com/bid/25302/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				25302
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2007-3034<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 14 2007 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Aug 30 2007 02:42AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Yuji Ukai discovered this issue.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows XP Professional x64 Edition  <br/>
					
				
					Microsoft Windows XP Professional  SP2<br/>
					
				
					Microsoft Windows XP Professional  SP1<br/>
					
				
					Microsoft Windows XP Professional  <br/>
					
				
					Microsoft Windows XP Media Center Edition  SP2<br/>
					
				
					Microsoft Windows XP Media Center Edition  SP1<br/>
					
				
					Microsoft Windows XP Media Center Edition  <br/>
					
				
					Microsoft Windows XP Home  SP2<br/>
					
				
					Microsoft Windows XP Home  SP1<br/>
					
				
					Microsoft Windows XP Home  <br/>
					
				
					Microsoft Windows XP Gold  0<br/>
					
				
					Microsoft Windows XP  0<br/>
					
				
					Microsoft Windows Server 2003 x64  SP1<br/>
					
				
					Microsoft Windows Server 2003 Web Edition  SP1<br/>
					
				
					Microsoft Windows Server 2003 Web Edition  <br/>
					
				
					Microsoft Windows Server 2003 Standard x64 Edition  <br/>
					
				
					Microsoft Windows Server 2003 Standard Edition  SP1<br/>
					
				
					Microsoft Windows Server 2003 Standard Edition  <br/>
					
				
					Microsoft Windows Server 2003 Itanium  SP1<br/>
					
				
					Microsoft Windows Server 2003 Itanium  0<br/>
					
				
					Microsoft Windows Server 2003 Enterprise x64 Edition  <br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition  <br/>
					
				
					Microsoft Windows Server 2003 Datacenter x64 Edition  SP2<br/>
					
				
					Microsoft Windows Server 2003 Datacenter x64 Edition  <br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition  SP1<br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition  <br/>
					
				
					Microsoft Windows Server 2003  SP1<br/>
					
				
					Microsoft Windows 2000 Server  SP4<br/>
					
				
					Microsoft Windows 2000 Server  SP3<br/>
					
				
					Microsoft Windows 2000 Server  SP2<br/>
					
				
					Microsoft Windows 2000 Server  SP1<br/>
					
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Professional  SP4<br/>
					
				
					Microsoft Windows 2000 Professional  SP3<br/>
					
				
					Microsoft Windows 2000 Professional  SP2<br/>
					
				
					Microsoft Windows 2000 Professional  SP1<br/>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP4<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP3<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP2<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP1<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP4<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP3<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP2<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
					
				
					HP Storage Management Appliance  III<br/>
					
				
					HP Storage Management Appliance  II<br/>
					
				
					HP Storage Management Appliance  I<br/>
					
				
					HP Storage Management Appliance  2.1<br/>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  III<br/>
</span>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  II<br/>
</span>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  I<br/>
</span>
					
				
					HP Storage Management Appliance  2.1<br/>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  III<br/>
</span>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  II<br/>
</span>
<span class="related">
						
							+ 
						
						HP Storage Management Appliance  I<br/>
</span>
					
				
					Avaya Messaging Application Server  MM 3.1<br/>
					
				
					Avaya Messaging Application Server  MM 3.0<br/>
					
				
					Avaya Messaging Application Server  MM 2.0<br/>
					
				
					Avaya Messaging Application Server  MM 1.1<br/>
					
				
					Avaya Messaging Application Server  0<br/>
					
				
					Avaya Customer Interaction Express (CIE) User Interface 1.0.2 <br/>
					
				
					Avaya Customer Interaction Express (CIE) User Interface  1.0<br/>
					
				
					Avaya Customer Interaction Express (CIE) Server  1.0<br/>
					
				
					Avaya CIE 1.0.2 <br/>
					
				
					Avaya CIE  1.0<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x26000/25302/25302-MS07-046.c">#exploit_25302-MS07-046.c</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Attackers may exploit this issue by crafting and distributing a malicious image file.<br/><br/>Currently we are not aware of any working exploits for this issue. If you feel we are in error or if you are aware of more recent information, please mail us at:   mailto:vuldb@#no_exploit.<br/><br/>The following proof-of-concept code is available:
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/25302-MS07-046.c">/data/vulnerabilities/exploits/25302-MS07-046.c</a></li>
</ul>
</div>