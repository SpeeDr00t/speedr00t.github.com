#SpeeDr00t@Black Falcon<br>#bid11467<p><b><span style="font-size: 18pt;">Microsoft Windows HTML Help Control Cross-Zone Scripting Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/11467/info">info</a><br><a href="http://www.securityfocus.com/bid/11467/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/11467/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/11467/solution">solution</a><br><a href="http://www.securityfocus.com/bid/11467/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				11467
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2004-1043<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Oct 20 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 12 2009 08:06AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to http-equiv.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Nortel Networks Symposium Web Client  <br/>
					
				
					Nortel Networks Symposium Web Center Portal (SWCP)  <br/>
					
				
					Nortel Networks SL100 Corporate Directory  <br/>
					
				
					Nortel Networks Periphonics  <br/>
					
				
					Nortel Networks Optivity Telephony Manager for SL-100  <br/>
					
				
					Nortel Networks Optivity Telephony Manager (OTM)  <br/>
					
				
					Nortel Networks Optivity Switch Manager (OSM)  <br/>
					
				
					Nortel Networks Optivity Network Management System  <br/>
					
				
					Nortel Networks Optivity Network Configuration System (NCS)  <br/>
					
				
					Nortel Networks Optivity NetID  <br/>
					
				
					Nortel Networks Network Configuration Manager for BCM  <br/>
					
				
					Nortel Networks Mobile Voice Client 2050  <br/>
					
				
					Nortel Networks Meridian SL-100  <br/>
					
				
					Nortel Networks MCS 5200 3.0 <br/>
					
				
					Nortel Networks MCS 5100 3.0 <br/>
					
				
					Nortel Networks IP softphone 2050  <br/>
					
				
					Nortel Networks CPL (Craft Photonic Layer) Web client (IE)  <br/>
					
				
					Nortel Networks Contivity VPN Client 5.0 1_030<br/>
					
				
					Nortel Networks Contivity VPN Client 4.91 <br/>
					
				
					Nortel Networks Contivity VPN Client 4.86 <br/>
					
				
					Nortel Networks Contivity VPN Client 4.15 <br/>
					
				
					Nortel Networks Contivity Configuration Manager  <br/>
					
				
					Nortel Networks CallPilot  703t<br/>
					
				
					Nortel Networks CallPilot  201i<br/>
					
				
					Nortel Networks CallPilot  1002rp<br/>
					
				
					Nortel Networks Call Center Management Information System (CCMIS)  <br/>
					
				
					Microsoft Windows XP Tablet PC Edition  SP2<br/>
					
				
					Microsoft Windows XP Tablet PC Edition  SP1<br/>
					
				
					Microsoft Windows XP Tablet PC Edition  <br/>
					
				
					Microsoft Windows XP Professional  SP2<br/>
					
				
					Microsoft Windows XP Professional  SP1<br/>
					
				
					Microsoft Windows XP Professional  <br/>
					
				
					Microsoft Windows XP Home  SP2<br/>
					
				
					Microsoft Windows XP Home  SP1<br/>
					
				
					Microsoft Windows XP Home  <br/>
					
				
					Microsoft Windows XP 64-bit Edition Version 2003  SP1<br/>
					
				
					Microsoft Windows XP 64-bit Edition Version 2003  <br/>
					
				
					Microsoft Windows XP 64-bit Edition  SP1<br/>
					
				
					Microsoft Windows XP 64-bit Edition  <br/>
					
				
					Microsoft Windows Server 2003 Web Edition  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Web Edition  <br/>
					
				
					Microsoft Windows Server 2003 Standard Edition  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Standard Edition  <br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition Itanium  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Enterprise Edition  <br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition Itanium  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition  SP1 Beta 1<br/>
					
				
					Microsoft Windows Server 2003 Datacenter Edition  <br/>
					
				
					Microsoft Windows ME  <br/>
					
				
					Microsoft Windows 98SE  <br/>
					
				
					Microsoft Windows 98  <br/>
					
				
					Microsoft Windows 2000 Professional  SP4<br/>
					
				
					Microsoft Windows 2000 Professional  SP3<br/>
					
				
					Microsoft Windows 2000 Professional  SP2<br/>
					
				
					Microsoft Windows 2000 Professional  SP1<br/>
					
				
					Microsoft Windows 2000 Professional  <br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP4<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP3<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP2<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  SP1<br/>
					
				
					Microsoft Windows 2000 Datacenter Server  <br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP4<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP3<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP2<br/>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
					
				
					Microsoft Internet Explorer  6.0 SP2 - do not use<br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x12000/11467/files.zip">#exploit_files.zip</a><br><a href="https://github.com/SpeeDr00t/speedr00t.github.com/blob/master/securityfocus/0x12000/11467/injecthh_op_2-code_by_liudieyu.zip">#exploit_injecthh_op_2-code_by_liudieyu.zip</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	A reliable exploit (injecthh_op_2-code_by_liudieyu.zip) has been made available by Liu Die Yu &amp;lt;liudieyu@umbrella.name&amp;gt;; the payload.exe file has been removed from this archive. Further details can be found in the associated discussion reference.<br/><br/>An exploit has been published on the following Web page:<br/><br/>http://www.malware.com/noceegar.html<br/><br/>An additional proof of concept (files.zip) has been made available by Michael Evanchik &amp;lt;mcbain@aol.com&amp;gt;, instructions on how to configure this proof of concept can be found in the associated message reference:<br/><br/>Additional proof of concept allows for the execution of arbitrary script code in other domains:<br/><br/>http://www.persiax.com/pocs/htmlhelp/cs.htm<br/><br/>http://www.persiax.com/pocs/htmlhelp/cz.htm<br/><br/>The following proof of concept provided by Paul &amp;lt;paul@greyhats.cjb.net&amp;gt;, allows for local zone security bypass and eliminates user interaction:<br/><br/>&amp;amp;lt;OBJECT id="hhctrl" type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"codebase="hhctrl.ocx#Version=5,2,3790,1194"width=7% height=7%<br/>style="position:absolute;top:140;left:72;z-index:100;"&amp;gt;<br/>&amp;lt;PARAM name="Command" value="Related Topics, MENU"&amp;gt;<br/>&amp;lt;PARAM name="Button" value="Text:Just a button"&amp;gt;<br/>&amp;lt;PARAM name="Window" value="$global_blank"&amp;gt;<br/>&amp;lt;PARAM name="Item1" value="command;C:\WINDOWS\PCHealth\malwarez1.htm"&amp;gt;<br/>&amp;amp;lt;/OBJECT&amp;amp;gt;<br/>&amp;amp;lt;script&amp;amp;gt;<br/>hhctrl.HHClick();<br/>&amp;amp;lt;/script&amp;amp;gt;<br/><br/>Another proof of concept exploit has been made available by Greyhats that leverages this issue.  The exploit can be found here.  Please note that this exploit has not been verified by Symantec.<br/><br/>http://freehost07.websamba.com/greyhats/sp2rc.htm<br/><br/>A new proof of concept has been made available that allows applications to be executed with parameters:<br/><br/>http://www.freewebs.com/shreddersub7/htm.htm<br/><br/>This exploit has not been tested or verified by Symantec and is currently under analysis.  This record will be updated if new information becomes available.<br/><br/>Further exploit code:
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/files.zip">/data/vulnerabilities/exploits/files.zip</a></li>
<li><a href="/data/vulnerabilities/exploits/injecthh_op_2-code_by_liudieyu.zip">/data/vulnerabilities/exploits/injecthh_op_2-code_by_liudieyu.zip</a></li>
</ul>
</div>