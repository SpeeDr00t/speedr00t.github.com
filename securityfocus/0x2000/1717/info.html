#bid1717<p><b><span style="font-size: 18pt;">Unixware SCOhelp HTTP Server Format String Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1717/info">info</a><br><a href="http://www.securityfocus.com/bid/1717/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1717/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1717/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1717/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1717
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Sep 26 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Sep 26 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered by Juliano Rizzo of CORE SDI Inc., Buenos Aires, Argentina.

 This advisory was drafted with the help of the SecurityFocus.com Vulnerability Help Team. For more information or assistance drafting advisories please mail vul
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					SCO Unixware 7.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	  There is a user supplied format string bug in the vtopic CGI script that could be abused to execute arbitrary code. By sending a request with the following URI:<br/><br/> http://target:457/search97cgi/vtopic?Action= FilterSearch&amp;filter=&amp;queryText=%25x<br/><br/> The server will elicit the following response:<br/>--<br/> Internal error: STR_sprintf: Invalid format (Error E1-0142 (Query<br/> Builder): Invalid character '%' (0x25))<br/><br/> Result<br/> Search failed: -40<br/><br/> Result<br/> Error E1-0142 (Query Builder): Invalid character '<br/><br/> Result<br/> Error E1-0130 (Query Builder): Syntax error in query string near<br/> character 1<br/><br/> Result<br/> Error E1-0133 (Query Builder): Error parsing query: 81888e0<br/><br/> Result<br/> VdkSearchNew failed, error -40<br/><br/> Result<br/> Request failed for REQUEST_METHOD=, QUERY_STRING=<br/><br/> Component<br/> Component (vsearch) failed in processing request, -2<br/><br/> Action<br/> Action (FilterSearch) failed while processing request in component<br/> (vsearch), -2<br/><br/> Service Manager<br/> Action (FilterSearch) failed in processing request, -2<br/> S97IS Service manager failed to process request<br/>--<br/><br/> Note that the line:<br/>  Error E1-0133 (Query Builder): Error parsing query: 81888e0<br/> <br/>This shows that the server is interpreting the %x argument passed in the URI as the "queryText" value. Supplying a carefully built value for the queryText argument an attacker can change the program flow and execute arbitrary code.
	
		<ul>
</ul>
</div>