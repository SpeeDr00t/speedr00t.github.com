#bid1882<p><b><span style="font-size: 18pt;">Microsoft Network Monitor Multiple Buffer Overflow Vulnerabilities</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1882/info">info</a><br><a href="http://www.securityfocus.com/bid/1882/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1882/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1882/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1882/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1882
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Boundary Condition Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Nov 01 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Nov 01 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was first reported in an advisory posted to Bugtraq on November 1, 2000 by COVERT Labs (http://www.pgp.com/).  Additional credit to the ISS X-force (http://xforce.iss.net/).
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Windows NT Terminal Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Terminal Server  4.0<br/>
					
				
					Microsoft Windows NT Server  4.0 SP6a<br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows NT Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Server  4.0<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP6a<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP6<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP5<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP4<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP3<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP2<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0 SP1<br/>
					
				
					Microsoft Windows NT Enterprise Server  4.0<br/>
					
				
					Microsoft Windows 2000 Server  SP1<br/>
					
				
					Microsoft Windows 2000 Server  <br/>
<span class="related">
						
							+ 
						
						Avaya DefinityOne Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya IP600 Media Servers  <br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S3400 Message Application Server  0<br/>
</span>
<span class="related">
						
							+ 
						
						Avaya S8100 Media Servers  0<br/>
</span>
					
				
					Microsoft Windows 2000 Advanced Server  SP1<br/>
					
				
					Microsoft Windows 2000 Advanced Server  <br/>
					
				
					Microsoft Systems Management Server  2.0 SP1<br/>
					
				
					Microsoft Systems Management Server  2.0<br/>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
					
				
					Microsoft Systems Management Server  1.2 SP4<br/>
					
				
					Microsoft Systems Management Server  1.2 SP3<br/>
					
				
					Microsoft Systems Management Server  1.2 SP2<br/>
					
				
					Microsoft Systems Management Server  1.2 SP1<br/>
					
				
					Microsoft Systems Management Server  1.2<br/>
<span class="related">
						
							-
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							-
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Enterprise Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Terminal Server  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT Workstation  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	This exploit has been taken directly from the COVERT Labs advisory (Full advisory in Credit Section).<br/><br/>The following examples illustrate specific problems identified by COVERT Labs <br/>research.<br/><br/>1)  If a CIFS Browse Frame is delivered to UDP port 138, the function FormatBrowserSummary() is called within 'browser.dll'.  One specific CIFS Browse Frame, "Become Backup", includes the name of the Browse Server to be promoted.  This information is extracted from the UDP datagram for inclusion in the single line summary.<br/><br/>The Browser Server name is passed to the WIN32 API function call OemToChar(), which translates a string from the OEM-defined character set into either an ANSI or a wide-character string.  The OemToChar() function stops converting characters when it encounters a null character.  The vulnerable FormatBrowserSummary() function in 'browser.dll' calls OemToChar(), converting the server name into a <br/>255 byte character buffer on the stack. Because OemToChar() provides no bounds checking the stack can be overrun with arbitrary values.<br/><br/>2)  If an SNMP request is received on UDP port 161, 'snmp.dll' is called.  The community name of the SNMP request is extracted from the datagram for the protocol specific summary. The SNMP community name is copied into a stack buffer by 'snmp.dll' using the WIN32 function <br/>wsprintfA().  Because this function call does not provide adequate bounds checking, the stack may be overwritten.<br/><br/>3)  If an SMB session is received on TCP port 139, 'smb.dll' is called.  This parser contains two vulnerabilities.  If an SMB session with a long username or a long filename for a type C transaction is <br/>received, Network Monitor will overwrite its stack frame via an unchecked wsprintfA() call in a manner similar to the vulnerability described in the SNMP parser.<br/><br/>Extracting control of the instruction pointer for each of these vulnerabilities can either be achieved by overwriting the return address and allowing the vulnerable functions to return or by overwriting the Structure Exception Handlers callback pointer and then causing a invalid memory reference. 
	
		<ul>
</ul>
</div>