#bid1161<p><b><span style="font-size: 18pt;">Cisco Router Online Help Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1161/info">info</a><br><a href="http://www.securityfocus.com/bid/1161/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1161/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1161/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1161/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1161
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
				
					CVE-2000-0345<br/>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				May 03 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jul 11 2009 01:56AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This bug was discovered and documented by Fernando Montenegro fsmontenegro@iname.com and Claudio Silotto (csilotto@hotmail.com). The message detailing this vulnerability was sent to the Bugtraq mailing list on 2 May 2000.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Cisco IOS 12.0.7 <br/>
					
				
					Cisco IOS 12.0.6 <br/>
					
				
					Cisco IOS 12.0.5 <br/>
					
				
					Cisco IOS 12.0.4 T<br/>
					
				
					Cisco IOS 12.0.4 S<br/>
					
				
					Cisco IOS 12.0.4 <br/>
					
				
					Cisco IOS 12.0.3 T2<br/>
					
				
					Cisco IOS 12.0.2 XG<br/>
					
				
					Cisco IOS 12.0.2 XF<br/>
					
				
					Cisco IOS 12.0.2 XD<br/>
					
				
					Cisco IOS 12.0.2 XC<br/>
					
				
					Cisco IOS 12.0.2 <br/>
					
				
					Cisco IOS 12.0.1 XE<br/>
					
				
					Cisco IOS 12.0.1 XB<br/>
					
				
					Cisco IOS 12.0.1 XA3<br/>
					
				
					Cisco IOS 12.0.1 W<br/>
					
				
					Cisco IOS 11.2.10 BC<br/>
					
				
					Cisco IOS 11.2.10 <br/>
					
				
					Cisco IOS 11.2.9 XA<br/>
					
				
					Cisco IOS 11.2.9 P<br/>
					
				
					Cisco IOS 11.2.8 SA5<br/>
					
				
					Cisco IOS 11.2.8 SA3<br/>
					
				
					Cisco IOS 11.2.8 SA1<br/>
					
				
					Cisco IOS 11.2.8 P<br/>
					
				
					Cisco IOS 11.2.8 <br/>
					
				
					Cisco IOS 11.2.4 F1<br/>
					
				
					Cisco IOS 11.1.17 CT<br/>
					
				
					Cisco IOS 11.1.17 CC<br/>
					
				
					Cisco IOS 11.1.16 IA<br/>
					
				
					Cisco IOS 11.1.16 AA<br/>
					
				
					Cisco IOS 11.1.16 <br/>
					
				
					Cisco IOS 11.1.15 CA<br/>
					
				
					Cisco IOS 11.1.13 IA<br/>
					
				
					Cisco IOS 11.1.13 CA<br/>
					
				
					Cisco IOS 11.1.13 AA<br/>
					
				
					Cisco IOS 11.1.13 <br/>
					
				
					Cisco IOS  9.14<br/>
					
				
					Cisco IOS  12.0T<br/>
					
				
					Cisco IOS  12.0S<br/>
					
				
					Cisco IOS  12.0DB<br/>
					
				
					Cisco IOS  12.0(9)S<br/>
					
				
					Cisco IOS  12.0(8)<br/>
					
				
					Cisco IOS  12.0(7)T<br/>
					
				
					Cisco IOS  12.0(5)T1<br/>
					
				
					Cisco IOS  12.0<br/>
					
				
					Cisco IOS  11.2P<br/>
					
				
					Cisco IOS  11.2(17)<br/>
					
				
					Cisco IOS  11.2<br/>
					
				
					Cisco IOS  11.1<br/>
					
				
					Cisco HSRP 7500.0 <br/>
					
				
					Cisco HSRP 7200.0 <br/>
					
				
					Cisco HSRP 4000.0 <br/>
					
				
					Cisco HSRP 3600.0 <br/>
					
				
					Cisco HSRP 2600.0 <br/>
					
				
					Cisco HSRP 2500.0 <br/>
					
				
					Cisco 7500  <br/>
					
				
					Cisco 7200  <br/>
					
				
					Cisco 4000  <br/>
					
				
					Cisco 3600  <br/>
					
				
					Cisco 2600  <br/>
					
				
					Cisco 2500  <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	As taken from the original post on this vulnerability  (See the Credit Section):<br/><br/><br/>Routers tested: 2500, 2600, 3600, 4000, 7200, 7500 series, <br/>running IOS 9.14, 11.1(21) (Distributed Director), 11.2(x) <br/>and 12.0(x). Some were tested on the local console, some <br/>over Telnet. We recently tested PIX 4.x, and found it was <br/>NOT vulnerable.<br/><br/>A regular user will log-on with privilege level equal to 1. <br/>This can be shown by running "show privilege" after logging <br/>on the router. For example:<br/><br/> User Access Verification<br/><br/> Username: joeuser<br/> Password: &amp;lt;password&amp;gt;<br/> Router2&amp;gt;sh priv<br/> Current privilege level is 1<br/> Router2&amp;gt;<br/><br/>Now, if we try to get a list of all possible "show" <br/>commands, by doing "show ?", we get:<br/><br/> Router2&amp;gt;show privilege<br/> Current privilege level is 1<br/> Router2&amp;gt;show ?<br/>   backup         Backup status<br/>   cef            Cisco Express Forwarding<br/>   clock          Display the system clock<br/>   dialer         Dialer parameters and statistics<br/>   flash:         display information about flash: file <br/>system<br/>   history        Display the session command history<br/> ...<br/><br/>Notice that we did not see an "access-lists" option, so the <br/>help system thinks we should not be able to run it...<br/><br/><br/>However,<br/><br/> Router2&amp;gt;show privilege<br/> Current privilege level is 1<br/> Router2&amp;gt;show access-lists<br/> Standard IP access list 10<br/>     permit 172.16.0.1<br/>     deny   any<br/> Extended IP access list eth0-IN<br/>     permit udp host 172.16.0.1 10.11.12.0 0.0.0.255 eq <br/>snmp (14982 matches)<br/>     permit udp host 172.16.0.1 10.11.13.128 0.0.0.127 eq <br/>snmp (4026 matches)<br/><br/>So, we can see the configuration, even though we shouldn't. <br/>We can't alter it, but even seeing the access-list is <br/>beneficial to an attacker.<br/><br/>Upon further testing on a 3640 running IOS 12.0(5), we got <br/>the following results:<br/><br/>- We found 75 "show" commands that are supposed to be <br/>available only in enable mode. Meaning: the difference <br/>between "show ?" in enabled and disabled mode was this 75 <br/>commands<br/><br/>- Out of 75, only 13 were truly restricted. The other 62 <br/>were available to be viewed by a session in a disabled mode.<br/><br/>- Out of the 62 that were viewable, we counted 7 as being <br/>potentially very dangerous. "show ip" is one of them, as <br/>well as "show cdp", "show logging", "show cdp", "show <br/>vlans". There are others, but I don't have my list with me <br/>right now.<br/><br/>- By combining "show ip" and "show access-lists" we had a <br/>very clear picture of how access-lists were distributed in <br/>the router.
	
		<ul>
</ul>
</div>