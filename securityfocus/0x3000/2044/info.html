#SpeeDr00t@Black Falcon<br>#bid2044<p><b><span style="font-size: 18pt;">Linux Non-Readable File Ptrace Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/2044/info">info</a><br><a href="http://www.securityfocus.com/bid/2044/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/2044/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/2044/solution">solution</a><br><a href="http://www.securityfocus.com/bid/2044/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				2044
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				No
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Nov 30 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Nov 30 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovered by and posted to Bugtraq by Lamagra Argamal &lt;lamagra@hackermail.net&gt; on Nov 30, 2000.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Linux kernel 2.2.17 <br/>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 7.2 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Trustix Secure Linux 1.2 <br/>
</span>
					
				
					Linux kernel 2.2.16 <br/>
<span class="related">
						
							+ 
						
						Redhat Linux 7.0 <br/>
</span>
<span class="related">
						
							+ 
						
						Sun Cobalt Qube 3  <br/>
</span>
<span class="related">
						
							+ 
						
						Sun Cobalt RaQ XTR  <br/>
</span>
<span class="related">
						
							+ 
						
						Trustix Secure Linux 1.1 <br/>
</span>
					
				
					Linux kernel 2.2.15 <br/>
<span class="related">
						
							+ 
						
						MandrakeSoft Corporate Server 1.0.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Mandriva Linux Mandrake 7.1 <br/>
</span>
					
				
					Linux kernel 2.2.14 <br/>
<span class="related">
						
							+ 
						
						Redhat Linux  6.2<br/>
</span>
<span class="related">
						
							+ 
						
						SCO eDesktop 2.4 <br/>
</span>
<span class="related">
						
							+ 
						
						SCO eServer 2.3.1 <br/>
</span>
<span class="related">
						
							+ 
						
						Sun Cobalt RaQ 4  <br/>
</span>
					
				
					Linux kernel 2.2.13 <br/>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.4 <br/>
</span>
<span class="related">
						
							+ 
						
						S.u.S.E. Linux 6.3 <br/>
</span>
					
				
					Linux kernel 2.2.12 <br/>
					
				
					Linux kernel 2.2.10 <br/>
<span class="related">
						
							+ 
						
						Caldera OpenLinux 2.3 <br/>
</span>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit_link<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	Trace on non-readable file using PT_ATTACH:<br/><br/>$ ls -l testfile<br/>-rwx--x--x   1 root     root      216916 Dec  4 11:59 testfile<br/><br/>$ ./testfile <br/>waiting..<br/><br/>From another shell:<br/><br/>$ strace -p 11535   &lt;---process ID of "testfile" process<br/>attach: ptrace(PTRACE_ATTACH, ...): Operation not permitted  &lt;---Because testfile isn't readable. Good, secure behaviour<br/><br/>---------------<br/><br/>Trace on non-readable file as child process:<br/><br/>$ strace testfile <br/><br/>SYS_197(0x3, 0xbffff650, 0x40197d40, 0x80cca38, 0x3) = -1 ENOSYS (Function not implemented)<br/>fstat(3, {st_mode=S_IFREG|0644, st_size=1744, ...}) = 0<br/>mmap(0, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x40015000<br/>..
	
		<ul>
</ul>
</div>