<p><b><span style="font-size: 18pt;">Cobalt RaQ siteUserMod.cgi Privelege Escalation Vulnerability</span></b></p><br><br><a href="http://www.securityfocus.com/bid/951/info">info</a><br><a href="http://www.securityfocus.com/bid/951/discuss">discussion</a><br><a href="http://www.securityfocus.com/bid/951/exploit">exploit</a><br><a href="http://www.securityfocus.com/bid/951/solution">solution</a><br><a href="http://www.securityfocus.com/bid/951/references">references</a><br><br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
<table border="0" cellpadding="4" cellspacing="0">
<tr>
<td>
<span class="label">Bugtraq ID:</span>
</td>
<td>
				951
			</td>
</tr>
<tr>
<td>
<span class="label">Class:</span>
</td>
<td>
				Access Validation Error
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">CVE:</span>
</td>
<td>
</td>
</tr>
<tr>
<td>
<span class="label">Remote:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Local:</span>
</td>
<td>
				Yes
			</td>
</tr>
<tr>
<td>
<span class="label">Published:</span>
</td>
<td>
				Jan 27 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Updated:</span>
</td>
<td>
				Jan 27 2000 12:00AM
			</td>
</tr>
<tr>
<td>
<span class="label">Credit:</span>
</td>
<td>
				Discovered by skirkham@telusplanet.net. Posted to Bugtraq on Janurary 28, 2000 by Chuck Pitre &lt;chuck@oa.net&gt;.
			</td>
</tr>
<tr valign="top">
<td>
<span class="label">Vulnerable:</span>
</td>
<td>
				
					Cobalt RaQ 3.0 <br/>
					
				
					Cobalt RaQ 2.0 <br/>
					
				
					Cobalt RaQ 1.1 <br/>
</td>
</tr>
<tr>
<td colspan="2">
<div class="breakline"></div>
</td>
</tr>
<tr valign="top">
<td>
<span class="label">Not Vulnerable:</span>
</td>
<td>
</td>
</tr>
</table>
</div><br><br>#<br>##no_exploit<br><br><br><br>#<br>#<div id="vulnerability">
<span class="title"></span><br/><br/>
	 Copied verbatim from an email from skirkham@telusplanet.net (Linked to in it's entirety in the 'credit' section):<br/><br/> To replicate this bug you must have Site Administrator access to one of the accounts on the server. When you go into the Site Management for a site and select the User Management option, you get a list of the usernames that have been setup for that account. The green pencil edit icon is a command to execute the JavaScript function modify() and it passes the username as the only variable into the function. To properly execute a function from the Location Bar in Netscape, the HTML page has to be the top frame. I simply opened the userList.html file in a new frame. When you type "javascript: modify( 'admin' );" into the Location Bar, the modify() function returns a URL. The URL returned when accessing it from my site is "http://target:81/cgi-bin/.cobalt/siteUserMod/siteUserMod.cgi?username=admin&amp;group=site151&amp;949015199230". This loads a standard Modify User page for the "admin" account. However, when you attempt to change this information by clicking the "Confirm Modify" button, it returns a JavaScript error because the function that it calls upon is dependant on the frame layout of the Site Management page. To overcome this issue I simply downloaded two HTML files to my hard disk. One is the index.html file, other other is the right.html file. I basically changed the index.html file to call upon the URL's on my site and had it load the right.html file locally off my hard disk. I then changed the right.html file to load the URL's on my site but changed the "main" frame source to "http://target:81/cgi-bin/.cobalt/siteUserMod/siteUserMod.cgi?username=admin&amp;group=site151&amp;949015199230" - the Modify User page for the "admin" account. It then loads up with all the correct frames AND the Modify User page for the "admin" account. I very simply just enter a new password for the user and click "Confirm Modify" and presto! The admin password is changed allowing me access to the Server Management page showing all the server's clients, IP addresses, domain names, and ability to access all the client's contact people, telephone numbers, usernames, and passwords. I also could delete any sites/files or downloaded any sites/files. I then had full access via FTP to the site showing the root directory of the server, and the ability to delete any evidence via the /log/ directory. 
	
		<ul>
</ul>
</div>